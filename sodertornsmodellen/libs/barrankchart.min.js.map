{"version":3,"sources":["webpack:///barrankchart.min.js","webpack:///webpack/bootstrap 4e607fc562d3a3fc6c04?20fe","webpack:///./src/index.js?9552","webpack:///./src/component.js?a623","webpack:///./~/css.escape/css.escape.js?3a6d","webpack:///./src/template.html?60fe","webpack:///(webpack)/buildin/global.js?3698"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_component","_component2","obj","default","VERSION_INFO","version","build","Vizabi","Tool","extend","init","placeholder","externalModel","this","components","component","model","Component","_super","default_model","state","time","autoconfig","type","entities","excludeIDs","entities_colorlegend","entities_tags","includeOnlyIDs","marker_tags","space","label","use","which","hook_parent","entities_allpossible","marker_allpossible","marker","axis_x","allow","scales","color","syncModels","marker_colorlegend","hook_rank","hook_geoshape","locale","ui","chart","datawarning","doubtDomain","doubtRange","buttons","dialogs","popup","sidebar","moreoptions","presentation","versionInfo","_defineProperty","key","writable","_toConsumableArray","arr","Array","isArray","arr2","length","from","_slicedToArray","sliceIterator","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","TypeError","_css","_css2","utils","axisWithLabelPicker","helpers","iconQuestion","iconset","question","iconWarn","warn","BarRankChart","config","context","_this2","template","model_expects","model_binds","change:time.value","_ready","_readyOnce","onTimeChange","change:marker.select","_selectBars","_updateOpacity","_updateDoubtOpacity","_scroll","change:marker.axis_x.scaleType","loadData","draw","change:marker.color.palette","_drawColors","change:marker.highlight","change:marker.opacitySelectDim","change:marker.opacityRegular","xScale","cScale","d3","scaleOrdinal","schemeCategory10","xAxis","_this3","getFrame","values","readyOnce","element","select","header","infoEl","barViewport","barSvg","barContainer","dataWarningEl","wScale","scaleLinear","domain","range","tickFormat","getTickFormatter","_localeId","id","_entityLabels","_presentation","_formatter","ready","_this4","TIMEDIM","getDimension","KEYS","unique","_getAllDimensions","exceptType","KEY","join","dataKeys","getDataKeysPerHook","labelNames","getLabelHookNames","markerKeys","getKeys","resize","_this5","_this","translator","getTFunction","xAxisValues","keys","sortedEntities","_sortByIndicator","on","parent","findChildByName","markerID","alignX","alignY","updateView","toggle","getScale","copy","setIcon","attr","append","text","conceptPropsX","getConceptprops","style","Number","Boolean","description","sourceLink","pin","rect","getBBox","ctx","makeAbsoluteContext","farthestViewportElement","coord","x","y","height","setHook","show","setPos","hide","force","arguments","time_1","duration","playing","delayAnimations","drawAxes","drawData","profiles","small","margin","top","right","left","bottom","headerMargin","infoElHeight","infoElMargin","barHeight","barMargin","barRectMargin","barValueMargin","scrollMargin","medium","large","presentationProfileChanges","activeProfile","getActiveProfile","_activeProfile","parseInt","width","headerTitle","_model$marker$axis_x$","unit","headerTitleText","node","headerTitleBBox","titleTx","titleTy","headerInfo","infoTx","infoTy","headerTotal","transition","delay","formatDate","interrupt","getLayoutProfile","headerTotalBBox","totalTx","totalTy","classed","warningBBox","_this6","_createAndDeleteBars","selectAll","data","presentationModeChanged","entitiesCountChanged","_entitiesCount","_resizeSvg","_activeProfile2","limits","getLimits","ltr","Math","abs","max","min","hasNegativeValues","rightEdge","_getWidestLabelWidth","scaleType","apply","shift","barWidth","isLtrValue","labelAnchor","valueAnchor","labelX","barX","valueX","isLabelBig","forEach","bar","isNew","changedValue","barLabel","labelSmall","barRect","barValue","changedWidth","ease","easeLinear","changedIndex","self","_getBarPosition","index","_activeProfile3","follow","empty","datum","yPos","scrollTo","tween","entity","_scrollTopTween","_getLabelText","map","updatedBars","_sortedEntities","localeChanged","exit","remove","enter","each","substring","selectedLabel","size","labelWidth","labelSmallWidth","assign","isSelected","getKey","_id","highlightMarker","clearHighlighted","selectMarker","merge","big","widthKey","labelKey","reduce","a","b","_this7","_ref","colorValue","isColorValid","fillColor","String","_getColor","strokeColor","_ref2","_getDarkerColor","rgb","darker","scrollTop","interpolateNumber","t","_entities","dataKey","_this8","_this8$_entities$key","cached","formattedValue","sort","_ref3","_ref4","_this9","selected","selectedBar","highlight","OPACITY_HIGHLIGHT_DIM","opacityHighlightDim","OPACITY_SELECT_DIM","opacitySelectDim","OPACITY_REGULAR","opacityRegular","someHighlighted","someSelected","isHighlighted","opacity","getUTCFullYear","toString","global","root","factory","CSS","escape","cssEscape","codeUnit","string","result","firstCodeUnit","charCodeAt","charAt","g","Function","eval","e","window"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAI,EAAAJ,EACAK,GAAA,EACAH,WAUA,OANAJ,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,GAAA,EAGAF,EAAAD,QAvBA,GAAAD,KA4BAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAK,EAAA,SAAAK,GAA2C,MAAAA,IAG3CV,EAAAW,EAAA,SAAAR,EAAAS,EAAAC,GACAb,EAAAc,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAb,EAAAoB,EAAA,SAAAhB,GACA,GAAAS,GAAAT,KAAAiB,WACA,WAA2B,MAAAjB,GAAA,SAC3B,WAAiC,MAAAA,GAEjC,OADAJ,GAAAW,EAAAE,EAAA,IAAAA,GACAA,GAIAb,EAAAc,EAAA,SAAAQ,EAAAC,GAAsD,MAAAR,QAAAS,UAAAC,eAAAlB,KAAAe,EAAAC,IAGtDvB,EAAA0B,EAAA,GAGA1B,IAAA2B,EAAA,KDMM,SAAUvB,EAAQD,EAASH,GAEjC,YAGAe,QAAOC,eAAeb,EAAS,cAC7BO,OAAO,IE5ETV,EAAA,EACA,IAAA4B,GAAA5B,EAAA,GFkFI6B,EAEJ,SAAgCC,GAAO,MAAOA,IAAOA,EAAIT,WAAaS,GAAQC,QAASD,IAF9CF,GEhFnCI,GAAiBC,QAAS,QAAWC,MAAO,cFsFlD/B,GAAQ4B,QEpFOI,OAAOC,KAAKC,OAAO,gBAGhCC,KAAM,SAAUC,EAAaC,GAE3BC,KAAK7B,KAAO,eAEZ6B,KAAKC,aACHC,oBACAJ,YAAa,gBACbK,OAAQ,aAAc,eAAgB,SAAU,QAEhDD,UAAWR,OAAOU,UAAU1B,IAAI,cAChCoB,YAAa,uBACbK,OAAQ,aAAc,eAAgB,QAEtCD,UAAWR,OAAOU,UAAU1B,IAAI,WAChCoB,YAAa,oBACbK,OAAQ,QAAS,KAAM,YAEvBD,UAAWR,OAAOU,UAAU1B,IAAI,cAChCoB,YAAa,uBACbK,OAAQ,QAAS,KAAM,YAEvBD,UAAWR,OAAOU,UAAU1B,IAAI,YAChCoB,YAAa,qBACbK,OAAQ,eAAgB,oBAAqB,aAAc,YAE3DD,UAAWR,OAAOU,UAAU1B,IAAI,aAChCoB,YAAa,sBACbK,OAAQ,eAAgB,YAExBD,UAAWR,OAAOU,UAAU1B,IAAI,eAChCoB,YAAa,wBACbK,OAAQ,YAERD,UAAWR,OAAOU,UAAU1B,IAAI,sBAChCoB,YAAa,iCACbK,OAAQ,aAAc,YAIxBH,KAAKK,OAAOP,EAAaC,IAM3BO,eACEC,OACEC,MACEC,YACEC,KAAQ,SAGZC,UACEF,YACEC,KAAQ,gBACRE,YAAe,SAGnBC,sBACEJ,YACEC,KAAQ,gBACRE,YAAe,SAGnBE,eACEL,YACEC,KAAQ,gBACRK,gBAAmB,SAGvBC,aACEC,OAAQ,iBACRC,OACEC,IAAK,WACLC,MAAO,QAETC,gBAEFC,sBACEb,YACEC,KAAQ,gBACRE,YAAe,SAGnBW,oBACEN,OAAU,wBACVC,OACEC,IAAO,WACPV,YACEM,gBAAmB,QACnBL,KAAQ,YAIdc,QACEP,OAAU,WAAY,QACtBQ,QACEN,IAAO,YACPV,YACEC,KAAQ,WAEVgB,OAAWC,QAAS,SAAU,SAShCT,OACEC,IAAO,WACPV,YACEM,gBAAmB,QACnBL,KAAQ,WAGZkB,OACEC,YAAe,sBACfpB,gBAGJqB,oBACEb,OAAU,wBACVC,OACEC,IAAO,WACPC,MAAS,QAEXW,WACEZ,IAAO,WACPC,MAAS,QAEXY,eACEb,IAAO,WACPC,MAAS,qBAIfa,UACAC,IACEC,SACAC,aACEC,eACAC,eAEFC,SAAY,SAAU,OAAQ,OAAQ,cAAe,aAAc,gBACnEC,SACEC,OAAU,cAAe,SAAU,OAAQ,OAAQ,eACnDC,SAAY,cAAe,SAAU,QACrCC,aAAgB,UAAW,QAAS,SAAU,eAAgB,UAEhEC,cAAc,IAIlBC,YAAatD,KFyFT,SAAU5B,EAAQD,EAASH,GAEjC,YAeA,SAASuF,GAAgBzD,EAAK0D,EAAK9E,GAAiK,MAApJ8E,KAAO1D,GAAOf,OAAOC,eAAec,EAAK0D,GAAO9E,MAAOA,EAAOQ,YAAY,EAAMD,cAAc,EAAMwE,UAAU,IAAkB3D,EAAI0D,GAAO9E,EAAgBoB,EAE3M,QAAS4D,GAAmBC,GAAO,GAAIC,MAAMC,QAAQF,GAAM,CAAE,IAAK,GAAItF,GAAI,EAAGyF,EAAOF,MAAMD,EAAII,QAAS1F,EAAIsF,EAAII,OAAQ1F,IAAOyF,EAAKzF,GAAKsF,EAAItF,EAAM,OAAOyF,GAAe,MAAOF,OAAMI,KAAKL,GAd1L5E,OAAOC,eAAeb,EAAS,cAC7BO,OAAO,GAGT,IAAIuF,GAAiB,WAAc,QAASC,GAAcP,EAAKtF,GAAK,GAAI8F,MAAeC,GAAK,EAAUC,GAAK,EAAWC,MAAKC,EAAW,KAAM,IAAK,GAAiCC,GAA7BC,EAAKd,EAAIe,OAAOC,cAAmBP,GAAMI,EAAKC,EAAGG,QAAQC,QAAoBV,EAAKW,KAAKN,EAAG9F,QAAYL,GAAK8F,EAAKJ,SAAW1F,GAA3D+F,GAAK,IAAoE,MAAOW,GAAOV,GAAK,EAAMC,EAAKS,EAAO,QAAU,KAAWX,GAAMK,EAAW,QAAGA,EAAW,SAAO,QAAU,GAAIJ,EAAI,KAAMC,IAAQ,MAAOH,GAAQ,MAAO,UAAUR,EAAKtF,GAAK,GAAIuF,MAAMC,QAAQF,GAAQ,MAAOA,EAAY,IAAIe,OAAOC,WAAY5F,QAAO4E,GAAQ,MAAOO,GAAcP,EAAKtF,EAAa,MAAM,IAAI2G,WAAU,4DGrQtlBC,EAAAjH,EAAA,GHyQIkH,EAEJ,SAAgCpF,GAAO,MAAOA,IAAOA,EAAIT,WAAaS,GAAQC,QAASD,IAFpDmF,GGxQ7BE,EAAQhF,OAAOgF,MAEfC,EAAsBjF,OAAOkF,QAAQ,0BACrCC,EAAenF,OAAOoF,QAAQC,SAC9BC,EAAWtF,OAAOoF,QAAQG,KAK1BC,EAAexF,OAAOU,UAAUR,OAAO,eAAxBkD,GAQnBjD,KARmB,SAQdsF,EAAQC,GAAS,GAAAC,GAAArF,IAEpBA,MAAK7B,KAAO,eACZ6B,KAAKsF,SAAW/H,EAAQ,GAGxByC,KAAKuF,gBACHpH,KAAM,OACNuC,KAAM,SAENvC,KAAM,SACNuC,KAAM,WAENvC,KAAM,SACNuC,KAAM,WAENvC,KAAM,KACNuC,KAAM,OAGRV,KAAKwF,aACHC,oBAAqB,WAEdJ,EAAKlF,MAAMuF,QAEZL,EAAKM,YACPN,EAAKO,gBAGTC,uBAAwB,WAClBR,EAAKM,aACPN,EAAKS,cACLT,EAAKU,iBACLV,EAAKW,sBACLX,EAAKY,YAGTC,iCAAkC,WAC5Bb,EAAKM,YACHN,EAAKc,YACPd,EAAKe,MAAK,IAIhBC,8BAA+B,WAC7BhB,EAAKiB,eAEPC,0BAA2B,WACzBlB,EAAKU,kBAEPS,iCAAkC,WAChCnB,EAAKU,kBAEPU,+BAAgC,WAC9BpB,EAAKU,mBAKT/F,KAAKK,OAAO8E,EAAQC,GAGpBpF,KAAK0G,OAAS,KACd1G,KAAK2G,OAASC,GAAGC,aAAaD,GAAGE,kBAGjC9G,KAAK+G,MAAQpC,EAAoB,WAGnCiB,aA7EmB,WA6EJ,GAAAoB,GAAAhH,IACbA,MAAKG,MAAMqB,OAAOyF,SAASjH,KAAKG,MAAMK,KAAKvC,MAAO,SAAAiJ,GAChDF,EAAKE,OAASA,EAEVF,EAAKE,QACHF,EAAKb,YACPa,EAAKZ,UASbe,UA5FmB,WA6FjBnH,KAAKoH,QAAUR,GAAGS,OAAOrH,KAAKoH,SAM9BpH,KAAKsH,OAAStH,KAAKoH,QAAQC,OAAO,kBAClCrH,KAAKuH,OAASvH,KAAKoH,QAAQC,OAAO,qBAClCrH,KAAKwH,YAAcxH,KAAKoH,QAAQC,OAAO,wBACvCrH,KAAKyH,OAASzH,KAAKoH,QAAQC,OAAO,oBAClCrH,KAAK0H,aAAe1H,KAAKoH,QAAQC,OAAO,gBACxCrH,KAAK2H,cAAgB3H,KAAKoH,QAAQC,OAAO,qBACzCrH,KAAK4H,OAAShB,GAAGiB,cACdC,OAAO9H,KAAKG,MAAM+B,GAAGE,YAAYC,aACjC0F,MAAM/H,KAAKG,MAAM+B,GAAGE,YAAYE,YAGnCtC,KAAK+G,MAAMiB,WAAWhI,KAAKG,MAAMqB,OAAOC,OAAOwG,oBAE/CjI,KAAKkI,UAAYlI,KAAKG,MAAM8B,OAAOkG,GACnCnI,KAAKoI,iBACLpI,KAAKqI,eAAiBrI,KAAKG,MAAM+B,GAAGU,aACpC5C,KAAKsI,WAAatI,KAAKG,MAAMqB,OAAOC,OAAOwG,mBAE3CjI,KAAKuI,QAELvI,KAAK8F,eAOPyC,MA9HmB,WA8HX,GAAAC,GAAAxI,IACNA,MAAKyI,QAAUzI,KAAKG,MAAMK,KAAKkI,eAC/B1I,KAAK2I,KAAOjE,EAAMkE,OAAO5I,KAAKG,MAAMqB,OAAOqH,mBAAoBC,WAAY,UAC3E9I,KAAK+I,IAAM/I,KAAK2I,KAAKK,KAAK,KAC1BhJ,KAAKiJ,SAAWjJ,KAAKG,MAAMqB,OAAO0H,qBAClClJ,KAAKmJ,WAAanJ,KAAKG,MAAMqB,OAAO4H,oBAEpCpJ,KAAKG,MAAMqB,OAAOyF,SAASjH,KAAKG,MAAMK,KAAKvC,MAAO,SAAAiJ,GAChDsB,EAAKtB,OAASA,EAEVsB,EAAKtB,SACPsB,EAAKa,WAAab,EAAKrI,MAAMqB,OAAO8H,UAChCd,EAAKrC,aACPqC,EAAKpC,MAAK,GACVoC,EAAKzC,iBACLyC,EAAKlC,mBAMbiD,OAnJmB,WAoJjBvJ,KAAKoG,MAAK,GACVpG,KAAKsG,eAGPH,SAxJmB,WAwJR,GAAAqD,GAAAxJ,KACHyJ,EAAQzJ,IAEdA,MAAK0J,WAAa1J,KAAKG,MAAM8B,OAAO0H,cAEpC,IAAMC,GAAc5J,KAAKkH,OAAOzF,MAChC,KAAKnD,OAAOuL,KAAKD,GAAatG,OAAQ,OAAO,CAE7CtD,MAAK8J,eAAiB9J,KAAK+J,iBAAiBH,EAAa5J,KAAKiJ,SAASxH,QAEvEzB,KAAKsH,OACFD,OAAO,iBACPA,OAAO,QACP2C,GAAG,QAAS,iBACXR,GAAKS,OACFC,gBAAgB,sBAChBC,SAAS,UACTC,OAAO,QACPC,OAAO,OACPC,aACAC,WAIPvK,KAAK0G,OAAS1G,KAAKG,MAAMqB,OAAOC,OAAO+I,WAAWC,OAClDzK,KAAK2G,OAAS3G,KAAKG,MAAMqB,OAAOI,MAAM4I,WAEtC9F,EAAMgG,QAAQ1K,KAAK2H,cAAe3C,GAC/BqC,OAAO,OACPsD,KAAK,QAAS,GAAGA,KAAK,SAAU,GAEnC3K,KAAK2H,cAAciD,OAAO,QACvBC,KAAK7K,KAAK0J,WAAW,sBAExB1J,KAAK2H,cACFqC,GAAG,QAAS,iBAAMR,GAAKS,OAAOC,gBAAgB,yBAAyBK,WACvEP,GAAG,YAAa,iBAAMR,GAAKxD,oBAAoB,KAC/CgE,GAAG,WAAY,iBAAMR,GAAKxD,uBAE7B,IAAM8E,GAAgB9K,KAAKG,MAAMqB,OAAOC,OAAOsJ,iBAuB/C,OAtBArG,GAAMgG,QAAQ1K,KAAKuH,OAAQ1C,GACxBwC,OAAO,OAAOsD,KAAK,QAAS,GAAGA,KAAK,SAAU,GAC9CK,MAAM,UAAWC,OAAOC,QAAQJ,EAAcK,aAAeL,EAAcM,cAE9EpL,KAAKuH,OAAOyC,GAAG,QAAS,WACtBR,EAAKS,OAAOC,gBAAgB,uBAAuBmB,QAGrDrL,KAAKuH,OAAOyC,GAAG,YAAa,WAC1B,GAAMsB,GAAOtL,KAAKuL,UACZC,EAAM9G,EAAM+G,oBAAoBzL,KAAMA,KAAK0L,yBAC3CC,EAAQH,EAAIF,EAAKM,EAAI,GAAIN,EAAKO,EAAIP,EAAKQ,OAAS,GACtDrC,GAAMQ,OAAOC,gBAAgB,uBAC1B6B,QAAQ,UACRC,OACAC,OAAON,EAAMC,EAAGD,EAAME,KAG3B7L,KAAKuH,OAAOyC,GAAG,WAAY,WACzBP,EAAMQ,OAAOC,gBAAgB,uBAAuBgC,UAG/C,GAGT9F,KAzNmB,WAyNC,GAAf+F,GAAeC,UAAA9I,OAAA,OAAAQ,KAAAsI,UAAA,IAAAA,UAAA,EAClBpM,MAAKqM,OAAsB,MAAbrM,KAAKQ,KAAeR,KAAKG,MAAMK,KAAKvC,MAAQ+B,KAAKQ,KAC/DR,KAAKQ,KAAOR,KAAKG,MAAMK,KAAKvC,KAE5B,IAAMqO,GAAWtM,KAAKG,MAAMK,KAAK+L,SAAYvM,KAAKQ,KAAOR,KAAKqM,OAAS,EAAKrM,KAAKG,MAAMK,KAAKgM,gBAAkB,CAG1GxM,MAAKyM,SAASH,EAAUH,IAC5BnM,KAAK0M,SAASJ,EAAUH,IAM1BM,SAvOmB,WAuOI,GAAdH,GAAcF,UAAA9I,OAAA,OAAAQ,KAAAsI,UAAA,GAAAA,UAAA,GAAH,EACZO,GACJC,OACEC,QAAUC,IAAK,GAAIC,MAAO,EAAGC,KAAM,EAAGC,OAAQ,IAC9CC,cAAgBJ,IAAK,GAAIC,MAAO,GAAIE,OAAQ,GAAID,KAAM,IACtDG,aAAc,GACdC,aAAc,EACdC,UAAW,GACXC,UAAW,EACXC,cAAe,EACfC,eAAgB,EAChBC,aAAc,IAEhBC,QACEb,QAAUC,IAAK,GAAIC,MAAO,EAAGC,KAAM,EAAGC,OAAQ,IAC9CC,cAAgBJ,IAAK,GAAIC,MAAO,GAAIE,OAAQ,GAAID,KAAM,IACtDG,aAAc,GACdC,aAAc,EACdC,UAAW,GACXC,UAAW,EACXC,cAAe,EACfC,eAAgB,EAChBC,aAAc,IAEhBE,OACEd,QAAUC,IAAK,GAAIC,MAAO,EAAGC,KAAM,EAAGC,OAAQ,IAC9CC,cAAgBJ,IAAK,GAAIC,MAAO,GAAIE,OAAQ,GAAID,KAAM,IACtDG,aAAc,GACdC,aAAc,EACdC,UAAW,GACXC,UAAW,EACXC,cAAe,EACfC,eAAgB,EAChBC,aAAc,KAIZG,GACJF,QACEb,QAAUC,IAAK,GAAIC,MAAO,GAAIC,KAAM,GAAIC,OAAQ,IAChDC,cAAgBJ,IAAK,GAAIC,MAAO,GAAIE,OAAQ,GAAID,KAAM,IACtDG,aAAc,GACdC,aAAc,GACdC,UAAW,GACXC,UAAW,GAEbK,OACEd,QAAUC,IAAK,GAAIC,MAAO,GAAIC,KAAM,GAAIC,OAAQ,IAChDC,cAAgBJ,IAAK,GAAIC,MAAO,GAAIE,OAAQ,GAAID,KAAM,IACtDG,aAAc,GACdC,aAAc,GACdC,UAAW,GACXC,UAAW,GAIftN,MAAK6N,cAAgB7N,KAAK8N,iBAAiBnB,EAAUiB,EAxDhC,IAAAG,GA+DjB/N,KAAK6N,cAJPhB,EA3DmBkB,EA2DnBlB,OACAK,EA5DmBa,EA4DnBb,aACAC,EA7DmBY,EA6DnBZ,aACAC,EA9DmBW,EA8DnBX,YAMF,IAHApN,KAAK8L,OAASkC,SAAShO,KAAKoH,QAAQ4D,MAAM,UAAW,KAAO,EAC5DhL,KAAKiO,MAAQD,SAAShO,KAAKoH,QAAQ4D,MAAM,SAAU,KAAO,GAErDhL,KAAK8L,SAAW9L,KAAKiO,MAAO,MAAOvJ,GAAMO,KAAK,4EAEnDjF,MAAKwH,YACFwD,MAAM,SAAahL,KAAK8L,OAASe,EAAOI,OAASJ,EAAOC,IAD3D,MAIA9M,KAAKsH,OAAOqD,KAAK,SAAUkC,EAAOC,IAClC,IAAMoB,GAAclO,KAAKsH,OAAOD,OAAO,iBA3ElB8G,EA8EEnO,KAAKG,MAAMqB,OAAOC,OAAOsJ,kBAAxC5M,EA9EagQ,EA8EbhQ,KAAMiQ,EA9EOD,EA8EPC,KAERC,EAAkBH,EACrB7G,OAAO,OAEV,IAAI+G,EAAM,CACRC,EAAgBxD,KAAQ1M,EAAxB,KAAiCiQ,EAELlB,GAAaF,KACrCkB,EAAYI,OAAO/C,UAAU0C,MAC7Bb,EACAD,EAEsBnN,KAAKiO,MAAQf,EAAaH,OAClDsB,EAAgBxD,KAAK1M,OAGvBkQ,GAAgBxD,KAAK1M,EAGvB,IAAMoQ,GAAkBL,EAAYI,OAAO/C,UAErCiD,EAAUtB,EAAaF,KACvByB,EAAUvB,EAAaJ,IAAMyB,EAAgBzC,MACnDoC,GACGvD,KAAK,YADR,aACkC6D,EADlC,KAC8CC,EAD9C,IAGA,IAAMC,GAAa1O,KAAKuH,MAExBmH,GAAWrH,OAAO,OACfsD,KAAK,QAAYwC,EADpB,MAEGxC,KAAK,SAAawC,EAFrB,KAIA,IAAMwB,GAASH,EAAUN,EAAYI,OAAO/C,UAAU0C,MAAQb,EACxDwB,EAAS1B,EAAaJ,IAAMK,EAAe,CACjDuB,GAAW/D,KAAK,YAAhB,aAA0CgE,EAA1C,KAAqDC,EAArD,IAGA,IAAMC,GAAc7O,KAAKsH,OAAOD,OAAO,gBAEnCiF,GACFuC,EAAYxH,OAAO,QAChByH,WAAW,QACXC,MAAMzC,GACNzB,KAAK7K,KAAKG,MAAMK,KAAKwO,WAAWhP,KAAKQ,OAExCqO,EAAYxH,OAAO,QAChB4H,YACApE,KAAK7K,KAAKG,MAAMK,KAAKwO,WAAWhP,KAAKQ,OAE1CqO,EAAY7D,MAAM,UAAWC,OAAmC,UAA5BjL,KAAKkP,oBAEzC,IAAMC,GAAkBN,EAAYP,OAAO/C,UAErC6D,EAAUpP,KAAKiO,MAAQf,EAAaH,MAAQoC,EAAgBlB,MAC5DoB,EAAUnC,EAAaJ,IAAMqC,EAAgBrD,MACnD+C,GACGlE,KAAK,YADR,aACkCyE,EADlC,KAC8CC,EAD9C,KAEGC,QAAQ,kBAAmBf,EAAgBN,MAAQkB,EAAgBlB,MAAQ,GAAKjO,KAAKiO,OAExFjO,KAAKoH,QAAQC,OAAO,yBACjB2D,MAAM,SAAa6B,EAAOI,OAD7B,KAIA,IAAMsC,GAAcvP,KAAK2H,cAAcN,OAAO,QAAQiH,OAAO/C,SAC7DvL,MAAK2H,cACFgD,KAAK,YADR,cACkC3K,KAAKiO,MAAQpB,EAAOE,MAAQwC,EAAYtB,OAD1E,KACoFsB,EAAYzD,OADhG,KAEGzE,OAAO,QAEVrH,KAAK2H,cACFN,OAAO,OACPsD,KAAK,QAAS4E,EAAYzD,QAC1BnB,KAAK,SAAU4E,EAAYzD,QAC3BnB,KAAK,KAAM4E,EAAYzD,OAAS,GAChCnB,KAAK,IAA2B,EAArB4E,EAAYzD,QAE1B9L,KAAKgG,uBAGP0G,SApYmB,WAoYmB,GAAA8C,GAAAxP,KAA7BsM,EAA6BF,UAAA9I,OAAA,OAAAQ,KAAAsI,UAAA,GAAAA,UAAA,GAAlB,EAAGD,EAAeC,UAAA9I,OAAA,OAAAQ,KAAAsI,UAAA,IAAAA,UAAA,GAC9BrD,EAAM/I,KAAK+I,GAEjB/I,MAAKyP,qBACHzP,KAAK0H,aAAagI,UAAU,eACzBC,KAAK3P,KAAK8J,eAAgB,SAAA5L,GAAA,MAAKA,GAAE6K,KALF,IAS5BnG,GAAiB5C,KAAKG,MAAM+B,GAA5BU,aACFgN,EAA0B5P,KAAKqI,gBAAkBzF,CAEnDgN,KACF5P,KAAKqI,cAAgBzF,EAIvB,IAAMiN,GAAsD,oBAAxB7P,MAAK8P,gBACpC9P,KAAK8P,iBAAmB9P,KAAK8J,eAAexG,QAE7CsM,GAA2BC,IACzBA,IACF7P,KAAK8P,eAAiB9P,KAAK8J,eAAexG,QAI9CtD,KAAK+P,aACL/P,KAAKiG,QAAQqG,GACbtM,KAAKsG,aA5B+B,IAAA0J,GA+B4BhQ,KAAK6N,cAA7DN,EA/B4ByC,EA+B5BzC,cAAeC,EA/BawC,EA+BbxC,eAAgBC,EA/BHuC,EA+BGvC,aAAcZ,EA/BjBmD,EA+BiBnD,OAC7CpL,EAAWzB,KAAKG,MAAMqB,OAAtBC,OACFwO,EAASxO,EAAOyO,UAAUzO,EAAOL,OACjC+O,EAAMC,KAAKC,IAAIJ,EAAOK,MAAQF,KAAKC,IAAIJ,EAAOM,KAC9CC,EAAoBL,EAAMF,EAAOM,IAAM,EAAIN,EAAOK,IAAM,EAGxDG,GACFzQ,KAAKiO,MACHpB,EAAOE,MACPF,EAAOG,KACPO,EACAE,GACC+C,EAAoB,EAAIxQ,KAAK0Q,0BAC7BF,EAAoB,EAAI,EAE/BxQ,MAAK0G,OACFqB,OAAO,EAAG0I,IAE8B,QAAvCzQ,KAAKG,MAAMqB,OAAOC,OAAOkP,WAC3B3Q,KAAK0G,OACFoB,QAAQ,EAAGsI,KAAKE,IAALM,MAAAR,KAAAnN,EAAYjD,KAAK0G,OAAOoB,YAGxC,IAAM+I,GAAQL,EAAoBC,EAAYzQ,KAAK0Q,uBAE7CI,EAAW,SAAC7S,GAAD,MAAWuR,GAAK9I,OAAOzI,IAClC8S,EAAa,SAAA9S,GAAA,MAASkS,GAAMlS,GAAS,EAAIA,EAAQ,GAEjD+S,EAAc,SAAA/S,GAAA,MAAS8S,GAAW9S,GAAS,MAAQ,SACnDgT,EAAc,SAAAhT,GAAA,MAAS8S,GAAW9S,GAAS,QAAU,OAErDiT,EAAS,SAAAjT,GAAA,MAAS8S,GAAW9S,GAChC4O,EAAOG,KAAO6D,EACdrB,EAAKvB,MAAQ4C,EAAQpD,EAAeZ,EAAOE,OAExCoE,EAAO,SAAAlT,GAAA,MAAS8S,GAAW9S,GAC9BiT,EAAOjT,GAASsP,EAChB2D,EAAOjT,GAASsP,GAEb6D,EAAS,SAAAnT,GAAA,MAAS8S,GAAW9S,GAChCkT,EAAKlT,GAASuP,EACd2D,EAAKlT,GAASuP,GAEX6D,EAAcrR,KAAK0Q,sBAAqB,IAASP,EAAMtD,EAAOG,KAAOH,EAAOE,OAAU8D,CAC5F7Q,MAAK8J,eAAewH,QAAQ,SAACC,GAAQ,GAC3BtT,GAAUsT,EAAVtT,KAoBR,KAlBIkO,GAASyD,GAA2B2B,EAAIC,OAASD,EAAIE,gBACvDF,EAAIG,SACD/G,KAAK,IAAKuG,EAAOjT,IACjB0M,KAAK,IAAK6E,EAAK3B,cAAcR,UAAY,GACzC1C,KAAK,cAAeqG,EAAY/S,IAChC4M,KAAKwG,EAAaE,EAAIrQ,MAAQqQ,EAAII,YAErCJ,EAAIK,QACDjH,KAAK,KAAM6E,EAAK3B,cAAcR,UAAY,GAC1C1C,KAAK,KAAM6E,EAAK3B,cAAcR,UAAY,GAC1C1C,KAAK,SAAU6E,EAAK3B,cAAcR,WAErCkE,EAAIM,SACDlH,KAAK,IAAKyG,EAAOnT,IACjB0M,KAAK,IAAK6E,EAAK3B,cAAcR,UAAY,GACzC1C,KAAK,cAAesG,EAAYhT,KAGjCkO,GAASoF,EAAIO,cAAgBlC,EAAyB,CACxD,GAAM3B,GAAQmC,KAAKE,IAAI,EAAGrS,GAAS6S,EAASV,KAAKC,IAAIpS,MAAY,GAE7DkO,GAASoF,EAAIO,cAAgBlC,IAC/B2B,EAAIK,QACD9C,aAAaxC,SAASA,GAAUyF,KAAKnL,GAAGoL,YACxCrH,KAAK,QAASsD,GAGnBsD,EAAIK,QACDjH,KAAK,IAAKwG,EAAKlT,IAAUA,EAAQ,EAAIgQ,EAAQ,KAE5C9B,GAASoF,EAAIE,eACfF,EAAIM,SACDhH,KAAK2E,EAAKlH,WAAWrK,IAAUuR,EAAK9F,WAAW,kBAIlDyC,GAASoF,EAAIU,cAAgBrC,MAC9BtD,GAAYiF,EAAIW,KAAKjD,aACrB3C,EAAWiF,EAAIW,KAAKpD,aAAaxC,SAASA,GAAUyF,KAAKnL,GAAGoL,YAAcT,EAAIW,MAC5EvH,KAAK,YADR,gBACqC6E,EAAK2C,gBAAgBZ,EAAIa,OAD9D,SAMNrC,WA/fmB,WA+fN,GAAAsC,GACsBrS,KAAK6N,cAA9BR,EADGgF,EACHhF,UAAWC,EADR+E,EACQ/E,SACnBtN,MAAKyH,OAAOkD,KAAK,UAAc0C,EAAYC,GAAatN,KAAK8J,eAAexG,OAA5E,OAGF2C,QApgBmB,WAogBG,GAAdqG,GAAcF,UAAA9I,OAAA,OAAAQ,KAAAsI,UAAA,GAAAA,UAAA,GAAH,EACXkG,EAAStS,KAAK0H,aAAaL,OAAO,gBACxC,KAAKiL,EAAOC,QAAS,CACnB,GAAMrU,GAAIoU,EAAOE,QACXC,EAAOzS,KAAKmS,gBAAgBjU,EAAEkU,OAE5BvF,EAAW7M,KAAK6N,cAAhBhB,OACFf,EAAS9L,KAAK8L,OAASe,EAAOC,IAAMD,EAAOI,OAE3CyF,EAAWD,GAAQ3G,EAAS9L,KAAK6N,cAAcR,WAAa,CAClErN,MAAKwH,YAAYsH,aAAaxC,SAASA,GACpCqG,MAAM,YAAczU,EAAE0U,OAAQ5S,KAAK6S,gBAAgBH,MAI1DI,cAnhBmB,SAmhBL5L,EAAQiC,EAAYjL,GAChC,MAAO8B,MAAK2I,KAAKoK,IAAI,SAAAhQ,GAAA,MAAOmE,GAAOiC,EAAWpG,IAAQmE,EAAOiC,EAAWpG,IAAM7E,EAAE6E,IAAQ7E,EAAE6E,KAAMiG,KAAK,OAGvGyG,qBAvhBmB,SAuhBEuD,GACnB,GAAMvJ,GAAQzJ,KACR2I,EAAO3I,KAAK2I,KAFcsK,GAGfjT,KAAKiJ,SAHUzF,EAMfxD,KAAK8J,eANU,IAMzB8I,EANyBK,EAAA,EAO3BjT,MAAKoI,cAAcwK,EAAOA,UAC7B5S,KAAKoI,cAAcwK,EAAOA,QAAUA,EAAO1R,MAG7C,IAAMA,GAAQlB,KAAK8S,cAAc9S,KAAKkH,OAAQlH,KAAKmJ,WAAYyJ,EAAOA,QAChEM,EAAgBlT,KAAKoI,cAAcwK,EAAOA,UAAY1R,GACvDlB,KAAKG,MAAM8B,OAAOkG,KAAOnI,KAAKkI,SAE/BgL,KACFlT,KAAKkI,UAAYlI,KAAKG,MAAM8B,OAAOkG,GACnCnI,KAAKoI,cAAcwK,EAAOA,QAAU1R,GAItC8R,EAAYG,OAAOC,SAGnBJ,GAAeE,EAAgBF,EAAcA,EAAYK,QAAQzI,OAAO,MACrE0I,KAAK,SAASpV,GACb,GAAMgU,GAAOtL,GAAGS,OAAOrH,MAEjBkB,EAAQhD,EAAEgD,MACVyQ,EAAazQ,EAAMoC,OAAS,GAAKpC,EAAWA,EAAMqS,UAAU,EAAG,GAAlD,MAEbC,EAAgBtB,EAAK7K,OAAO,iBAC5BqK,EAAW8B,EAAcC,OAC7BD,EACAtB,EAAKtH,OAAO,QACTD,KAAK,QAAS,gBACdA,KAAK,KAAM,UAEV+I,EAAahC,EAAS7G,KAAK3J,GAAOoN,OAAO/C,UAAU0C,MACnD0F,EAAkBjC,EAAS7G,KAAK8G,GAAYrD,OAAO/C,UAAU0C,KASnE,IAPA3P,OAAOsV,OAAO1V,GACZwV,aACAC,kBACAhC,aACAD,cAGGwB,EAAe,CAClBhB,EACGvH,KAAK,QAAS,cACd2E,QAAQ,eAAgB7F,EAAMtJ,MAAMqB,OAAOqS,WAAW3V,EAAE0U,SACxDjI,KAAK,KAHR,cAG4BjG,EAAMoP,OAAO5V,EAAE0U,OAAQjK,GAHnD,IAG4Dc,EAAMsK,KAC/D/J,GAAG,YAAa,SAAA9L,GAAA,MAAKuL,GAAMtJ,MAAMqB,OAAOwS,gBAAgB9V,EAAE0U,UAC1D5I,GAAG,WAAY,iBAAMP,GAAMtJ,MAAMqB,OAAOyS,qBACxCjK,GAAG,QAAS,SAAA9L,GACXuL,EAAMtJ,MAAMqB,OAAO0S,aAAahW,EAAE0U,SAGtC,IAAMhB,GAAUM,EAAKtH,OAAO,QACzBD,KAAK,SAAU,eAEZkH,EAAWK,EAAKtH,OAAO,QAC1BD,KAAK,QAAS,gBACdA,KAAK,KAAM,SAEdrM,QAAOsV,OAAO1V,GACZgU,OACAV,OAAO,EACPI,UACAC,gBAILsC,MAAMnB,IAGXtC,qBApmBmB,WAomBe,GAAb0D,GAAahI,UAAA9I,OAAA,OAAAQ,KAAAsI,UAAA,IAAAA,UAAA,GAC1BiI,EAAWD,EAAM,aAAe,kBAChCE,EAAWF,EAAM,QAAU,aAE3B7C,EAAMvR,KAAK8J,eACdyK,OAAO,SAACC,EAAGC,GAAJ,MAAUD,GAAEH,GAAYI,EAAEJ,GAAYI,EAAID,IAE9C3J,EAAO0G,EAAIG,SAAS7G,OACpBoD,EAAQsD,EAAIG,SAAS7G,KAAK0G,EAAI+C,IAAWhG,OAAO/C,UAAU0C,KAGhE,OAFAsD,GAAIG,SAAS7G,KAAKA,GAEXoD,GAGT3H,YAlnBmB,WAknBL,GAAAoO,GAAA1U,KACNyJ,EAAQzJ,KACRiJ,EAAWjJ,KAAKiJ,QAEtBjJ,MAAK0H,aAAagI,UAAU,oBACzB4D,KAAK,SAAAqB,GAAqB,GAAV/B,GAAU+B,EAAV/B,OACTtH,EAAO1E,GAAGS,OAAOrH,MAEjB4U,EAAanL,EAAMvC,OAAOtF,MAAM8C,EAAMoP,OAAOlB,EAAQ3J,EAASrH,QAC9DiT,EAAeD,GAA6B,IAAfA,EAE7BE,EAAYD,EAAeE,OAAOtL,EAAMuL,UAAUJ,IA/nBzC,qBAgoBTK,EAAcJ,EAAe,cAjoBpB,iBAmoBfvJ,GAAKN,MAAM,UAAY8J,GAAaxJ,EAAKN,MAAM,OAAQ8J,GACvDxJ,EAAKN,MAAM,YAAciK,GAAe3J,EAAKN,MAAM,SAAUiK,KAGjEjV,KAAK0H,aAAagI,UAAU,oBACzB1E,MAAM,OAAQ,SAAAkK,GAAA,GAAGtC,GAAHsC,EAAGtC,MAAH,OAAgB8B,GAAKS,gBAAgBT,EAAKxN,OAAOtF,MAAM8C,EAAMoP,OAAOlB,EAAQ3J,EAASrH,SAAW,SAGnHoT,UAxoBmB,SAwoBT/W,GACR,MAAO2I,IAAGwO,IAAIpV,KAAK2G,OAAO1I,KAG5BkX,gBA5oBmB,SA4oBHjX,GACd,MAAO8B,MAAKgV,UAAU9W,GAAGmX,OAAO,IAQlCxC,gBArpBmB,SAqpBHyC,GACd,MAAO,YACL,GAAMhH,GAAOtO,KAAMpC,EAAIgJ,GAAG2O,kBAAkBvV,KAAKsV,UAAWA,EAC5D,OAAO,UAASE,GACdlH,EAAKgH,UAAY1X,EAAE4X,MAKzBrD,gBA9pBmB,SA8pBHvU,GACd,OAAQoC,KAAK6N,cAAcR,UAAYrN,KAAK6N,cAAcP,WAAa1P,GAGzE6X,aAEA1L,iBApqBmB,SAoqBF7C,EAAQwO,GAAS,GAAAC,GAAA3V,KAC1B2I,EAAO3I,KAAK2I,IACN3I,MAAK+I,IACA/I,KAAKiJ,QACtB,OAAOjJ,MAAKqJ,WAAW0J,IAAI,SAAAH,GAAU,GAAAgD,GAC7B7S,EAAM2B,EAAMoP,OAAOlB,EAAQjK,GAC3BkN,EAASF,EAAKF,UAAU1S,GACxB9E,EAAQiJ,EAAOxC,EAAMoP,OAAOlB,EAAQ8C,IACpCxU,EAAQyU,EAAK7C,cAAc6C,EAAKzO,OAAQyO,EAAKxM,WAAYyJ,GACzDkD,EAAiBH,EAAKrN,WAAWrK,EAEvC,OAAI4X,GACKvX,OAAOsV,OAAOiC,GACnB5X,QACAiD,QACA4U,iBACArE,aAAcqE,IAAmBD,EAAOC,eACxChE,aAAc7T,IAAU4X,EAAO5X,MAC/BuT,OAAO,IAIJmE,EAAKF,UAAU1S,IAAf6S,GACLhD,SACA3U,QACAiD,QACA4U,kBAJKhT,EAAA8S,EAKJD,EAAK5M,IAAMhG,GALPD,EAAA8S,EAAA,gBAMS,GANT9S,EAAA8S,EAAA,gBAOS,GAPT9S,EAAA8S,EAAA,SAQE,GARFA,KAUNG,KAAK,SAAAC,EAAAC,GAAA,GAAUzB,GAAVwB,EAAG/X,KAAH,OAAAgY,GAAiBhY,MAAmBuW,IACzCzB,IAAI,SAACH,EAAQR,GAAT,MACH9T,QAAOsV,OAAOhB,GACZR,QACAH,aAAcG,IAAUQ,EAAOR,WAIvCtM,YA5sBmB,WA4sBL,GAAAoQ,GAAAlW,KACN2I,EAAO3I,KAAK2I,KACZwN,EAAWnW,KAAKG,MAAMqB,OAAO6F,MAGnCrH,MAAK0H,aAAa4H,QAAQ,uBAAuB,GACjDtP,KAAK0H,aAAagI,UAAU,4BAA4BJ,QAAQ,gBAAgB,GAG5E6G,EAAS7S,SACXtD,KAAK0H,aAAa4H,QAAQ,uBAAuB,GACjD6G,EAAS7E,QAAQ,SAAA8E,GACfF,EAAKxO,aACFL,OADH,gBACyB,EAAA5C,EAAAnF,SAAUoF,EAAMoP,OAAOsC,EAAazN,IAD7D,IACuEuN,EAAKnC,KACzEzE,QAAQ,gBAAgB,OAMjCvJ,eAhuBmB,WAguBF,GACEvE,GAAaxB,KAAtBG,MAASqB,OAIf6U,EAME7U,EANF6U,UACAhP,EAKE7F,EALF6F,OAEqBiP,EAGnB9U,EAHF+U,oBACkBC,EAEhBhV,EAFFiV,iBACgBC,EACdlV,EADFmV,eAIAC,EAGAP,EAAU/S,OAAS,EAFnBuT,EAGAxP,EAAO/D,OAAS,CAGlBtD,MAAK0H,aAAagI,UAAU,eACzB1E,MAAM,UAAW,SAAA9M,GAChB,MAAI0Y,IAAmBpV,EAAOsV,cAAc5Y,EAAE0U,QApBhB,EAwB1BiE,EACKrV,EAAOqS,WAAW3V,EAAE0U,QAAU8D,EAAkBF,EAGrDI,EACKN,EAGFI,KAIb1Q,oBAvwBmB,SAuwBC+Q,GAClB/W,KAAK2H,cAAcqD,MAAM,UACvB+L,IACG/W,KAAKG,MAAMqB,OAAO6F,OAAO/D,OAExB,EADAtD,KAAK4H,QAAQ5H,KAAKG,MAAMK,KAAKvC,MAAM+Y,iBAAiBC,gBA3wBzC,yBAixBL/P,EAAQiC,EAAYjL,GAChC,MAAO8B,MAAK2I,KAAKoK,IAAI,SAAAhQ,GAAA,MAAOmE,GAAOiC,EAAWpG,IAAQmE,EAAOiC,EAAWpG,IAAM7E,EAAE6E,IAAQ7E,EAAE6E,KAAMiG,KAAK,QH6NzGtL,GAAQ4B,QGxNO4F,GH4NT,SAAUvH,EAAQD,EAASH,II7/BjC,SAAA2Z,IACC,SAAAC,EAAAC,GAIDzZ,EAAAD,QAAA0Z,EAAAD,IAQC,mBAAAD,KAAAlX,KAAA,SAAAmX,GAED,GAAAA,EAAAE,KAAAF,EAAAE,IAAAC,OACA,MAAAH,GAAAE,IAAAC,MAIA,IAAAC,GAAA,SAAAtZ,GACA,MAAAmO,UAAA9I,OACA,SAAAiB,WAAA,qCAQA,KANA,GAGAiT,GAHAC,EAAA1C,OAAA9W,GACAqF,EAAAmU,EAAAnU,OACA8O,GAAA,EAEAsF,EAAA,GACAC,EAAAF,EAAAG,WAAA,KACAxF,EAAA9O,GACAkU,EAAAC,EAAAG,WAAAxF,GA2BAsF,GArBA,GAAAF,EAQAA,GAAA,GAAAA,GAAA,SAAAA,GAGA,GAAApF,GAAAoF,GAAA,IAAAA,GAAA,IAIA,GAAApF,GACAoF,GAAA,IAAAA,GAAA,IACA,IAAAG,EAIA,KAAAH,EAAAP,SAAA,SAOA,GAAA7E,GACA,GAAA9O,GACA,IAAAkU,KAWAA,GAAA,KACA,IAAAA,GACA,IAAAA,GACAA,GAAA,IAAAA,GAAA,IACAA,GAAA,IAAAA,GAAA,IACAA,GAAA,IAAAA,GAAA,KAGAC,EAAAI,OAAAzF,GAjBA,KAAAqF,EAAAI,OAAAzF,GA/BA,GAyDA,OAAAsF,GAQA,OALAP,GAAAE,MACAF,EAAAE,QAGAF,EAAAE,IAAAC,OAAAC,EACAA,MJmgC6BzZ,KAAKJ,EAASH,EAAoB,KAIzD,SAAUI,EAAQD,KAMlB,SAAUC,EAAQD,GKpnCxBC,EAAAD,QAAA,klBL0nCM,SAAUC,EAAQD,GM1nCxB,GAAAoa,EAGAA,GAAA,WACA,MAAA9X,QAGA,KAEA8X,KAAAC,SAAA,qBAAAC,MAAA,QACC,MAAAC,GAED,iBAAAC,UACAJ,EAAAI,QAOAva,EAAAD,QAAAoa,GNioCM,SAAUna,EAAQD,EAASH,GAEjCI,EAAOD,QAAUH,EAAoB","file":"barrankchart.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 6);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__webpack_require__(3);\n\nvar _component = __webpack_require__(1);\n\nvar _component2 = _interopRequireDefault(_component);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar VERSION_INFO = { version: \"2.0.0\", build: 1516906861777 };\n\nexports.default = Vizabi.Tool.extend(\"BarRankChart\", {\n\n  // Run when the tool is created\n  init: function init(placeholder, externalModel) {\n\n    this.name = \"barrankchart\";\n\n    this.components = [{\n      component: _component2.default,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.marker\", \"locale\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.marker_tags\", \"state.time\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datawarning\"),\n      placeholder: \".vzb-tool-datawarning\",\n      model: [\"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    // constructor is the same as any tool\n    this._super(placeholder, externalModel);\n  },\n\n  /**\n   * Determines the default model of this tool\n   */\n  default_model: {\n    \"state\": {\n      \"time\": {\n        \"autoconfig\": {\n          \"type\": \"time\"\n        }\n      },\n      \"entities\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"entities_colorlegend\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      entities_tags: {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"includeOnlyIDs\": [\"tag\"]\n        }\n      },\n      marker_tags: {\n        space: [\"entities_tags\"],\n        label: {\n          use: \"property\",\n          which: \"name\"\n        },\n        hook_parent: {}\n      },\n      \"entities_allpossible\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"marker_allpossible\": {\n        \"space\": [\"entities_allpossible\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"marker\": {\n        \"space\": [\"entities\", \"time\"],\n        \"axis_x\": {\n          \"use\": \"indicator\",\n          \"autoconfig\": {\n            \"type\": \"measure\"\n          },\n          \"allow\": { scales: [\"linear\", \"log\"] }\n        },\n        // \"axis_y\": {\n        //   \"use\": \"property\",\n        //   \"allow\": { scales: [\"ordinal\", \"nominal\"] },\n        //   \"autoconfig\": {\n        //     \"type\": \"entity_domain\"\n        //   }\n        // },\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        },\n        \"color\": {\n          \"syncModels\": [\"marker_colorlegend\"],\n          \"autoconfig\": {}\n        }\n      },\n      \"marker_colorlegend\": {\n        \"space\": [\"entities_colorlegend\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"which\": \"name\"\n        },\n        \"hook_rank\": {\n          \"use\": \"property\",\n          \"which\": \"rank\"\n        },\n        \"hook_geoshape\": {\n          \"use\": \"property\",\n          \"which\": \"shape_lores_svg\"\n        }\n      }\n    },\n    locale: {},\n    ui: {\n      chart: {},\n      datawarning: {\n        doubtDomain: [],\n        doubtRange: []\n      },\n      \"buttons\": [\"colors\", \"find\", \"show\", \"moreoptions\", \"fullscreen\", \"presentation\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"find\", \"show\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"find\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"colors\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _css = __webpack_require__(2);\n\nvar _css2 = _interopRequireDefault(_css);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar utils = Vizabi.utils;\n\nvar axisWithLabelPicker = Vizabi.helpers['d3.axisWithLabelPicker'];\nvar iconQuestion = Vizabi.iconset.question;\nvar iconWarn = Vizabi.iconset.warn;\n\nvar COLOR_BLACKISH = \"rgb(51, 51, 51)\";\nvar COLOR_WHITEISH = \"rgb(253, 253, 253)\";\n\nvar BarRankChart = Vizabi.Component.extend(\"barrankchart\", _defineProperty({\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init: function init(config, context) {\n    var _this2 = this;\n\n    this.name = 'barrankchart';\n    this.template = __webpack_require__(4);\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    this.model_binds = {\n      'change:time.value': function changeTimeValue() {\n        // TODO: review this after vizabi#2450 will be fixed\n        if (!_this2.model._ready) return;\n\n        if (_this2._readyOnce) {\n          _this2.onTimeChange();\n        }\n      },\n      'change:marker.select': function changeMarkerSelect() {\n        if (_this2._readyOnce) {\n          _this2._selectBars();\n          _this2._updateOpacity();\n          _this2._updateDoubtOpacity();\n          _this2._scroll();\n        }\n      },\n      'change:marker.axis_x.scaleType': function changeMarkerAxis_xScaleType() {\n        if (_this2._readyOnce) {\n          if (_this2.loadData()) {\n            _this2.draw(true);\n          }\n        }\n      },\n      'change:marker.color.palette': function changeMarkerColorPalette() {\n        _this2._drawColors();\n      },\n      'change:marker.highlight': function changeMarkerHighlight() {\n        _this2._updateOpacity();\n      },\n      'change:marker.opacitySelectDim': function changeMarkerOpacitySelectDim() {\n        _this2._updateOpacity();\n      },\n      'change:marker.opacityRegular': function changeMarkerOpacityRegular() {\n        _this2._updateOpacity();\n      }\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    // set up the scales\n    this.xScale = null;\n    this.cScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n    // set up the axes\n    this.xAxis = axisWithLabelPicker(\"bottom\");\n  },\n  onTimeChange: function onTimeChange() {\n    var _this3 = this;\n\n    this.model.marker.getFrame(this.model.time.value, function (values) {\n      _this3.values = values;\n\n      if (_this3.values) {\n        if (_this3.loadData()) {\n          _this3.draw();\n        }\n      }\n    });\n  },\n\n\n  /**\n   * DOM and model are ready\n   */\n  readyOnce: function readyOnce() {\n    this.element = d3.select(this.element);\n\n    // reference elements\n    //this.graph = this.element.select('.vzb-br-graph');\n    //this.yearEl = this.element.select('.vzb-br-year');\n    //this.year = new DynamicBackground(this.yearEl);\n    this.header = this.element.select('.vzb-br-header');\n    this.infoEl = this.element.select('.vzb-br-axis-info');\n    this.barViewport = this.element.select('.vzb-br-barsviewport');\n    this.barSvg = this.element.select('.vzb-br-bars-svg');\n    this.barContainer = this.element.select('.vzb-br-bars');\n    this.dataWarningEl = this.element.select('.vzb-data-warning');\n    this.wScale = d3.scaleLinear().domain(this.model.ui.datawarning.doubtDomain).range(this.model.ui.datawarning.doubtRange);\n\n    // set up formatters\n    this.xAxis.tickFormat(this.model.marker.axis_x.getTickFormatter());\n\n    this._localeId = this.model.locale.id;\n    this._entityLabels = {};\n    this._presentation = !this.model.ui.presentation;\n    this._formatter = this.model.marker.axis_x.getTickFormatter();\n\n    this.ready();\n\n    this._selectBars();\n  },\n\n\n  /**\n   * Both model and DOM are ready\n   */\n  ready: function ready() {\n    var _this4 = this;\n\n    this.TIMEDIM = this.model.time.getDimension();\n    this.KEYS = utils.unique(this.model.marker._getAllDimensions({ exceptType: \"time\" }));\n    this.KEY = this.KEYS.join(\",\");\n    this.dataKeys = this.model.marker.getDataKeysPerHook();\n    this.labelNames = this.model.marker.getLabelHookNames();\n\n    this.model.marker.getFrame(this.model.time.value, function (values) {\n      _this4.values = values;\n\n      if (_this4.values) {\n        _this4.markerKeys = _this4.model.marker.getKeys();\n        if (_this4.loadData()) {\n          _this4.draw(true);\n          _this4._updateOpacity();\n          _this4._drawColors();\n        }\n      }\n    });\n  },\n  resize: function resize() {\n    this.draw(true);\n    this._drawColors();\n  },\n  loadData: function loadData() {\n    var _this5 = this;\n\n    var _this = this;\n\n    this.translator = this.model.locale.getTFunction();\n    // sort the data (also sets this.total)\n    var xAxisValues = this.values.axis_x;\n    if (!Object.keys(xAxisValues).length) return false;\n\n    this.sortedEntities = this._sortByIndicator(xAxisValues, this.dataKeys.axis_x);\n\n    this.header.select('.vzb-br-title').select('text').on('click', function () {\n      return _this5.parent.findChildByName('gapminder-treemenu').markerID('axis_x').alignX('left').alignY('top').updateView().toggle();\n    });\n\n    // new scales and axes\n    this.xScale = this.model.marker.axis_x.getScale().copy();\n    this.cScale = this.model.marker.color.getScale();\n\n    utils.setIcon(this.dataWarningEl, iconWarn).select('svg').attr('width', 0).attr('height', 0);\n\n    this.dataWarningEl.append('text').text(this.translator('hints/dataWarning'));\n\n    this.dataWarningEl.on('click', function () {\n      return _this5.parent.findChildByName('gapminder-datawarning').toggle();\n    }).on('mouseover', function () {\n      return _this5._updateDoubtOpacity(1);\n    }).on('mouseout', function () {\n      return _this5._updateDoubtOpacity();\n    });\n\n    var conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.infoEl, iconQuestion).select('svg').attr('width', 0).attr('height', 0).style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.infoEl.on('click', function () {\n      _this5.parent.findChildByName('gapminder-datanotes').pin();\n    });\n\n    this.infoEl.on('mouseover', function () {\n      var rect = this.getBBox();\n      var ctx = utils.makeAbsoluteContext(this, this.farthestViewportElement);\n      var coord = ctx(rect.x - 10, rect.y + rect.height + 10);\n      _this.parent.findChildByName('gapminder-datanotes').setHook('axis_x').show().setPos(coord.x, coord.y);\n    });\n\n    this.infoEl.on('mouseout', function () {\n      _this.parent.findChildByName('gapminder-datanotes').hide();\n    });\n\n    return true;\n  },\n  draw: function draw() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    this.time_1 = this.time == null ? this.model.time.value : this.time;\n    this.time = this.model.time.value;\n    //smooth animation is needed when playing, except for the case when time jumps from end to start\n    var duration = this.model.time.playing && this.time - this.time_1 > 0 ? this.model.time.delayAnimations : 0;\n\n    //return if drawAxes exists with error\n    if (this.drawAxes(duration, force)) return;\n    this.drawData(duration, force);\n  },\n\n\n  /*\n   * draw the chart/stage\n   */\n  drawAxes: function drawAxes() {\n    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n    var profiles = {\n      small: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 18,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 20\n      },\n      medium: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 21,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25\n      },\n      large: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 28,\n        barMargin: 4,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25\n      }\n    };\n\n    var presentationProfileChanges = {\n      medium: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 25,\n        infoElMargin: 10,\n        barHeight: 25,\n        barMargin: 6\n      },\n      large: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 10,\n        barHeight: 30,\n        barMargin: 6\n      }\n    };\n\n    this.activeProfile = this.getActiveProfile(profiles, presentationProfileChanges);\n\n    var _activeProfile = this.activeProfile,\n        margin = _activeProfile.margin,\n        headerMargin = _activeProfile.headerMargin,\n        infoElHeight = _activeProfile.infoElHeight,\n        infoElMargin = _activeProfile.infoElMargin;\n\n\n    this.height = parseInt(this.element.style('height'), 10) || 0;\n    this.width = parseInt(this.element.style('width'), 10) || 0;\n\n    if (!this.height || !this.width) return utils.warn('Dialog resize() abort: vizabi container is too little or has display:none');\n\n    this.barViewport.style('height', this.height - margin.bottom - margin.top + \"px\");\n\n    // header\n    this.header.attr('height', margin.top);\n    var headerTitle = this.header.select('.vzb-br-title');\n\n    // change header titles for new data\n\n    var _model$marker$axis_x$ = this.model.marker.axis_x.getConceptprops(),\n        name = _model$marker$axis_x$.name,\n        unit = _model$marker$axis_x$.unit;\n\n    var headerTitleText = headerTitle.select('text');\n\n    if (unit) {\n      headerTitleText.text(name + \", \" + unit);\n\n      var rightEdgeOfLeftText = headerMargin.left + headerTitle.node().getBBox().width + infoElMargin + infoElHeight;\n\n      if (rightEdgeOfLeftText > this.width - headerMargin.right) {\n        headerTitleText.text(name);\n      }\n    } else {\n      headerTitleText.text(name);\n    }\n\n    var headerTitleBBox = headerTitle.node().getBBox();\n\n    var titleTx = headerMargin.left;\n    var titleTy = headerMargin.top + headerTitleBBox.height;\n    headerTitle.attr('transform', \"translate(\" + titleTx + \", \" + titleTy + \")\");\n\n    var headerInfo = this.infoEl;\n\n    headerInfo.select('svg').attr('width', infoElHeight + \"px\").attr('height', infoElHeight + \"px\");\n\n    var infoTx = titleTx + headerTitle.node().getBBox().width + infoElMargin;\n    var infoTy = headerMargin.top + infoElHeight / 4;\n    headerInfo.attr('transform', \"translate(\" + infoTx + \", \" + infoTy + \")\");\n\n    var headerTotal = this.header.select('.vzb-br-total');\n\n    if (duration) {\n      headerTotal.select('text').transition('text').delay(duration).text(this.model.time.formatDate(this.time));\n    } else {\n      headerTotal.select('text').interrupt().text(this.model.time.formatDate(this.time));\n    }\n    headerTotal.style('opacity', Number(this.getLayoutProfile() !== 'large'));\n\n    var headerTotalBBox = headerTotal.node().getBBox();\n\n    var totalTx = this.width - headerMargin.right - headerTotalBBox.width;\n    var totalTy = headerMargin.top + headerTotalBBox.height;\n    headerTotal.attr('transform', \"translate(\" + totalTx + \", \" + totalTy + \")\").classed('vzb-transparent', headerTitleBBox.width + headerTotalBBox.width + 10 > this.width);\n\n    this.element.select('.vzb-data-warning-svg').style('height', margin.bottom + \"px\");\n\n    var warningBBox = this.dataWarningEl.select('text').node().getBBox();\n    this.dataWarningEl.attr('transform', \"translate(\" + (this.width - margin.right - warningBBox.width) + \", \" + warningBBox.height + \")\").select('text');\n\n    this.dataWarningEl.select('svg').attr('width', warningBBox.height).attr('height', warningBBox.height).attr('x', -warningBBox.height - 5).attr('y', -warningBBox.height + 1);\n\n    this._updateDoubtOpacity();\n  },\n  drawData: function drawData() {\n    var _this6 = this;\n\n    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    var KEY = this.KEY;\n    // update the shown bars for new data-set\n    this._createAndDeleteBars(this.barContainer.selectAll('.vzb-br-bar').data(this.sortedEntities, function (d) {\n      return d[KEY];\n    }));\n\n    var presentation = this.model.ui.presentation;\n\n    var presentationModeChanged = this._presentation !== presentation;\n\n    if (presentationModeChanged) {\n      this._presentation = presentation;\n    }\n\n    var entitiesCountChanged = typeof this._entitiesCount === 'undefined' || this._entitiesCount !== this.sortedEntities.length;\n\n    if (presentationModeChanged || entitiesCountChanged) {\n      if (entitiesCountChanged) {\n        this._entitiesCount = this.sortedEntities.length;\n      }\n    }\n\n    this._resizeSvg();\n    this._scroll(duration);\n    this._drawColors();\n\n    var _activeProfile2 = this.activeProfile,\n        barRectMargin = _activeProfile2.barRectMargin,\n        barValueMargin = _activeProfile2.barValueMargin,\n        scrollMargin = _activeProfile2.scrollMargin,\n        margin = _activeProfile2.margin;\n    var axis_x = this.model.marker.axis_x;\n\n    var limits = axis_x.getLimits(axis_x.which);\n    var ltr = Math.abs(limits.max) >= Math.abs(limits.min);\n    var hasNegativeValues = ltr ? limits.min < 0 : limits.max > 0;\n\n    var rightEdge = (this.width - margin.right - margin.left - barRectMargin - scrollMargin - (hasNegativeValues ? 0 : this._getWidestLabelWidth())) / (hasNegativeValues ? 2 : 1);\n\n    this.xScale.range([0, rightEdge]);\n\n    if (this.model.marker.axis_x.scaleType !== \"log\") {\n      this.xScale.domain([0, Math.max.apply(Math, _toConsumableArray(this.xScale.domain()))]);\n    }\n\n    var shift = hasNegativeValues ? rightEdge : this._getWidestLabelWidth();\n\n    var barWidth = function barWidth(value) {\n      return _this6.xScale(value);\n    };\n    var isLtrValue = function isLtrValue(value) {\n      return ltr ? value >= 0 : value > 0;\n    };\n\n    var labelAnchor = function labelAnchor(value) {\n      return isLtrValue(value) ? 'end' : 'start';\n    };\n    var valueAnchor = function valueAnchor(value) {\n      return isLtrValue(value) ? 'start' : 'end';\n    };\n\n    var labelX = function labelX(value) {\n      return isLtrValue(value) ? margin.left + shift : _this6.width - shift - scrollMargin - margin.right;\n    };\n\n    var barX = function barX(value) {\n      return isLtrValue(value) ? labelX(value) + barRectMargin : labelX(value) - barRectMargin;\n    };\n\n    var valueX = function valueX(value) {\n      return isLtrValue(value) ? barX(value) + barValueMargin : barX(value) - barValueMargin;\n    };\n\n    var isLabelBig = this._getWidestLabelWidth(true) + (ltr ? margin.left : margin.right) < shift;\n    this.sortedEntities.forEach(function (bar) {\n      var value = bar.value;\n\n\n      if (force || presentationModeChanged || bar.isNew || bar.changedValue) {\n        bar.barLabel.attr('x', labelX(value)).attr('y', _this6.activeProfile.barHeight / 2).attr('text-anchor', labelAnchor(value)).text(isLabelBig ? bar.label : bar.labelSmall);\n\n        bar.barRect.attr('rx', _this6.activeProfile.barHeight / 4).attr('ry', _this6.activeProfile.barHeight / 4).attr('height', _this6.activeProfile.barHeight);\n\n        bar.barValue.attr('x', valueX(value)).attr('y', _this6.activeProfile.barHeight / 2).attr('text-anchor', valueAnchor(value));\n      }\n\n      if (force || bar.changedWidth || presentationModeChanged) {\n        var width = Math.max(0, value && barWidth(Math.abs(value))) || 0;\n\n        if (force || bar.changedWidth || presentationModeChanged) {\n          bar.barRect.transition().duration(duration).ease(d3.easeLinear).attr('width', width);\n        }\n\n        bar.barRect.attr('x', barX(value) - (value < 0 ? width : 0));\n\n        if (force || bar.changedValue) {\n          bar.barValue.text(_this6._formatter(value) || _this6.translator('hints/nodata'));\n        }\n      }\n\n      if (force || bar.changedIndex || presentationModeChanged) {\n        !duration && bar.self.interrupt();\n        (duration ? bar.self.transition().duration(duration).ease(d3.easeLinear) : bar.self).attr('transform', \"translate(0, \" + _this6._getBarPosition(bar.index) + \")\");\n      }\n    });\n  },\n  _resizeSvg: function _resizeSvg() {\n    var _activeProfile3 = this.activeProfile,\n        barHeight = _activeProfile3.barHeight,\n        barMargin = _activeProfile3.barMargin;\n\n    this.barSvg.attr('height', (barHeight + barMargin) * this.sortedEntities.length + \"px\");\n  },\n  _scroll: function _scroll() {\n    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n    var follow = this.barContainer.select('.vzb-selected');\n    if (!follow.empty()) {\n      var d = follow.datum();\n      var yPos = this._getBarPosition(d.index);\n\n      var margin = this.activeProfile.margin;\n\n      var height = this.height - margin.top - margin.bottom;\n\n      var scrollTo = yPos - (height + this.activeProfile.barHeight) / 2;\n      this.barViewport.transition().duration(duration).tween('scrollfor' + d.entity, this._scrollTopTween(scrollTo));\n    }\n  },\n  _getLabelText: function _getLabelText(values, labelNames, d) {\n    return this.KEYS.map(function (key) {\n      return values[labelNames[key]] ? values[labelNames[key]][d[key]] : d[key];\n    }).join(\", \");\n  },\n  _createAndDeleteBars: function _createAndDeleteBars(updatedBars) {\n    var _this = this;\n    var KEYS = this.KEYS;\n    var dataKeys = this.dataKeys;\n\n    // TODO: revert this commit after fixing https://github.com/vizabi/vizabi/issues/2450\n\n    var _sortedEntities = _slicedToArray(this.sortedEntities, 1),\n        entity = _sortedEntities[0];\n\n    if (!this._entityLabels[entity.entity]) {\n      this._entityLabels[entity.entity] = entity.label;\n    }\n\n    var label = this._getLabelText(this.values, this.labelNames, entity.entity);\n    var localeChanged = this._entityLabels[entity.entity] !== label && this.model.locale.id !== this._localeId;\n\n    if (localeChanged) {\n      this._localeId = this.model.locale.id;\n      this._entityLabels[entity.entity] = label;\n    }\n\n    // remove groups for entities that are gone\n    updatedBars.exit().remove();\n\n    // make the groups for the entities which were not drawn yet (.data.enter() does this)\n    updatedBars = (localeChanged ? updatedBars : updatedBars.enter().append('g')).each(function (d) {\n      var self = d3.select(this);\n\n      var label = d.label;\n      var labelSmall = label.length < 12 ? label : label.substring(0, 9) + \"...\"; //…\n\n      var selectedLabel = self.select('.vzb-br-label');\n      var barLabel = selectedLabel.size() ? selectedLabel : self.append('text').attr('class', 'vzb-br-label').attr('dy', '.325em');\n\n      var labelWidth = barLabel.text(label).node().getBBox().width;\n      var labelSmallWidth = barLabel.text(labelSmall).node().getBBox().width;\n\n      Object.assign(d, {\n        labelWidth: labelWidth,\n        labelSmallWidth: labelSmallWidth,\n        labelSmall: labelSmall,\n        barLabel: barLabel\n      });\n\n      if (!localeChanged) {\n        self.attr('class', 'vzb-br-bar').classed('vzb-selected', _this.model.marker.isSelected(d.entity)).attr('id', \"vzb-br-bar-\" + utils.getKey(d.entity, KEYS) + \"-\" + _this._id).on('mousemove', function (d) {\n          return _this.model.marker.highlightMarker(d.entity);\n        }).on('mouseout', function () {\n          return _this.model.marker.clearHighlighted();\n        }).on('click', function (d) {\n          _this.model.marker.selectMarker(d.entity);\n        });\n\n        var barRect = self.append('rect').attr('stroke', 'transparent');\n\n        var barValue = self.append('text').attr('class', 'vzb-br-value').attr('dy', '.325em');\n\n        Object.assign(d, {\n          self: self,\n          isNew: true,\n          barRect: barRect,\n          barValue: barValue\n        });\n      }\n    }).merge(updatedBars);\n  },\n  _getWidestLabelWidth: function _getWidestLabelWidth() {\n    var big = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    var widthKey = big ? 'labelWidth' : 'labelSmallWidth';\n    var labelKey = big ? 'label' : 'labelSmall';\n\n    var bar = this.sortedEntities.reduce(function (a, b) {\n      return a[widthKey] < b[widthKey] ? b : a;\n    });\n\n    var text = bar.barLabel.text();\n    var width = bar.barLabel.text(bar[labelKey]).node().getBBox().width;\n    bar.barLabel.text(text);\n\n    return width;\n  },\n  _drawColors: function _drawColors() {\n    var _this7 = this;\n\n    var _this = this;\n    var dataKeys = this.dataKeys;\n\n    this.barContainer.selectAll('.vzb-br-bar>rect').each(function (_ref) {\n      var entity = _ref.entity;\n\n      var rect = d3.select(this);\n\n      var colorValue = _this.values.color[utils.getKey(entity, dataKeys.color)];\n      var isColorValid = colorValue || colorValue === 0;\n\n      var fillColor = isColorValid ? String(_this._getColor(colorValue)) : COLOR_WHITEISH;\n      var strokeColor = isColorValid ? 'transparent' : COLOR_BLACKISH;\n\n      rect.style('fill') !== fillColor && rect.style('fill', fillColor);\n      rect.style('stroke') !== strokeColor && rect.style('stroke', strokeColor);\n    });\n\n    this.barContainer.selectAll('.vzb-br-bar>text').style('fill', function (_ref2) {\n      var entity = _ref2.entity;\n      return _this7._getDarkerColor(_this7.values.color[utils.getKey(entity, dataKeys.color)] || null);\n    });\n  },\n  _getColor: function _getColor(value) {\n    return d3.rgb(this.cScale(value));\n  },\n  _getDarkerColor: function _getDarkerColor(d) {\n    return this._getColor(d).darker(2);\n  },\n\n\n  /**\n   * DATA HELPER FUNCTIONS\n   */\n\n  _scrollTopTween: function _scrollTopTween(scrollTop) {\n    return function () {\n      var node = this,\n          i = d3.interpolateNumber(this.scrollTop, scrollTop);\n      return function (t) {\n        node.scrollTop = i(t);\n      };\n    };\n  },\n  _getBarPosition: function _getBarPosition(i) {\n    return (this.activeProfile.barHeight + this.activeProfile.barMargin) * i;\n  },\n\n\n  _entities: {},\n\n  _sortByIndicator: function _sortByIndicator(values, dataKey) {\n    var _this8 = this;\n\n    var KEYS = this.KEYS;\n    var KEY = this.KEY;\n    var dataKeys = this.dataKeys;\n    return this.markerKeys.map(function (entity) {\n      var _this8$_entities$key;\n\n      var key = utils.getKey(entity, KEYS);\n      var cached = _this8._entities[key];\n      var value = values[utils.getKey(entity, dataKey)];\n      var label = _this8._getLabelText(_this8.values, _this8.labelNames, entity);\n      var formattedValue = _this8._formatter(value);\n\n      if (cached) {\n        return Object.assign(cached, {\n          value: value,\n          label: label,\n          formattedValue: formattedValue,\n          changedValue: formattedValue !== cached.formattedValue,\n          changedWidth: value !== cached.value,\n          isNew: false\n        });\n      }\n\n      return _this8._entities[key] = (_this8$_entities$key = {\n        entity: entity,\n        value: value,\n        label: label,\n        formattedValue: formattedValue\n      }, _defineProperty(_this8$_entities$key, _this8.KEY, key), _defineProperty(_this8$_entities$key, \"changedValue\", true), _defineProperty(_this8$_entities$key, \"changedWidth\", true), _defineProperty(_this8$_entities$key, \"isNew\", true), _this8$_entities$key);\n    }).sort(function (_ref3, _ref4) {\n      var a = _ref3.value;\n      var b = _ref4.value;\n      return b - a;\n    }).map(function (entity, index) {\n      return Object.assign(entity, {\n        index: index,\n        changedIndex: index !== entity.index\n      });\n    });\n  },\n  _selectBars: function _selectBars() {\n    var _this9 = this;\n\n    var KEYS = this.KEYS;\n    var selected = this.model.marker.select;\n\n    // unselect all bars\n    this.barContainer.classed('vzb-dimmed-selected', false);\n    this.barContainer.selectAll('.vzb-br-bar.vzb-selected').classed('vzb-selected', false);\n\n    // select the selected ones\n    if (selected.length) {\n      this.barContainer.classed('vzb-dimmed-selected', true);\n      selected.forEach(function (selectedBar) {\n        _this9.barContainer.select(\"#vzb-br-bar-\" + (0, _css2.default)(utils.getKey(selectedBar, KEYS)) + \"-\" + _this9._id).classed('vzb-selected', true);\n      });\n    }\n  },\n  _updateOpacity: function _updateOpacity() {\n    var marker = this.model.marker;\n\n\n    var OPACITY_HIGHLIGHT_DEFAULT = 1;\n    var highlight = marker.highlight,\n        select = marker.select,\n        OPACITY_HIGHLIGHT_DIM = marker.opacityHighlightDim,\n        OPACITY_SELECT_DIM = marker.opacitySelectDim,\n        OPACITY_REGULAR = marker.opacityRegular;\n    var someHighlighted = highlight.length > 0,\n        someSelected = select.length > 0;\n\n\n    this.barContainer.selectAll('.vzb-br-bar').style('opacity', function (d) {\n      if (someHighlighted && marker.isHighlighted(d.entity)) {\n        return OPACITY_HIGHLIGHT_DEFAULT;\n      }\n\n      if (someSelected) {\n        return marker.isSelected(d.entity) ? OPACITY_REGULAR : OPACITY_SELECT_DIM;\n      }\n\n      if (someHighlighted) {\n        return OPACITY_HIGHLIGHT_DIM;\n      }\n\n      return OPACITY_REGULAR;\n    });\n  },\n  _updateDoubtOpacity: function _updateDoubtOpacity(opacity) {\n    this.dataWarningEl.style('opacity', opacity || (!this.model.marker.select.length ? this.wScale(+this.model.time.value.getUTCFullYear().toString()) : 1));\n  }\n}, \"_getLabelText\", function _getLabelText(values, labelNames, d) {\n  return this.KEYS.map(function (key) {\n    return values[labelNames[key]] ? values[labelNames[key]][d[key]] : d[key];\n  }).join(\", \");\n}));\n\nexports.default = BarRankChart;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (true) {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, […]\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), […]\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, […]\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(5)))\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<!-- Bar Chart Component -->\\n<div class=\\\"vzb-barrankchart\\\">\\n  <svg class=\\\"vzb-br-header\\\">\\n    <g class=\\\"vzb-br-title\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-total\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-axis-info vzb-noexport\\\"></g>\\n  </svg>\\n\\n  <div class=\\\"vzb-br-barsviewport vzb-dialog-scrollable\\\">\\n    <svg class=\\\"vzb-br-bars-svg\\\">\\n      <g class=\\\"vzb-br-bars\\\"></g>\\n    </svg>\\n  </div>\\n\\n  <svg class=\\\"vzb-data-warning-svg\\\">\\n    <g class=\\\"vzb-data-warning vzb-noexport\\\">\\n      <svg></svg>\\n      <text></text>\\n    </g>\\n  </svg>\\n</div>\\n\";\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(0);\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// barrankchart.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4e607fc562d3a3fc6c04","import \"./styles.scss\";\nimport component from \"./component\";\n\nconst VERSION_INFO = { version: __VERSION, build: __BUILD };\n\nexport default Vizabi.Tool.extend(\"BarRankChart\", {\n\n  // Run when the tool is created\n  init: function (placeholder, externalModel) {\n\n    this.name = \"barrankchart\";\n\n    this.components = [{\n      component: component,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.marker\", \"locale\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.marker_tags\", \"state.time\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datawarning\"),\n      placeholder: \".vzb-tool-datawarning\",\n      model: [\"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    // constructor is the same as any tool\n    this._super(placeholder, externalModel);\n  },\n\n  /**\n   * Determines the default model of this tool\n   */\n  default_model: {\n    \"state\": {\n      \"time\": {\n        \"autoconfig\": {\n          \"type\": \"time\"\n        }\n      },\n      \"entities\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"entities_colorlegend\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      entities_tags: {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"includeOnlyIDs\": [\"tag\"]\n        }\n      },\n      marker_tags: {\n        space: [\"entities_tags\"],\n        label: {\n          use: \"property\",\n          which: \"name\"\n        },\n        hook_parent: {}\n      },\n      \"entities_allpossible\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"marker_allpossible\": {\n        \"space\": [\"entities_allpossible\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"marker\": {\n        \"space\": [\"entities\", \"time\"],\n        \"axis_x\": {\n          \"use\": \"indicator\",\n          \"autoconfig\": {\n            \"type\": \"measure\"\n          },\n          \"allow\": { scales: [\"linear\", \"log\"] }\n        },\n        // \"axis_y\": {\n        //   \"use\": \"property\",\n        //   \"allow\": { scales: [\"ordinal\", \"nominal\"] },\n        //   \"autoconfig\": {\n        //     \"type\": \"entity_domain\"\n        //   }\n        // },\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        },\n        \"color\": {\n          \"syncModels\": [\"marker_colorlegend\"],\n          \"autoconfig\": {}\n        }\n      },\n      \"marker_colorlegend\": {\n        \"space\": [\"entities_colorlegend\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"which\": \"name\"\n        },\n        \"hook_rank\": {\n          \"use\": \"property\",\n          \"which\": \"rank\"\n        },\n        \"hook_geoshape\": {\n          \"use\": \"property\",\n          \"which\": \"shape_lores_svg\"\n        }\n      }\n    },\n    locale: {},\n    ui: {\n      chart: {},\n      datawarning: {\n        doubtDomain: [],\n        doubtRange: []\n      },\n      \"buttons\": [\"colors\", \"find\", \"show\", \"moreoptions\", \"fullscreen\", \"presentation\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"find\", \"show\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"find\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"colors\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import cssEscape from \"css.escape\";\nconst utils = Vizabi.utils;\n\nconst axisWithLabelPicker = Vizabi.helpers['d3.axisWithLabelPicker'];\nconst iconQuestion = Vizabi.iconset.question;\nconst iconWarn = Vizabi.iconset.warn;\n\nconst COLOR_BLACKISH = \"rgb(51, 51, 51)\";\nconst COLOR_WHITEISH = \"rgb(253, 253, 253)\";\n\nconst BarRankChart = Vizabi.Component.extend(\"barrankchart\", {\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init(config, context) {\n\n    this.name = 'barrankchart';\n    this.template = require('./template.html');\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    this.model_binds = {\n      'change:time.value': () => {\n        // TODO: review this after vizabi#2450 will be fixed\n        if (!this.model._ready) return;\n\n        if (this._readyOnce) {\n          this.onTimeChange();\n        }\n      },\n      'change:marker.select': () => {\n        if (this._readyOnce) {\n          this._selectBars();\n          this._updateOpacity();\n          this._updateDoubtOpacity();\n          this._scroll();\n        }\n      },\n      'change:marker.axis_x.scaleType': () => {\n        if (this._readyOnce) {\n          if (this.loadData()) {\n            this.draw(true);\n          }\n        }\n      },\n      'change:marker.color.palette': () => {\n        this._drawColors();\n      },\n      'change:marker.highlight': () => {\n        this._updateOpacity();\n      },\n      'change:marker.opacitySelectDim': () => {\n        this._updateOpacity();\n      },\n      'change:marker.opacityRegular': () => {\n        this._updateOpacity();\n      },\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    // set up the scales\n    this.xScale = null;\n    this.cScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n    // set up the axes\n    this.xAxis = axisWithLabelPicker(\"bottom\");\n  },\n\n  onTimeChange() {\n    this.model.marker.getFrame(this.model.time.value, values => {\n      this.values = values;\n\n      if (this.values) {\n        if (this.loadData()) {\n          this.draw();\n        }\n      }\n    });\n  },\n\n  /**\n   * DOM and model are ready\n   */\n  readyOnce() {\n    this.element = d3.select(this.element);\n\n    // reference elements\n    //this.graph = this.element.select('.vzb-br-graph');\n    //this.yearEl = this.element.select('.vzb-br-year');\n    //this.year = new DynamicBackground(this.yearEl);\n    this.header = this.element.select('.vzb-br-header');\n    this.infoEl = this.element.select('.vzb-br-axis-info');\n    this.barViewport = this.element.select('.vzb-br-barsviewport');\n    this.barSvg = this.element.select('.vzb-br-bars-svg');\n    this.barContainer = this.element.select('.vzb-br-bars');\n    this.dataWarningEl = this.element.select('.vzb-data-warning');\n    this.wScale = d3.scaleLinear()\n      .domain(this.model.ui.datawarning.doubtDomain)\n      .range(this.model.ui.datawarning.doubtRange);\n\n    // set up formatters\n    this.xAxis.tickFormat(this.model.marker.axis_x.getTickFormatter());\n\n    this._localeId = this.model.locale.id;\n    this._entityLabels = {};\n    this._presentation = !this.model.ui.presentation;\n    this._formatter = this.model.marker.axis_x.getTickFormatter();\n\n    this.ready();\n\n    this._selectBars();\n\n  },\n\n  /**\n   * Both model and DOM are ready\n   */\n  ready() {\n    this.TIMEDIM = this.model.time.getDimension();\n    this.KEYS = utils.unique(this.model.marker._getAllDimensions({ exceptType: \"time\" }));\n    this.KEY = this.KEYS.join(\",\");\n    this.dataKeys = this.model.marker.getDataKeysPerHook();\n    this.labelNames = this.model.marker.getLabelHookNames();\n\n    this.model.marker.getFrame(this.model.time.value, values => {\n      this.values = values;\n\n      if (this.values) {\n        this.markerKeys = this.model.marker.getKeys();\n        if (this.loadData()) {\n          this.draw(true);\n          this._updateOpacity();\n          this._drawColors();\n        }\n      }\n    });\n  },\n\n  resize() {\n    this.draw(true);\n    this._drawColors();\n  },\n\n  loadData() {\n    const _this = this;\n\n    this.translator = this.model.locale.getTFunction();\n    // sort the data (also sets this.total)\n    const xAxisValues = this.values.axis_x;\n    if (!Object.keys(xAxisValues).length) return false;\n\n    this.sortedEntities = this._sortByIndicator(xAxisValues, this.dataKeys.axis_x);\n\n    this.header\n      .select('.vzb-br-title')\n      .select('text')\n      .on('click', () =>\n        this.parent\n          .findChildByName('gapminder-treemenu')\n          .markerID('axis_x')\n          .alignX('left')\n          .alignY('top')\n          .updateView()\n          .toggle()\n      );\n\n    // new scales and axes\n    this.xScale = this.model.marker.axis_x.getScale().copy();\n    this.cScale = this.model.marker.color.getScale();\n\n    utils.setIcon(this.dataWarningEl, iconWarn)\n      .select('svg')\n      .attr('width', 0).attr('height', 0);\n\n    this.dataWarningEl.append('text')\n      .text(this.translator('hints/dataWarning'));\n\n    this.dataWarningEl\n      .on('click', () => this.parent.findChildByName('gapminder-datawarning').toggle())\n      .on('mouseover', () => this._updateDoubtOpacity(1))\n      .on('mouseout', () => this._updateDoubtOpacity());\n\n    const conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.infoEl, iconQuestion)\n      .select('svg').attr('width', 0).attr('height', 0)\n      .style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.infoEl.on('click', () => {\n      this.parent.findChildByName('gapminder-datanotes').pin();\n    });\n\n    this.infoEl.on('mouseover', function() {\n      const rect = this.getBBox();\n      const ctx = utils.makeAbsoluteContext(this, this.farthestViewportElement);\n      const coord = ctx(rect.x - 10, rect.y + rect.height + 10);\n      _this.parent.findChildByName('gapminder-datanotes')\n        .setHook('axis_x')\n        .show()\n        .setPos(coord.x, coord.y);\n    });\n\n    this.infoEl.on('mouseout', () => {\n      _this.parent.findChildByName('gapminder-datanotes').hide();\n    });\n\n    return true;\n  },\n\n  draw(force = false) {\n    this.time_1 = this.time == null ? this.model.time.value : this.time;\n    this.time = this.model.time.value;\n    //smooth animation is needed when playing, except for the case when time jumps from end to start\n    const duration = this.model.time.playing && (this.time - this.time_1 > 0) ? this.model.time.delayAnimations : 0;\n\n    //return if drawAxes exists with error\n    if (this.drawAxes(duration, force)) return;\n    this.drawData(duration, force);\n  },\n\n  /*\n   * draw the chart/stage\n   */\n  drawAxes(duration = 0) {\n    const profiles = {\n      small: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 18,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 20,\n      },\n      medium: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 21,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25,\n      },\n      large: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 28,\n        barMargin: 4,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25,\n      }\n    };\n\n    const presentationProfileChanges = {\n      medium: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 25,\n        infoElMargin: 10,\n        barHeight: 25,\n        barMargin: 6\n      },\n      large: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 10,\n        barHeight: 30,\n        barMargin: 6\n      }\n    };\n\n    this.activeProfile = this.getActiveProfile(profiles, presentationProfileChanges);\n\n    const {\n      margin,\n      headerMargin,\n      infoElHeight,\n      infoElMargin,\n    } = this.activeProfile;\n\n    this.height = parseInt(this.element.style('height'), 10) || 0;\n    this.width = parseInt(this.element.style('width'), 10) || 0;\n\n    if (!this.height || !this.width) return utils.warn('Dialog resize() abort: vizabi container is too little or has display:none');\n\n    this.barViewport\n      .style('height', `${this.height - margin.bottom - margin.top}px`);\n\n    // header\n    this.header.attr('height', margin.top);\n    const headerTitle = this.header.select('.vzb-br-title');\n\n    // change header titles for new data\n    const { name, unit } = this.model.marker.axis_x.getConceptprops();\n\n    const headerTitleText = headerTitle\n      .select('text');\n\n    if (unit) {\n      headerTitleText.text(`${name}, ${unit}`);\n\n      const rightEdgeOfLeftText = headerMargin.left\n        + headerTitle.node().getBBox().width\n        + infoElMargin\n        + infoElHeight;\n\n      if (rightEdgeOfLeftText > this.width - headerMargin.right) {\n        headerTitleText.text(name);\n      }\n    } else {\n      headerTitleText.text(name);\n    }\n\n    const headerTitleBBox = headerTitle.node().getBBox();\n\n    const titleTx = headerMargin.left;\n    const titleTy = headerMargin.top + headerTitleBBox.height;\n    headerTitle\n      .attr('transform', `translate(${titleTx}, ${titleTy})`);\n\n    const headerInfo = this.infoEl;\n\n    headerInfo.select('svg')\n      .attr('width', `${infoElHeight}px`)\n      .attr('height', `${infoElHeight}px`);\n\n    const infoTx = titleTx + headerTitle.node().getBBox().width + infoElMargin;\n    const infoTy = headerMargin.top + infoElHeight / 4;\n    headerInfo.attr('transform', `translate(${infoTx}, ${infoTy})`);\n\n\n    const headerTotal = this.header.select('.vzb-br-total');\n\n    if (duration) {\n      headerTotal.select('text')\n        .transition('text')\n        .delay(duration)\n        .text(this.model.time.formatDate(this.time));\n    } else {\n      headerTotal.select('text')\n        .interrupt()\n        .text(this.model.time.formatDate(this.time));\n    }\n    headerTotal.style('opacity', Number(this.getLayoutProfile() !== 'large'));\n\n    const headerTotalBBox = headerTotal.node().getBBox();\n\n    const totalTx = this.width - headerMargin.right - headerTotalBBox.width;\n    const totalTy = headerMargin.top + headerTotalBBox.height;\n    headerTotal\n      .attr('transform', `translate(${totalTx}, ${totalTy})`)\n      .classed('vzb-transparent', headerTitleBBox.width + headerTotalBBox.width + 10 > this.width);\n\n    this.element.select('.vzb-data-warning-svg')\n      .style('height', `${margin.bottom}px`);\n\n\n    const warningBBox = this.dataWarningEl.select('text').node().getBBox();\n    this.dataWarningEl\n      .attr('transform', `translate(${this.width - margin.right - warningBBox.width}, ${warningBBox.height})`)\n      .select('text');\n\n    this.dataWarningEl\n      .select('svg')\n      .attr('width', warningBBox.height)\n      .attr('height', warningBBox.height)\n      .attr('x', -warningBBox.height - 5)\n      .attr('y', -warningBBox.height + 1);\n\n    this._updateDoubtOpacity();\n  },\n\n  drawData(duration = 0, force = false) {\n    const KEY = this.KEY;\n    // update the shown bars for new data-set\n    this._createAndDeleteBars(\n      this.barContainer.selectAll('.vzb-br-bar')\n        .data(this.sortedEntities, d => d[KEY])\n    );\n\n\n    const { presentation } = this.model.ui;\n    const presentationModeChanged = this._presentation !== presentation;\n\n    if (presentationModeChanged) {\n      this._presentation = presentation;\n    }\n\n\n    const entitiesCountChanged = typeof this._entitiesCount === 'undefined'\n      || this._entitiesCount !== this.sortedEntities.length;\n\n    if (presentationModeChanged || entitiesCountChanged) {\n      if (entitiesCountChanged) {\n        this._entitiesCount = this.sortedEntities.length;\n      }\n    }\n\n    this._resizeSvg();\n    this._scroll(duration);\n    this._drawColors();\n\n\n    const { barRectMargin, barValueMargin, scrollMargin, margin } = this.activeProfile;\n    const { axis_x } = this.model.marker;\n    const limits = axis_x.getLimits(axis_x.which);\n    const ltr = Math.abs(limits.max) >= Math.abs(limits.min);\n    const hasNegativeValues = ltr ? limits.min < 0 : limits.max > 0;\n\n\n    const rightEdge = (\n        this.width\n        - margin.right\n        - margin.left\n        - barRectMargin\n        - scrollMargin\n        - (hasNegativeValues ? 0 : this._getWidestLabelWidth())\n      ) / (hasNegativeValues ? 2 : 1);\n\n    this.xScale\n      .range([0, rightEdge]);\n    \n    if (this.model.marker.axis_x.scaleType !== \"log\") {\n      this.xScale\n        .domain([0, Math.max(...this.xScale.domain())]);\n    }\n\n    const shift = hasNegativeValues ? rightEdge : this._getWidestLabelWidth();\n\n    const barWidth = (value) => this.xScale(value);\n    const isLtrValue = value => ltr ? value >= 0 : value > 0;\n\n    const labelAnchor = value => isLtrValue(value) ? 'end' : 'start';\n    const valueAnchor = value => isLtrValue(value) ? 'start' : 'end';\n\n    const labelX = value => isLtrValue(value) ?\n      (margin.left + shift) :\n      (this.width - shift - scrollMargin - margin.right);\n\n    const barX = value => isLtrValue(value) ?\n      (labelX(value) + barRectMargin) :\n      (labelX(value) - barRectMargin);\n\n    const valueX = value => isLtrValue(value) ?\n      (barX(value) + barValueMargin) :\n      (barX(value) - barValueMargin);\n\n    const isLabelBig = (this._getWidestLabelWidth(true) + (ltr ? margin.left : margin.right)) < shift;\n    this.sortedEntities.forEach((bar) => {\n      const { value } = bar;\n\n      if (force || presentationModeChanged || bar.isNew || bar.changedValue) {\n        bar.barLabel\n          .attr('x', labelX(value))\n          .attr('y', this.activeProfile.barHeight / 2)\n          .attr('text-anchor', labelAnchor(value))\n          .text(isLabelBig ? bar.label : bar.labelSmall);\n\n        bar.barRect\n          .attr('rx', this.activeProfile.barHeight / 4)\n          .attr('ry', this.activeProfile.barHeight / 4)\n          .attr('height', this.activeProfile.barHeight);\n\n        bar.barValue\n          .attr('x', valueX(value))\n          .attr('y', this.activeProfile.barHeight / 2)\n          .attr('text-anchor', valueAnchor(value));\n      }\n\n      if (force || bar.changedWidth || presentationModeChanged) {\n        const width = Math.max(0, value && barWidth(Math.abs(value))) || 0;\n\n        if (force || bar.changedWidth || presentationModeChanged) {\n          bar.barRect\n            .transition().duration(duration).ease(d3.easeLinear)\n            .attr('width', width)\n        }\n\n        bar.barRect\n          .attr('x', barX(value) - (value < 0 ? width : 0));\n\n        if (force || bar.changedValue) {\n          bar.barValue\n            .text(this._formatter(value) || this.translator('hints/nodata'));\n        }\n      }\n\n      if (force || bar.changedIndex || presentationModeChanged) {\n        !duration && bar.self.interrupt();\n        (duration ? bar.self.transition().duration(duration).ease(d3.easeLinear) : bar.self)\n          .attr('transform', `translate(0, ${this._getBarPosition(bar.index)})`);\n      }\n    });\n  },\n\n  _resizeSvg() {\n    const { barHeight, barMargin } = this.activeProfile;\n    this.barSvg.attr('height', `${(barHeight + barMargin) * this.sortedEntities.length}px`);\n  },\n\n  _scroll(duration = 0) {\n    const follow = this.barContainer.select('.vzb-selected');\n    if (!follow.empty()) {\n      const d = follow.datum();\n      const yPos = this._getBarPosition(d.index);\n\n      const { margin } = this.activeProfile;\n      const height = this.height - margin.top - margin.bottom;\n\n      const scrollTo = yPos - (height + this.activeProfile.barHeight) / 2;\n      this.barViewport.transition().duration(duration)\n        .tween('scrollfor' + d.entity, this._scrollTopTween(scrollTo));\n    }\n  },\n\n  _getLabelText(values, labelNames, d) {\n    return this.KEYS.map(key => values[labelNames[key]] ? values[labelNames[key]][d[key]] : d[key]).join(\", \");\n  },\n\n  _createAndDeleteBars(updatedBars) {\n    const _this = this;\n    const KEYS = this.KEYS;\n    const dataKeys = this.dataKeys;\n\n    // TODO: revert this commit after fixing https://github.com/vizabi/vizabi/issues/2450\n    const [entity] = this.sortedEntities;\n    if (!this._entityLabels[entity.entity]) {\n      this._entityLabels[entity.entity] = entity.label;\n    }\n\n    const label = this._getLabelText(this.values, this.labelNames, entity.entity)\n    const localeChanged = this._entityLabels[entity.entity] !== label\n      && this.model.locale.id !== this._localeId;\n\n    if (localeChanged) {\n      this._localeId = this.model.locale.id;\n      this._entityLabels[entity.entity] = label;\n    }\n\n    // remove groups for entities that are gone\n    updatedBars.exit().remove();\n\n    // make the groups for the entities which were not drawn yet (.data.enter() does this)\n    updatedBars = (localeChanged ? updatedBars : updatedBars.enter().append('g'))\n      .each(function(d) {\n        const self = d3.select(this);\n\n        const label = d.label;\n        const labelSmall = label.length < 12 ? label : `${label.substring(0, 9)}...`;//…\n\n        const selectedLabel = self.select('.vzb-br-label');\n        const barLabel = selectedLabel.size() ?\n          selectedLabel :\n          self.append('text')\n            .attr('class', 'vzb-br-label')\n            .attr('dy', '.325em');\n\n        const labelWidth = barLabel.text(label).node().getBBox().width;\n        const labelSmallWidth = barLabel.text(labelSmall).node().getBBox().width;\n\n        Object.assign(d, {\n          labelWidth,\n          labelSmallWidth,\n          labelSmall,\n          barLabel,\n        });\n\n        if (!localeChanged) {\n          self\n            .attr('class', 'vzb-br-bar')\n            .classed('vzb-selected', _this.model.marker.isSelected(d.entity))\n            .attr('id', `vzb-br-bar-${utils.getKey(d.entity, KEYS)}-${_this._id}`)\n            .on('mousemove', d => _this.model.marker.highlightMarker(d.entity))\n            .on('mouseout', () => _this.model.marker.clearHighlighted())\n            .on('click', d => {\n              _this.model.marker.selectMarker(d.entity);\n            });\n\n          const barRect = self.append('rect')\n            .attr('stroke', 'transparent');\n\n          const barValue = self.append('text')\n            .attr('class', 'vzb-br-value')\n            .attr('dy', '.325em');\n\n          Object.assign(d, {\n            self,\n            isNew: true,\n            barRect,\n            barValue,\n          });\n        }\n      })\n      .merge(updatedBars);\n  },\n\n  _getWidestLabelWidth(big = false) {\n    const widthKey = big ? 'labelWidth' : 'labelSmallWidth';\n    const labelKey = big ? 'label' : 'labelSmall';\n\n    const bar = this.sortedEntities\n      .reduce((a, b) => a[widthKey] < b[widthKey] ? b : a);\n\n    const text = bar.barLabel.text();\n    const width = bar.barLabel.text(bar[labelKey]).node().getBBox().width;\n    bar.barLabel.text(text);\n\n    return width;\n  },\n\n  _drawColors() {\n    const _this = this;\n    const dataKeys = this.dataKeys;\n\n    this.barContainer.selectAll('.vzb-br-bar>rect')\n      .each(function({ entity }) {\n        const rect = d3.select(this);\n\n        const colorValue = _this.values.color[utils.getKey(entity, dataKeys.color)];\n        const isColorValid = colorValue || colorValue === 0;\n\n        const fillColor = isColorValid ? String(_this._getColor(colorValue)) : COLOR_WHITEISH;\n        const strokeColor = isColorValid ? 'transparent' : COLOR_BLACKISH;\n\n        rect.style('fill') !== fillColor && rect.style('fill', fillColor);\n        rect.style('stroke') !== strokeColor && rect.style('stroke', strokeColor);\n      });\n\n    this.barContainer.selectAll('.vzb-br-bar>text')\n      .style('fill', ({ entity }) => this._getDarkerColor(this.values.color[utils.getKey(entity, dataKeys.color)] || null));\n  },\n\n  _getColor(value) {\n    return d3.rgb(this.cScale(value));\n  },\n\n  _getDarkerColor(d) {\n    return this._getColor(d).darker(2);\n  },\n\n\n  /**\n   * DATA HELPER FUNCTIONS\n   */\n\n  _scrollTopTween(scrollTop) {\n    return function() {\n      const node = this, i = d3.interpolateNumber(this.scrollTop, scrollTop);\n      return function(t) {\n        node.scrollTop = i(t);\n      };\n    };\n  },\n\n  _getBarPosition(i) {\n    return (this.activeProfile.barHeight + this.activeProfile.barMargin) * i;\n  },\n\n  _entities: {},\n\n  _sortByIndicator(values, dataKey) {\n    const KEYS = this.KEYS;\n    const KEY = this.KEY;\n    const dataKeys = this.dataKeys;\n    return this.markerKeys.map(entity => {\n      const key = utils.getKey(entity, KEYS);\n      const cached = this._entities[key];\n      const value = values[utils.getKey(entity, dataKey)];\n      const label = this._getLabelText(this.values, this.labelNames, entity);\n      const formattedValue = this._formatter(value);\n\n      if (cached) {\n        return Object.assign(cached, {\n          value,\n          label,\n          formattedValue,\n          changedValue: formattedValue !== cached.formattedValue,\n          changedWidth: value !== cached.value,\n          isNew: false\n        });\n      }\n\n      return this._entities[key] = {\n        entity,\n        value,\n        label,\n        formattedValue,\n        [this.KEY]: key,\n        changedValue: true,\n        changedWidth: true,\n        isNew: true\n      };\n    }).sort(({ value: a }, { value: b }) => b - a)\n      .map((entity, index) =>\n        Object.assign(entity, {\n          index,\n          changedIndex: index !== entity.index\n        }));\n  },\n\n  _selectBars() {\n    const KEYS = this.KEYS;\n    const selected = this.model.marker.select;\n\n    // unselect all bars\n    this.barContainer.classed('vzb-dimmed-selected', false);\n    this.barContainer.selectAll('.vzb-br-bar.vzb-selected').classed('vzb-selected', false);\n\n    // select the selected ones\n    if (selected.length) {\n      this.barContainer.classed('vzb-dimmed-selected', true);\n      selected.forEach(selectedBar => {\n        this.barContainer\n          .select(`#vzb-br-bar-${cssEscape(utils.getKey(selectedBar, KEYS))}-${this._id}`)\n          .classed('vzb-selected', true);\n      });\n    }\n\n  },\n\n  _updateOpacity() {\n    const { model: { marker } } = this;\n\n    const OPACITY_HIGHLIGHT_DEFAULT = 1;\n    const {\n      highlight,\n      select,\n\n      opacityHighlightDim: OPACITY_HIGHLIGHT_DIM,\n      opacitySelectDim: OPACITY_SELECT_DIM,\n      opacityRegular: OPACITY_REGULAR,\n    } = marker;\n\n    const [\n      someHighlighted,\n      someSelected\n    ] = [\n      highlight.length > 0,\n      select.length > 0\n    ];\n\n    this.barContainer.selectAll('.vzb-br-bar')\n      .style('opacity', d => {\n        if (someHighlighted && marker.isHighlighted(d.entity)) {\n          return OPACITY_HIGHLIGHT_DEFAULT;\n        }\n\n        if (someSelected) {\n          return marker.isSelected(d.entity) ? OPACITY_REGULAR : OPACITY_SELECT_DIM;\n        }\n\n        if (someHighlighted) {\n          return OPACITY_HIGHLIGHT_DIM;\n        }\n\n        return OPACITY_REGULAR;\n      });\n  },\n\n  _updateDoubtOpacity(opacity) {\n    this.dataWarningEl.style('opacity',\n      opacity || (\n        !this.model.marker.select.length ?\n          this.wScale(+this.model.time.value.getUTCFullYear().toString()) :\n          1\n      )\n    );\n  },\n\n  _getLabelText(values, labelNames, d) {\n    return this.KEYS.map(key => values[labelNames[key]] ? values[labelNames[key]][d[key]] : d[key]).join(\", \");    \n  }\n\n});\n\nexport default BarRankChart;\n\n\n\n// WEBPACK FOOTER //\n// ./src/component.js","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, […]\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), […]\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, […]\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css.escape/css.escape.js\n// module id = 2\n// module chunks = 0 1","module.exports = \"<!-- Bar Chart Component -->\\n<div class=\\\"vzb-barrankchart\\\">\\n  <svg class=\\\"vzb-br-header\\\">\\n    <g class=\\\"vzb-br-title\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-total\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-axis-info vzb-noexport\\\"></g>\\n  </svg>\\n\\n  <div class=\\\"vzb-br-barsviewport vzb-dialog-scrollable\\\">\\n    <svg class=\\\"vzb-br-bars-svg\\\">\\n      <g class=\\\"vzb-br-bars\\\"></g>\\n    </svg>\\n  </div>\\n\\n  <svg class=\\\"vzb-data-warning-svg\\\">\\n    <g class=\\\"vzb-data-warning vzb-noexport\\\">\\n      <svg></svg>\\n      <text></text>\\n    </g>\\n  </svg>\\n</div>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/template.html\n// module id = 4\n// module chunks = 0 1","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 5\n// module chunks = 0 1"],"sourceRoot":""}