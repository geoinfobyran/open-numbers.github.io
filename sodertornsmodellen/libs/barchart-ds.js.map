{"version":3,"sources":["webpack:///webpack/bootstrap f58c412da383836e7a47","webpack:///./src/index.js","webpack:///./src/component.js","webpack:///./src/styles.scss?ccec","webpack:///./src/template.html"],"names":["VERSION_INFO","version","build","BarChartDS","Vizabi","Tool","extend","init","placeholder","external_model","name","components","component","model","Component","get","_super","validate","entities","state","Object","keys","show","length","dim","entities_geodomain","skipFilter","entities_side","default_model","marker_tags","ui","chart","stacked","inpercent","flipSides","presentation","locale","versionInfo","utils","axisSmart","helpers","iconQuestion","iconset","question","config","context","template","require","model_expects","type","_this","model_binds","evt","_readyOnce","time","step","snapped","playing","dragging","next","d3","bisectLeft","timeSteps","value","prev","snapTime","Date","marker","getFrame","frame","frameAxisX","axis_x","marker_order","frameOrder","hook_order","_reorderBars","_updateEntities","updateBarsOpacity","path","indexOf","ready","someSelected","select","nonSelectedOpacityZero","_highlightBars","which","color","sideDim","entitiesSideProps","side","use","sideConcept","getConceptprops","concept_type","domain","clearSideState","skipFilterSide","geoDomainDimension","set","STACKDIM","Boolean","getFilteredEntities","isEmpty","showEntities","filter","isShown","s","showEntity","SIDEDIM","doReturn","_entitiesSameDimWithSide","forEach","_space","h","_name","_updateIndicators","_updateLimits","resize","switchSideState","xScale","yScale","cScale","xAxis","xAxisLeft","yAxis","xScales","totalFieldName","checkDimensions","stackDim","colorUseNotProperty","TIME","stackSkip","geoLess","sideSkip","readyOnce","el","element","interaction","_interaction","graph","yAxisEl","xAxisEl","xAxisLeftEl","xTitleEl","xInfoEl","yTitleEl","barsCrop","labelsCrop","bars","labels","attr","title","titleRight","year","getDimension","geoDomainDefaultValue","on","_attributeUpdaters","_newWidth","d","i","width","getKey","KEYS","total","PREFIXEDSIDEDIM","width_","_newX","prevSbl","previousSibling","prevSblDatum","datum","x_","_newColor","COLORKEYS","_ready","getAllSteps","_getFirstDimension","unique","_getAllDimensions","exceptType","label_side","getEntity","stack","axis_y","PREFIXEDSTACKDIM","TIMEDIM","updateUIStrings","items","getKeys","_createLimits","markers","translator","getTFunction","xTitle","selectAll","data","enter","append","parent","findChildByName","markerID","alignX","isRTL","alignY","updateView","toggle","conceptPropsX","setIcon","style","Number","description","sourceLink","pin","rect","getBBox","coord","makeAbsoluteContext","farthestViewportElement","x","y","height","toolRect","root","getBoundingClientRect","chartRect","node","setHook","setPos","left","hide","duration","delayAnimations","getScale","tickFormat","getTickFormatter","stacks","stackKeys","map","m","sideItems","getItems","sideKeys","sideFiltered","sides","f","sortFunc","ascending","descending","sort","push","twoSided","classed","xScaleLeft","copy","text","a","b","result","axisX","sideKeysNF","getNestedItems","limits","getLimitsByDimensions","concat","timeKeys","getUnique","totals","inpercentMaxLimits","maxLimits","key","stackSum","sideMaxLimits","val","max","maxSideLimit","Math","zero","scaleType","domainMin","domainMax","_interpolateBetweenTotals","nextStep","fraction","reorder","prefixedSideDim","prefixedStackDim","timeDim","stackBars","slice","entityBars","exit","remove","barHeight","firstBarOffsetY","merge","sideBars","r","call","sideSel","highlighted","mouseover","mouseout","click","onTap","tap","activeProfile","centerWidth","transition","ease","easeLinear","interrupt","_setYear","formatDate","timeValue","formattedTime","isTouchDevice","highlightMarker","clearHighlighted","selectMarker","event","stopPropagation","someHighlighted","highlight","_showLabel","formatter","format","label","bar","label_stack","stackItems","presentationProfileChanges","medium","margin","right","bottom","infoElHeight","large","top","profiles","titlesSpacing","getActiveProfile","parseInt","warn","abs","range","maxRange","scale","tickValues","tickSizeInner","tickSizeOuter","tickPadding","tickSizeMinor","labelerOptions","toolMargin","limitMaxTickNumber","translateX","rangePoints","zeroTickEl","empty","zeroTickWidth","tickNodes","nodes","titleBBox","t","transform","hTranslate","translateY","OPACITY_HIGHLT","OPACITY_HIGHLT_DIM","opacityHighlightDim","OPACITY_SELECT","OPACITY_REGULAR","opacityRegular","OPACITY_SELECT_DIM","opacitySelectDim","isHighlighted","isSelected"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;AChEA;;AACA;;;;;;AAEA,IAAMA,eAAe,EAAEC,SAAS,OAAX,EAAsBC,OAAO,aAA7B,EAArB;;AAEA;AACA,IAAMC,aAAaC,OAAOC,IAAP,CAAYC,MAAZ,CAAmB,YAAnB,EAAiC;;AAElD;;;;;;AAMAC,MARkD,gBAQ7CC,WAR6C,EAQhCC,cARgC,EAQhB;;AAEhC,SAAKC,IAAL,GAAY,YAAZ;;AAEA;AACA,SAAKC,UAAL,GAAkB,CAAC;AACjBC,oCADiB;AAEjBJ,mBAAa,eAFI;AAGjBK,aAAO,CAAC,YAAD,EAAe,cAAf,EAA+B,oBAA/B,EAAqD,gBAArD,EAAuE,qBAAvE,EAA8F,4BAA9F,EAA4H,0BAA5H,EAAwJ,QAAxJ,EAAkK,IAAlK,CAHU,CAG8J;AAH9J,KAAD,EAIf;AACDD,iBAAWR,OAAOU,SAAP,CAAiBC,GAAjB,CAAqB,YAArB,CADV;AAEDP,mBAAa,sBAFZ;AAGDK,aAAO,CAAC,YAAD,EAAe,cAAf,EAA+B,IAA/B;AAHN,KAJe,EAQf;AACDD,iBAAWR,OAAOU,SAAP,CAAiBC,GAAjB,CAAqB,SAArB,CADV;AAEDP,mBAAa,mBAFZ;AAGDK,aAAO,CAAC,OAAD,EAAU,IAAV,EAAgB,QAAhB;AAHN,KARe,EAYf;AACDD,iBAAWR,OAAOU,SAAP,CAAiBC,GAAjB,CAAqB,YAArB,CADV;AAEDP,mBAAa,sBAFZ;AAGDK,aAAO,CAAC,OAAD,EAAU,IAAV,EAAgB,QAAhB;AAHN,KAZe,EAgBf;AACDD,iBAAWR,OAAOU,SAAP,CAAiBC,GAAjB,CAAqB,UAArB,CADV;AAEDP,mBAAa,oBAFZ;AAGDK,aAAO,CAAC,cAAD,EAAiB,mBAAjB,EAAsC,YAAtC,EAAoD,QAApD;AAHN,KAhBe,EAoBf;AACDD,iBAAWR,OAAOU,SAAP,CAAiBC,GAAjB,CAAqB,WAArB,CADV;AAEDP,mBAAa,qBAFZ;AAGDK,aAAO,CAAC,cAAD,EAAiB,QAAjB;AAHN,KApBe,EAwBf;AACDD,iBAAWR,OAAOU,SAAP,CAAiBC,GAAjB,CAAqB,oBAArB,CADV;AAEDP,mBAAa,gCAFZ;AAGDK,aAAO,CAAC,YAAD,EAAe,QAAf;AAHN,KAxBe,CAAlB;;AA8BA;AACA,SAAKG,MAAL,CAAYR,WAAZ,EAAyBC,cAAzB;AACD,GA7CiD;AA+ClDQ,UA/CkD,oBA+CzCJ,KA/CyC,EA+ClC;AACdA,YAAQ,KAAKA,KAAL,IAAcA,KAAtB;;AAEA,SAAKG,MAAL,CAAYH,KAAZ;;AAEA;AACA,QAAI,CAAC,KAAKA,KAAV,EAAiB;AACf,UAAMK,WAAWL,MAAMM,KAAN,CAAYD,QAA7B;AACA,UAAIE,OAAOC,IAAP,CAAYH,SAASI,IAArB,EAA2BC,MAA3B,GAAoC,CAAxC,EAA2C;AACzC,YAAMD,OAAO,EAAb;AACA,YAAIJ,SAASI,IAAT,CAAcJ,SAASM,GAAvB,KAA+BJ,OAAOC,IAAP,CAAYH,SAASI,IAArB,EAA2BC,MAA3B,KAAsC,CAAzE,EAA4E;AAC1ED,eAAKJ,SAASM,GAAd,IAAqBN,SAASI,IAAT,CAAcJ,SAASM,GAAvB,CAArB;AACD;AACD,YAAI,CAACN,SAASI,IAAT,CAAcJ,SAASM,GAAvB,CAAD,IAAgC,EAAEJ,OAAOC,IAAP,CAAYH,SAASI,IAArB,EAA2BC,MAA3B,IAAqC,CAAvC,CAApC,EAA+E;AAC7EL,mBAASI,IAAT,GAAgBA,IAAhB;AACD;AACF;;AAED,UAAMG,qBAAqBZ,MAAMM,KAAN,CAAYM,kBAAvC;AACAA,yBAAmBC,UAAnB,GAAgCb,MAAMM,KAAN,CAAYD,QAAZ,CAAqBM,GAArB,KAA6BC,mBAAmBD,GAAhD,IAC9BX,MAAMM,KAAN,CAAYQ,aAAZ,CAA0BH,GAA1B,KAAkCC,mBAAmBD,GADvD;AAED;AACF,GArEiD;;;AAuElDI,iBAAe;AACbT,WAAO;AACLU,mBAAa;AADR,KADM;AAIbC,QAAI;AACFC,aAAO;AACLC,iBAAS,IADJ;AAELC,mBAAW,KAFN;AAGLC,mBAAW;AAHN,OADL;AAMF,iBAAW,CAAC,QAAD,EAAW,WAAX,EAAwB,MAAxB,EAAgC,MAAhC,EAAwC,aAAxC,EAAuD,YAAvD,CANT;AAOF,iBAAW;AACT,iBAAS,CAAC,aAAD,EAAgB,QAAhB,EAA0B,MAA1B,EAAkC,MAAlC,EAA0C,aAA1C,CADA;AAET,mBAAW,CAAC,aAAD,EAAgB,QAAhB,EAA0B,MAA1B,CAFF;AAGT,uBAAe,CAAC,SAAD,EAAY,OAAZ,EAAqB,QAArB,EAA+B,MAA/B,EAAuC,cAAvC,EAAuD,OAAvD;AAHN,OAPT;AAYFC,oBAAc;AAZZ,KAJS;AAkBbC,YAAQ;AAlBK,GAvEmC;;AA4FlDC,eAAarC;AA5FqC,CAAjC,CAAnB;;kBA+FeG,U;;;;;;;;;;;;;;;cC5FXC,M;IARFkC,K,WAAAA,K;IACAxB,S,WAAAA,S;IAE4ByB,S,WAD5BC,O,CACE,wB;IAGUC,Y,WADZC,O,CACEC,Q;;AAIJ;;AACA,IAAMxC,aAAaW,UAAUR,MAAV,CAAiB,YAAjB,EAA+B;;AAEhD;;;;;;AAMAC,MARgD,gBAQ3CqC,MAR2C,EAQnCC,OARmC,EAQ1B;AACpB,SAAKnC,IAAL,GAAY,YAAZ;AACA,SAAKoC,QAAL,GAAgB,mBAAAC,CAAQ,CAAR,CAAhB;;AAEA;AACA,SAAKC,aAAL,GAAqB,CAAC;AACpBtC,YAAM,MADc;AAEpBuC,YAAM;AAFc,KAAD,EAGlB;AACDvC,YAAM,QADL;AAEDuC,YAAM;AAFL,KAHkB,EAMlB;AACDvC,YAAM,cADL;AAEDuC,YAAM;AAFL,KANkB,EASlB;AACDvC,YAAM,UADL;AAEDuC,YAAM;AAFL,KATkB,EAYlB;AACDvC,YAAM,eADL;AAEDuC,YAAM;AAFL,KAZkB,EAelB;AACDvC,YAAM,sBADL;AAEDuC,YAAM;AAFL,KAfkB,EAkBlB;AACDvC,YAAM,oBADL;AAEDuC,YAAM;AAFL,KAlBkB,EAqBlB;AACDvC,YAAM,QADL;AAEDuC,YAAM;AAFL,KArBkB,EAwBlB;AACDvC,YAAM,IADL;AAEDuC,YAAM;AAFL,KAxBkB,CAArB;;AA6BA,QAAMC,QAAQ,IAAd;AACA,SAAKC,WAAL,GAAmB;AACjB,2BAAqB,yBAASC,GAAT,EAAc;AACjC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvB,YAAIH,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBC,IAAjB,IAAyB,CAAzB,IAA8B,CAACL,MAAMM,OAArC,IAAgD,CAACN,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBG,OAAlE,IAA6E,CAACP,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBI,QAAnG,EAA6G;AAC3G,cAAIC,OAAOC,GAAGC,UAAH,CAAcX,MAAMY,SAApB,EAA+BZ,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAAhD,CAAX;AACA,cAAIJ,QAAQ,CAAR,IAAcT,MAAMY,SAAN,CAAgBH,IAAhB,IAAwBT,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAA3D,EAAmE;AACjEb,kBAAMM,OAAN,GAAgB,IAAhB;AACA,gBAAMF,OAAOJ,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAA9B;AACA,gBAAMC,OAAOd,MAAMY,SAAN,CAAgBH,OAAO,CAAvB,CAAb;AACAA,mBAAOT,MAAMY,SAAN,CAAgBH,IAAhB,CAAP;AACA,gBAAMM,WAAYX,OAAOU,IAAR,GAAiBL,OAAOL,IAAxB,GAAgCU,IAAhC,GAAuCL,IAAxD;AACAT,kBAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAAjB,GAAyB,IAAIG,IAAJ,CAASD,QAAT,CAAzB;AACD;AACF;AACD,YAAI,CAACf,MAAMM,OAAX,EAAoB;AAC5B;AACYN,gBAAMrC,KAAN,CAAYsD,MAAZ,CAAmBC,QAAnB,CAA4BlB,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAA7C,EAAoD,iBAAS;AAC3Db,kBAAMmB,KAAN,GAAcA,KAAd;AACAnB,kBAAMoB,UAAN,GAAmBD,MAAME,MAAzB;AACArB,kBAAMrC,KAAN,CAAY2D,YAAZ,CAAyBJ,QAAzB,CAAkClB,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAAnD,EAA0D,sBAAc;AACtEb,oBAAMuB,UAAN,GAAmBA,WAAWC,UAA9B;;AAEAxB,oBAAMyB,YAAN;AACAzB,oBAAM0B,eAAN,CAAsB,IAAtB;AACA1B,oBAAM2B,iBAAN;AACD,aAND;AAOD,WAVD;AAWH;AACD3B,cAAMM,OAAN,GAAgB,KAAhB;AACD,OA7BgB;AA8BjB,uBAAiB,sBAASJ,GAAT,EAAc0B,IAAd,EAAoB;AACnC,YAAI,CAAC5B,MAAMG,UAAX,EAAuB;AACvB,YAAIyB,KAAKC,OAAL,CAAa,WAAb,IAA4B,CAAC,CAAjC,EAAoC;AAClC7B,gBAAM8B,KAAN;AACA;AACD;AACF,OApCgB;AAqCjB,8BAAwB,4BAAS5B,GAAT,EAAc;AACpCF,cAAM+B,YAAN,GAAsB/B,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBe,MAAnB,CAA0B3D,MAA1B,GAAmC,CAAzD;AACA2B,cAAMiC,sBAAN,GAA+B,KAA/B;AACAjC,cAAM2B,iBAAN;AACD,OAzCgB;AA0CjB,iCAA2B,+BAASzB,GAAT,EAAc0B,IAAd,EAAoB;AAC7C,YAAI,CAAC5B,MAAMG,UAAX,EAAuB;AACvBH,cAAMkC,cAAN;AACD,OA7CgB;AA8CjB,wCAAkC,wCAAW;AAC3ClC,cAAM2B,iBAAN;AACD,OAhDgB;AAiDjB,sCAAgC,sCAAW;AACzC3B,cAAM2B,iBAAN;AACD,OAnDgB;AAoDjB,qCAA+B,kCAASzB,GAAT,EAAc;AAC3C,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvBH,cAAM0B,eAAN;AACD,OAvDgB;AAwDjB,uCAAiC,oCAASxB,GAAT,EAAc;AAC7C,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvBH,cAAM0B,eAAN;AACD,OA3DgB;AA4DjB,mCAA6B,gCAASxB,GAAT,EAAc;AACzC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvBH,cAAMrC,KAAN,CAAY2D,YAAZ,CAAyBE,UAAzB,CAAoCW,KAApC,GAA4CnC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBmB,KAAnB,CAAyBD,KAArE;AACD,OA/DgB;AAgEjB,kCAA4B,+BAASjC,GAAT,EAAc;AACxC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvB,YAAIkC,gBAAJ;AACA,YAAMjE,OAAO,EAAb;AACA,YAAMkE,oBAAoB,EAA1B;AACA,YAAItC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBC,GAAxB,IAA+B,UAAnC,EAA+C;AAC7CH,oBAAU,IAAV;AACD,SAFD,MAEO;AACL,cAAMI,cAAczC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBG,eAAxB,EAApB;AACA,cAAID,YAAYE,YAAZ,IAA4B,YAAhC,EAA8C;AAC5CN,sBAAUI,YAAYG,MAAtB;AACD,WAFD,MAEO;AACLP,sBAAUrC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBJ,KAAlC;AACD;AACF;AACT;AACQnC,cAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBM,cAAxB;AACA,YAAMC,iBAAiBT,YAAYrC,MAAM+C,kBAAzC;AACA,YAAI,CAACD,cAAL,EAAqB;AACnB1E,eAAK,SAAS4B,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBJ,KAAtC,IAA+C,IAA/C;AACD;AACDnC,cAAMrC,KAAN,CAAYc,aAAZ,CAA0BD,UAA1B,GAAuCsE,cAAvC;AACAR,0BAAkB,MAAlB,IAA4BlE,IAA5B;AACAkE,0BAAkB,KAAlB,IAA2BD,OAA3B;AACArC,cAAMrC,KAAN,CAAYc,aAAZ,CAA0BuE,GAA1B,CAA8BV,iBAA9B;AACAtC,cAAMrC,KAAN,CAAYY,kBAAZ,CAA+BC,UAA/B,GAA4C,CAAC6D,YAAYrC,MAAM+C,kBAAlB,IAAwC/C,MAAMiD,QAAN,KAAmBjD,MAAM+C,kBAAlE,MACzCG,QAAQlD,MAAMrC,KAAN,CAAYK,QAAZ,CAAqBmF,mBAArB,GAA2C9E,MAAnD,KAA8D,CAAC2B,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BD,UADhD,CAA5C;AAGD,OA5FgB;AA6FjB,8BAAwB,4BAAS0B,GAAT,EAAc;AACpC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvB,YAAIH,MAAMrC,KAAN,CAAYK,QAAZ,CAAqBM,GAArB,KAA6B0B,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BH,GAAvD,IACC,CAACc,MAAMgE,OAAN,CAAcpD,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BL,IAAxC,CADN,EACqD;AACnD,cAAMiF,eAAerD,MAAMrC,KAAN,CAAYc,aAAZ,CAA0B0E,mBAA1B,GAAgDG,MAAhD,CAAuD;AAAA,mBAAK,CAACtD,MAAMrC,KAAN,CAAYK,QAAZ,CAAqBuF,OAArB,CAA6BC,CAA7B,CAAN;AAAA,WAAvD,CAArB;AACA,cAAIH,aAAahF,MAAjB,EAAyB;AACvB2B,kBAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBM,cAAxB;AACA7C,kBAAMrC,KAAN,CAAYc,aAAZ,CAA0BgF,UAA1B,CAAqCJ,YAArC;AACD;AACF;AACDrD,cAAMrC,KAAN,CAAYY,kBAAZ,CAA+BC,UAA/B,GAA4C,CAACwB,MAAM0D,OAAN,KAAkB1D,MAAM+C,kBAAxB,IAA8C/C,MAAMiD,QAAN,KAAmBjD,MAAM+C,kBAAxE,MACzCG,QAAQlD,MAAMrC,KAAN,CAAYK,QAAZ,CAAqBmF,mBAArB,GAA2C9E,MAAnD,KAA8D,CAAC2B,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BD,UADhD,CAA5C;AAGD,OA1GgB;AA2GjB,mCAA6B,iCAAS0B,GAAT,EAAc;AACzC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvB,YAAIwD,WAAW,KAAf;AACA,YAAIC,2BAA2B,IAA/B;AACAxE,cAAMyE,OAAN,CAAc7D,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwBuB,MAAtC,EAA8C,aAAK;AACjD,cAAIC,EAAEzF,GAAF,KAAU0B,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BH,GAApC,IAA2CyF,EAAEC,KAAF,KAAYhE,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BuF,KAAjF,IAA0FD,EAAEC,KAAF,KAAYhE,MAAMrC,KAAN,CAAYY,kBAAZ,CAA+ByF,KAAzI,EAAgJ;AAC9IJ,uCAA2BG,CAA3B;AACD;AACF,SAJD;AAKA,YAAIH,wBAAJ,EAA8B;AAC5B5D,gBAAMrC,KAAN,CAAYK,QAAZ,CAAqBmF,mBAArB;AACA,cAAME,eAAerD,MAAMrC,KAAN,CAAYc,aAAZ,CAA0B0E,mBAA1B,GAAgDG,MAAhD,CAAuD;AAAA,mBAAK,CAACM,yBAAyBL,OAAzB,CAAiCC,CAAjC,CAAN;AAAA,WAAvD,CAArB;AACA,cAAIH,aAAahF,MAAjB,EAAyB;AACvBuF,qCAAyBH,UAAzB,CAAoCJ,YAApC;AACAM,uBAAW,IAAX;AACD;AACF;AACD,YAAI3D,MAAM0D,OAAN,KAAkB1D,MAAMrC,KAAN,CAAYc,aAAZ,CAA0BH,GAAhD,EAAqD;AACnDqF,qBAAW,IAAX;AACD;AACD,YAAIA,QAAJ,EAAc;;AAEd3D,cAAMiE,iBAAN;AACA,YAAI,CAACjE,MAAMrC,KAAN,CAAYmE,KAAb,IAAsB,CAAC9B,MAAMmB,KAAjC,EAAwC;AACxCnB,cAAMkE,aAAN;AACAlE,cAAMmE,MAAN;AACAnE,cAAM0B,eAAN,CAAsB,IAAtB;AACD,OAtIgB;AAuIjB,mCAA6B,gCAASxB,GAAT,EAAc;AACzC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvBH,cAAMkE,aAAN;AACAlE,cAAMmE,MAAN;AACAnE,cAAM0B,eAAN;AACD,OA5IgB;AA6IjB,mCAA6B,gCAASxB,GAAT,EAAc;AACzC,YAAI,CAACF,MAAMG,UAAX,EAAuB;AACvBH,cAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsB,IAAnB,CAAwB6B,eAAxB;AACApE,cAAMiE,iBAAN;AACAjE,cAAMmE,MAAN;AACAnE,cAAM0B,eAAN,CAAsB,IAAtB;AACD;AAnJgB,KAAnB;;AAsJA;AACA,SAAK5D,MAAL,CAAY4B,MAAZ,EAAoBC,OAApB;;AAEA,SAAK0E,MAAL,GAAc,IAAd;AACA,SAAKC,MAAL,GAAc,IAAd;AACA,SAAKC,MAAL,GAAc,IAAd;;AAEA,SAAKC,KAAL,GAAanF,UAAU,QAAV,CAAb;AACA,SAAKoF,SAAL,GAAiBpF,UAAU,QAAV,CAAjB;AACA,SAAKqF,KAAL,GAAarF,UAAU,MAAV,CAAb;AACA,SAAKsF,OAAL,GAAe,EAAf;;AAEA,SAAKC,cAAL,GAAsB,OAAtB;AACD,GA9M+C;AAgNhDC,iBAhNgD,6BAgN9B;AAChB,QAAMC,WAAW,KAAKnH,KAAL,CAAWK,QAAX,CAAoBM,GAArC;AACA,QAAM+D,UAAU,KAAK1E,KAAL,CAAWc,aAAX,CAAyBH,GAAzC;;AAEA,SAAKyG,mBAAL,GAA2B,KAAKpH,KAAL,CAAWsD,MAAX,CAAkBmB,KAAlB,CAAwBI,GAAxB,IAA+B,UAA/B,IAA6C,KAAK7E,KAAL,CAAWsD,MAAX,CAAkBmB,KAAlB,CAAwBD,KAAxB,IAAiC,KAAK6C,IAA9G;AACA,SAAKC,SAAL,GAAiBH,YAAYzC,OAA7B;AACA,SAAK6C,OAAL,GAAeJ,aAAa,KAAK/B,kBAAlB,IAAwCV,YAAY,KAAKU,kBAAxE;AACA,SAAKoC,QAAL,GAAgB,KAAKxH,KAAL,CAAWsD,MAAX,CAAkBsB,IAAlB,CAAuBC,GAAvB,IAA8B,UAA9C;AACD,GAxN+C;;;AA0NhD;;;AAGA4C,WA7NgD,uBA6NpC;AACV,QAAMpF,QAAQ,IAAd;AACA,SAAKqF,EAAL,GAAW,KAAKA,EAAN,GAAY,KAAKA,EAAjB,GAAsB3E,GAAGsB,MAAH,CAAU,KAAKsD,OAAf,CAAhC;AACA,SAAKA,OAAL,GAAe,KAAKD,EAApB;;AAEA,SAAKE,WAAL,GAAmB,KAAKC,YAAL,EAAnB;;AAEA,SAAKC,KAAL,GAAa,KAAKH,OAAL,CAAatD,MAAb,CAAoB,eAApB,CAAb;AACA,SAAK0D,OAAL,GAAe,KAAKD,KAAL,CAAWzD,MAAX,CAAkB,gBAAlB,CAAf;AACA,SAAK2D,OAAL,GAAe,KAAKF,KAAL,CAAWzD,MAAX,CAAkB,gBAAlB,CAAf;AACA,SAAK4D,WAAL,GAAmB,KAAKH,KAAL,CAAWzD,MAAX,CAAkB,qBAAlB,CAAnB;AACA,SAAK6D,QAAL,GAAgB,KAAKP,OAAL,CAAatD,MAAb,CAAoB,sBAApB,CAAhB;AACA,SAAK8D,OAAL,GAAe,KAAKR,OAAL,CAAatD,MAAb,CAAoB,qBAApB,CAAf;AACA,SAAK+D,QAAL,GAAgB,KAAKN,KAAL,CAAWzD,MAAX,CAAkB,sBAAlB,CAAhB;AACA,SAAKgE,QAAL,GAAgB,KAAKP,KAAL,CAAWzD,MAAX,CAAkB,mBAAlB,CAAhB;AACA,SAAKiE,UAAL,GAAkB,KAAKR,KAAL,CAAWzD,MAAX,CAAkB,qBAAlB,CAAlB;AACA,SAAKkE,IAAL,GAAY,KAAKT,KAAL,CAAWzD,MAAX,CAAkB,cAAlB,CAAZ;AACA,SAAKmE,MAAL,GAAc,KAAKV,KAAL,CAAWzD,MAAX,CAAkB,gBAAlB,CAAd;AACA,SAAKmE,MAAL,CAAYnE,MAAZ,CAAmB,eAAnB,EAAoCoE,IAApC,CAAyC,GAAzC,EAA8C,CAAC,EAA/C;;AAEA,SAAKC,KAAL,GAAa,KAAKf,OAAL,CAAatD,MAAb,CAAoB,eAApB,CAAb;AACA,SAAKsE,UAAL,GAAkB,KAAKhB,OAAL,CAAatD,MAAb,CAAoB,qBAApB,CAAlB;AACA,SAAKuE,IAAL,GAAY,KAAKjB,OAAL,CAAatD,MAAb,CAAoB,cAApB,CAAZ;;AAEA,SAAKe,kBAAL,GAA0B,KAAKpF,KAAL,CAAWY,kBAAX,CAA8BiI,YAA9B,EAA1B;AACA,SAAKC,qBAAL,GAA6B,CAAC,CAAC,KAAK9I,KAAL,CAAWY,kBAAX,CAA8BH,IAA9B,CAAmC,KAAK2E,kBAAxC,KAA+D,EAAhE,EAAoE,KAApE,KAA8E,EAA/E,EAAmF,CAAnF,CAA7B;;AAEA/C,UAAM+B,YAAN,GAAsB/B,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBe,MAAnB,CAA0B3D,MAA1B,GAAmC,CAAzD;AACA2B,UAAMiC,sBAAN,GAA+B,KAA/B;;AAGA,SAAKyE,EAAL,CAAQ,QAAR,EAAkB,YAAM;AACtB1G,YAAM0B,eAAN;AACH,KAFC;;AAIA,SAAKiF,kBAAL,GAA0B;AACxBC,eADwB,qBACdC,CADc,EACXC,CADW,EACR;AACdD,UAAE,IAAF,IAAU,CAAV;AACA,YAAME,QAAQ/G,MAAMoB,UAAN,CAAiBhC,MAAM4H,MAAN,CAAaH,CAAb,EAAgB7G,MAAMiH,IAAtB,CAAjB,CAAd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAJ,UAAE,QAAF,IAAcE,QAAQ/G,MAAMqE,MAAN,CAAa0C,KAAb,CAAR,GAA8B,CAA5C;AACA,YAAI/G,MAAMpB,EAAN,CAASC,KAAT,CAAeE,SAAnB,EAA8B;AAC5B8H,YAAE,QAAF,KAAe7G,MAAMkH,KAAN,CAAYL,EAAE7G,MAAMmH,eAAR,CAAZ,CAAf;AACD;AACD,eAAON,EAAEO,MAAT;AACD,OAxBuB;AAyBxBC,WAzBwB,iBAyBlBR,CAzBkB,EAyBfC,CAzBe,EAyBZ;AACV,YAAMQ,UAAU,KAAKC,eAArB;AACA,YAAID,OAAJ,EAAa;AACX,cAAME,eAAe9G,GAAGsB,MAAH,CAAUsF,OAAV,EAAmBG,KAAnB,EAArB;AACAZ,YAAE,IAAF,IAAUW,aAAaE,EAAb,GAAkBF,aAAaJ,MAAzC;AACD,SAHD,MAGO;AACLP,YAAE,IAAF,IAAU,CAAV;AACD;AACD,eAAOA,EAAEa,EAAT;AACD,OAlCuB;AAmCxBC,eAnCwB,qBAmCdd,CAnCc,EAmCXC,CAnCW,EAmCR;AACd,eAAO9G,MAAMuE,MAAN,CAAa,CAACvE,MAAM+E,mBAAP,GAA6B/E,MAAMmB,KAAN,CAAYiB,KAAZ,CAAkBhD,MAAM4H,MAAN,CAAaH,CAAb,EAAgB7G,MAAM4H,SAAtB,CAAlB,CAA7B,GAAmF5H,MAAMmB,KAAN,CAAYiB,KAAZ,CAAkByE,EAAE7G,MAAMiD,QAAR,CAAlB,CAAhG,CAAP;AACD;AArCuB,KAA1B;AAuCD,GAvS+C;;;AAyShD;;;AAGAnB,OA5SgD,mBA4SxC;AAAA;;AACN;AACA,QAAI,CAAC,KAAKnE,KAAL,CAAWsD,MAAX,CAAkB4G,MAAvB,EAA+B;;AAE/B,QAAM7H,QAAQ,IAAd;;AAEA,SAAKY,SAAL,GAAiB,KAAKjD,KAAL,CAAWyC,IAAX,CAAgB0H,WAAhB,EAAjB;;AAEA,SAAK9C,IAAL,GAAY,KAAKrH,KAAL,CAAWsD,MAAX,CAAkB8G,kBAAlB,CAAqC,EAAEhI,MAAM,MAAR,EAArC,CAAZ;AACA,SAAKkH,IAAL,GAAY7H,MAAM4I,MAAN,CAAa,KAAKrK,KAAL,CAAWsD,MAAX,CAAkBgH,iBAAlB,CAAoC,EAAEC,YAAY,MAAd,EAApC,CAAb,CAAZ;AACA,SAAK3F,IAAL,GAAY,KAAK5E,KAAL,CAAWsD,MAAX,CAAkBkH,UAAlB,CAA6BC,SAA7B,EAAZ;AACA,SAAK1E,OAAL,GAAe,KAAKnB,IAAL,CAAUiE,YAAV,EAAf;AACA,SAAKW,eAAL,GAAuB,UAAU,KAAKzD,OAAtC;AACA,SAAK2E,KAAL,GAAa,KAAK1K,KAAL,CAAWsD,MAAX,CAAkBqH,MAAlB,CAAyBF,SAAzB,EAAb;AACA,SAAKnF,QAAL,GAAgB,KAAKoF,KAAL,CAAW7B,YAAX,EAAhB;AACA,SAAK+B,gBAAL,GAAwB,WAAW,KAAKtF,QAAxC;AACA,SAAKuF,OAAL,GAAe,KAAK7K,KAAL,CAAWyC,IAAX,CAAgBoG,YAAhB,EAAf;AACA,SAAKoB,SAAL,GAAiB,CAAC,KAAK3E,QAAN,EAAgB,KAAKkE,eAArB,CAAjB;AACA,SAAKtC,eAAL;AACA,SAAK4D,eAAL;AACA,SAAKxE,iBAAL;;AAEA,SAAK9C,KAAL,GAAa,IAAb;AACA,SAAKxD,KAAL,CAAWsD,MAAX,CAAkBC,QAAlB,CAA2BlB,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAA5C,EAAmD,iBAAS;AAC1Db,YAAMmB,KAAN,GAAcA,KAAd;AACAnB,YAAMoB,UAAN,GAAmBD,MAAME,MAAzB;AACArB,YAAMrC,KAAN,CAAY2D,YAAZ,CAAyBJ,QAAzB,CAAkClB,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBS,KAAnD,EAA0D,sBAAc;AACtEb,cAAMuB,UAAN,GAAmBA,WAAWC,UAA9B;AACAxB,cAAM0I,KAAN,GAAc1I,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmB0H,OAAnB,EAAd;AACA3I,cAAM4I,aAAN;AACA5I,cAAMkE,aAAN;;AAEAlE,cAAMyB,YAAN;AACAzB,cAAM6I,OAAN,GAAgB,OAAKlL,KAAL,CAAWsD,MAAX,CAAkB0H,OAAlB,CAA0B3I,MAAMiD,QAAhC,CAAhB;;AAEAjD,cAAMmE,MAAN;AACAnE,cAAM0B,eAAN,CAAsB,IAAtB;AACA1B,cAAM2B,iBAAN;AACD,OAZD;AAaD,KAhBD;AAiBD,GApV+C;AAsVhD8G,iBAtVgD,6BAsV9B;AAChB,QAAMzI,QAAQ,IAAd;AACA,SAAK8I,UAAL,GAAkB,KAAKnL,KAAL,CAAWuB,MAAX,CAAkB6J,YAAlB,EAAlB;;AAEA,QAAMC,SAAS,KAAKnD,QAAL,CAAcoD,SAAd,CAAwB,MAAxB,EAAgCC,IAAhC,CAAqC,CAAC,CAAD,CAArC,CAAf;AACAF,WAAOG,KAAP,GAAeC,MAAf,CAAsB,MAAtB;AACAJ,WACGtC,EADH,CACM,OADN,EACe,YAAM;AACjB1G,YAAMqJ,MAAN,CACGC,eADH,CACmB,oBADnB,EAEGC,QAFH,CAEY,QAFZ,EAGGC,MAHH,CAGUxJ,MAAMrC,KAAN,CAAYuB,MAAZ,CAAmBuK,KAAnB,KAA6B,OAA7B,GAAuC,MAHjD,EAIGC,MAJH,CAIU,KAJV,EAKGC,UALH,GAMGC,MANH;AAOD,KATH;;AAWA,QAAMC,gBAAgB,KAAKlM,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyBqB,eAAzB,EAAtB;AACAtD,UAAM0K,OAAN,CAAc,KAAKhE,OAAnB,EAA4BvG,YAA5B,EACGyC,MADH,CACU,KADV,EACiBoE,IADjB,CACsB,OADtB,EAC+B,KAD/B,EACsCA,IADtC,CAC2C,QAD3C,EACqD,KADrD,EAEG2D,KAFH,CAES,SAFT,EAEoBC,OAAO9G,QAAQ2G,cAAcI,WAAd,IAA6BJ,cAAcK,UAAnD,CAAP,CAFpB;;AAIA,SAAKpE,OAAL,CAAaY,EAAb,CAAgB,OAAhB,EAAyB,YAAM;AAC7B1G,YAAMqJ,MAAN,CAAaC,eAAb,CAA6B,qBAA7B,EAAoDa,GAApD;AACD,KAFD;AAGA,SAAKrE,OAAL,CAAaY,EAAb,CAAgB,WAAhB,EAA6B,YAAW;AACtC,UAAI1G,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBI,QAArB,EAA+B;AAC/B,UAAM4J,OAAO,KAAKC,OAAL,EAAb;AACA,UAAMC,QAAQlL,MAAMmL,mBAAN,CAA0B,IAA1B,EAAgC,KAAKC,uBAArC,EAA8DJ,KAAKK,CAAL,GAAS,EAAvE,EAA2EL,KAAKM,CAAL,GAASN,KAAKO,MAAd,GAAuB,EAAlG,CAAd;AACA,UAAMC,WAAW5K,MAAM6K,IAAN,CAAWvF,OAAX,CAAmBwF,qBAAnB,EAAjB;AACA,UAAMC,YAAY/K,MAAMsF,OAAN,CAAc0F,IAAd,GAAqBF,qBAArB,EAAlB;AACA9K,YAAMqJ,MAAN,CAAaC,eAAb,CAA6B,qBAA7B,EAAoD2B,OAApD,CAA4D,QAA5D,EAAsE7M,IAAtE,GAA6E8M,MAA7E,CAAoFZ,MAAMG,CAAN,GAAUM,UAAUI,IAApB,GAA2BP,SAASO,IAAxH,EAA8Hb,MAAMI,CAApI;AACD,KAPD;AAQA,SAAK5E,OAAL,CAAaY,EAAb,CAAgB,UAAhB,EAA4B,YAAM;AAChC,UAAI1G,MAAMrC,KAAN,CAAYyC,IAAZ,CAAiBI,QAArB,EAA+B;AAC/BR,YAAMqJ,MAAN,CAAaC,eAAb,CAA6B,qBAA7B,EAAoD8B,IAApD;AACD,KAHD;;AAKA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,GArY+C;;;AAuYhD;;;AAGAnH,mBA1YgD,+BA0Y5B;AAAA;;AAClB,QAAMjE,QAAQ,IAAd;AACA,SAAKqL,QAAL,GAAgB,KAAK1N,KAAL,CAAWyC,IAAX,CAAgBkL,eAAhC;AACA,SAAKhH,MAAL,GAAc,KAAK3G,KAAL,CAAWsD,MAAX,CAAkBqH,MAAlB,CAAyBiD,QAAzB,EAAd;AACA,SAAKlH,MAAL,GAAc,KAAK1G,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyBkK,QAAzB,EAAd;AACA,SAAK7G,KAAL,CAAW8G,UAAX,CAAsBxL,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBqH,MAAnB,CAA0BmD,gBAA1B,EAAtB;AACA,SAAKjH,KAAL,CAAWgH,UAAX,CAAsBxL,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBI,MAAnB,CAA0BoK,gBAA1B,EAAtB;AACA,SAAKhH,SAAL,CAAe+G,UAAf,CAA0BxL,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBI,MAAnB,CAA0BoK,gBAA1B,EAA1B;;AAEA,QAAMpJ,UAAU,KAAKqB,OAArB;AACA,QAAMoB,WAAW,KAAK7B,QAAtB;;AAEA,QAAMyI,SAAS,KAAK/N,KAAL,CAAWsD,MAAX,CAAkB0H,OAAlB,CAA0B7D,QAA1B,CAAf;AACA,QAAI6G,YAAY,EAAhB;AACAA,gBAAYD,OAAOE,GAAP,CAAW;AAAA,aAAKC,EAAE/G,QAAF,CAAL;AAAA,KAAX,CAAZ;AACA,SAAK6G,SAAL,GAAiBA,SAAjB;;AAEA,QAAMG,YAAY,KAAKnO,KAAL,CAAWsD,MAAX,CAAkBkH,UAAlB,CAA6B4D,QAA7B,EAAlB;AACA;AACA,QAAIC,WAAW,EAAf;AACA,QAAI,CAAC5M,MAAMgE,OAAN,CAAc0I,SAAd,CAAL,EAA+B;AAC7B,UAAMG,eAAe,CAAC,CAAC,KAAKtO,KAAL,CAAWsD,MAAX,CAAkBsB,IAAlB,CAAuB6F,SAAvB,GAAmChK,IAAnC,CAAwCiE,OAAxC,CAAvB;AACA,UAAM6J,QAAQ,KAAKvO,KAAL,CAAWsD,MAAX,CAAkB0H,OAAlB,CAA0BtG,OAA1B,EACTiB,MADS,CACF;AAAA,eAAK,CAAC2I,YAAD,IAAiB,OAAKtO,KAAL,CAAWsD,MAAX,CAAkBsB,IAAlB,CAAuB6F,SAAvB,GAAmC7E,OAAnC,CAA2C4I,CAA3C,CAAtB;AAAA,OADE,CAAd;AAEAH,iBAAWE,MAAMN,GAAN,CAAU;AAAA,eAAKC,EAAExJ,OAAF,CAAL;AAAA,OAAV,CAAX;;AAEA,UAAI2J,SAAS3N,MAAT,GAAkB,CAAtB,EAAyB2N,SAAS3N,MAAT,GAAkB,CAAlB;AACzB,UAAI2N,SAAS3N,MAAT,GAAkB,CAAtB,EAAyB;AACvB,YAAM+N,WAAW,KAAKxN,EAAL,CAAQC,KAAR,CAAcG,SAAd,GAA0B0B,GAAG2L,SAA7B,GAAyC3L,GAAG4L,UAA7D;AACAN,iBAASO,IAAT,CAAcH,QAAd;AACD;AACF;AACD,QAAI,CAACJ,SAAS3N,MAAd,EAAsB2N,SAASQ,IAAT,CAAc,WAAd;AACtB,SAAKR,QAAL,GAAgBA,QAAhB;;AAEA,SAAKS,QAAL,GAAgB,KAAKT,QAAL,CAAc3N,MAAd,GAAuB,CAAvC;AACA,SAAKiI,UAAL,CAAgBoG,OAAhB,CAAwB,YAAxB,EAAsC,CAAC,KAAKD,QAA5C;AACA,QAAI,KAAKA,QAAT,EAAmB;AACjB,WAAKE,UAAL,GAAkB,KAAKtI,MAAL,CAAYuI,IAAZ,EAAlB;AACA,WAAKvG,KAAL,CAAWwG,IAAX,CAAgBf,UAAU,KAAKE,QAAL,CAAc,CAAd,CAAV,CAAhB;AACA,WAAK1F,UAAL,CAAgBuG,IAAhB,CAAqBf,UAAU,KAAKE,QAAL,CAAc,CAAd,CAAV,CAArB;AACD,KAJD,MAIO;AACL,UAAM3F,QAAQ,KAAK2F,QAAL,CAAc3N,MAAd,IAAwByN,UAAU,KAAKE,QAAL,CAAc,CAAd,CAAV,CAAxB,GAAsDF,UAAU,KAAKE,QAAL,CAAc,CAAd,CAAV,CAAtD,GAAoF,EAAlG;AACA,WAAK3F,KAAL,CAAWwG,IAAX,CAAgBxG,KAAhB;AACD;;AAED,SAAK9B,MAAL,GAAc,KAAK5G,KAAL,CAAWsD,MAAX,CAAkBmB,KAAlB,CAAwBmJ,QAAxB,EAAd;AACD,GAzb+C;AA2bhD9J,cA3bgD,0BA2bjC;AACb,QAAMzB,QAAQ,IAAd;AACA,QAAM4C,SAAS,KAAK0B,MAAL,CAAY1B,MAAZ,EAAf;AACA,QAAMoJ,WAAW,KAAKA,QAAtB;AACApJ,WAAO2J,IAAP,CAAY,UAACO,CAAD,EAAIC,CAAJ,EAAU;AACpB,UAAMC,SAAStM,GAAG2L,SAAH,CAAarM,MAAMuB,UAAN,CAAiBuL,CAAjB,KAAuB,CAApC,EAAuC9M,MAAMuB,UAAN,CAAiBwL,CAAjB,KAAuB,CAA9D,CAAf;AACA,aAAOC,WAAW,CAAX,GAAeA,MAAf,GAAwBtM,GAAG2L,SAAH,CAAa,CAACrM,MAAMoB,UAAN,CAAiB0L,CAAjB,KAAuB,EAAxB,EAA4Bd,SAAS,CAAT,CAA5B,KAA4C,CAAzD,EAA4D,CAAChM,MAAMoB,UAAN,CAAiB2L,CAAjB,KAAuB,EAAxB,EAA4Bf,SAAS,CAAT,CAA5B,KAA4C,CAAxG,CAA/B;AACD,KAHD;AAIA,SAAK1H,MAAL,CAAY1B,MAAZ,CAAmBA,MAAnB;AACD,GApc+C;AAschDgG,eAtcgD,2BAschC;AACd,QAAM5I,QAAQ,IAAd;AACA,QAAMiN,QAAQ,KAAKtP,KAAL,CAAWsD,MAAX,CAAkBI,MAAhC;;AAEA;AACA,QAAM6L,aAAahP,OAAOC,IAAP,CAAY,KAAKR,KAAL,CAAWsD,MAAX,CAAkBsB,IAAlB,CAAuB4K,cAAvB,CAAsC,CAAC,KAAKzJ,OAAN,CAAtC,CAAZ,CAAnB;AACA,QAAI,CAACwJ,WAAW7O,MAAhB,EAAwB6O,WAAWV,IAAX,CAAgB,WAAhB;;AAExB,QAAMrO,OAAO,KAAKgH,QAAL,GAAgB,EAAhB,GAAqB,CAAC,KAAKzB,OAAN,CAAlC;AACA,QAAM0J,SAASH,MAAMI,qBAAN,CAA4BlP,KAAKmP,MAAL,CAAY,CAAC,KAAKrK,QAAN,EAAgB,KAAKuF,OAArB,CAAZ,CAA5B,CAAf;AACA,QAAM+E,WAAWN,MAAMO,SAAN,EAAjB;AACA,QAAMC,SAAS,EAAf;AACA,QAAMC,qBAAqB,EAA3B;AACA,QAAMC,YAAY,EAAlB;AACA,QAAIC,YAAJ;AACAV,eAAWrJ,OAAX,CAAmB,aAAK;AACtB8J,gBAAUnK,CAAV,IAAe,EAAf;AACAkK,yBAAmBlK,CAAnB,IAAwB,EAAxB;AACD,KAHD;;AAKA,QAAIxD,MAAMmF,QAAV,EAAoB;AAClB/F,YAAMyE,OAAN,CAAc0J,QAAd,EAAwB,gBAAQ;AAC9BE,eAAOrN,IAAP,IAAe,EAAf;AACA,YAAIyN,WAAW,CAAf;AACA,YAAMC,gBAAgB,EAAtB;AACA1O,cAAMyE,OAAN,CAAc7D,MAAM2L,SAApB,EAA+B,iBAAS;AACtC,cAAIyB,OAAO/E,KAAP,KAAiB+E,OAAO/E,KAAP,EAAcjI,IAAd,CAArB,EAA0C;AACxC,gBAAM2N,MAAMX,OAAO/E,KAAP,EAAcjI,IAAd,EAAoB4N,GAAhC;AACAH,wBAAYE,GAAZ;AACAD,0BAActB,IAAd,CAAmBuB,GAAnB;AACD;AACF,SAND;AAOAN,eAAOrN,IAAP,EAAa8M,WAAW,CAAX,CAAb,IAA8BW,QAA9B;AACA,YAAMI,eAAeC,KAAKF,GAAL,aAAYF,aAAZ,CAArB;AACAJ,2BAAmBR,WAAW,CAAX,CAAnB,EAAkCV,IAAlC,CAAuCyB,eAAeJ,QAAtD;AACAF,kBAAUT,WAAW,CAAX,CAAV,EAAyBV,IAAzB,CAA8ByB,YAA9B;AACD,OAfD;AAgBD,KAjBD,MAiBO;AACL7O,YAAMyE,OAAN,CAAc0J,QAAd,EAAwB,gBAAQ;AAC9BE,eAAOrN,IAAP,IAAe,EAAf;AACAhB,cAAMyE,OAAN,CAAcqJ,UAAd,EAA0B,gBAAQ;AAChC,cAAIW,WAAW,CAAf;AACA,cAAMC,gBAAgB,EAAtB;AACA1O,gBAAMyE,OAAN,CAAc7D,MAAM2L,SAApB,EAA+B,iBAAS;AACtCiC,kBAAMrL,OAAO,GAAP,GAAa8F,KAAnB;AACA,gBAAI+E,OAAOQ,GAAP,KAAeR,OAAOQ,GAAP,EAAYxN,IAAZ,CAAnB,EAAsC;AACpC,kBAAM2N,MAAMX,OAAOQ,GAAP,EAAYxN,IAAZ,EAAkB4N,GAA9B;AACAH,0BAAYE,GAAZ;AACAD,4BAActB,IAAd,CAAmBuB,GAAnB;AACD;AACF,WAPD;AAQAN,iBAAOrN,IAAP,EAAamC,IAAb,IAAqBsL,QAArB;AACA,cAAMI,eAAeC,KAAKF,GAAL,aAAYF,aAAZ,CAArB;AACAJ,6BAAmBnL,IAAnB,EAAyBiK,IAAzB,CAA8ByB,eAAeJ,QAA7C;AACAF,oBAAUpL,IAAV,EAAgBiK,IAAhB,CAAqByB,YAArB;AACD,SAfD;AAgBD,OAlBD;AAmBD;;AAED,SAAKN,SAAL,GAAiB,EAAjB;AACA,SAAKD,kBAAL,GAA0B,EAA1B;AACAR,eAAWrJ,OAAX,CAAmB,aAAK;AACtB7D,YAAM2N,SAAN,CAAgBnK,CAAhB,IAAqB0K,KAAKF,GAAL,gCAAYL,UAAUnK,CAAV,CAAZ,EAArB;AACAxD,YAAM0N,kBAAN,CAAyBlK,CAAzB,IAA8B0K,KAAKF,GAAL,gCAAYN,mBAAmBlK,CAAnB,CAAZ,EAA9B;AACD,KAHD;AAIA,SAAKiK,MAAL,GAAcA,MAAd;AACD,GAxgB+C;AA0gBhDvJ,eA1gBgD,2BA0gBhC;AACd,QAAMlE,QAAQ,IAAd;AACA,QAAMiN,QAAQ,KAAKtP,KAAL,CAAWsD,MAAX,CAAkBI,MAAhC;AACA,QAAM8M,OAAOlB,MAAMmB,SAAN,IAAmB,KAAnB,GAA2B,IAA3B,GAAkC,CAA/C;AACA,QAAIxL,eAAJ;AACA,QAAI,KAAKhE,EAAL,CAAQC,KAAR,CAAcE,SAAlB,EAA6B;AAC3B6D,eAAS,CAACuL,OAAO,IAAR,EAAcD,KAAKF,GAAL,gCAAY,KAAKhC,QAAL,CAAcJ,GAAd,CAAkB;AAAA,eAAK5L,MAAM0N,kBAAN,CAAyBlK,CAAzB,CAAL;AAAA,OAAlB,CAAZ,EAAd,CAAT;AACD,KAFD,MAEO;AACLZ,eAAUqK,MAAMoB,SAAN,IAAmB,IAAnB,IAA2BpB,MAAMqB,SAAN,IAAmB,IAA/C,GAAuD,CAAC,CAACrB,MAAMoB,SAAR,EAAmB,CAACpB,MAAMqB,SAA1B,CAAvD,GAA8F,CAACH,IAAD,EAAOD,KAAKF,GAAL,gCAAY,KAAKhC,QAAL,CAAcJ,GAAd,CAAkB;AAAA,eAAK5L,MAAM2N,SAAN,CAAgBnK,CAAhB,CAAL;AAAA,OAAlB,CAAZ,EAAP,CAAvG;AACD;AACD,SAAKa,MAAL,CAAYzB,MAAZ,CAAmBA,MAAnB;AACA,QAAI,KAAK+J,UAAT,EAAqB,KAAKA,UAAL,CAAgB/J,MAAhB,CAAuB,KAAKyB,MAAL,CAAYzB,MAAZ,EAAvB;AACtB,GAthB+C;AAyhBhD2L,2BAzhBgD,qCAyhBtB3N,SAzhBsB,EAyhBX6M,MAzhBW,EAyhBHrN,IAzhBG,EAyhBG;AACjD,QAAMoO,WAAW9N,GAAGC,UAAH,CAAcC,SAAd,EAAyBR,IAAzB,CAAjB;AACA,QAAMqO,WAAW,CAACrO,OAAOQ,UAAU4N,WAAW,CAArB,CAAR,KAAoC5N,UAAU4N,QAAV,IAAsB5N,UAAU4N,WAAW,CAArB,CAA1D,CAAjB;AACA,QAAMtH,QAAQ,EAAd;AACA9H,UAAMyE,OAAN,CAAc,KAAKmI,QAAnB,EAA6B,gBAAQ;AACnC9E,YAAM3E,IAAN,IAAckL,OAAO7M,UAAU4N,QAAV,CAAP,EAA4BjM,IAA5B,IAAoCkM,QAApC,GAA+ChB,OAAO7M,UAAU4N,WAAW,CAArB,CAAP,EAAgCjM,IAAhC,KAAyC,IAAIkM,QAA7C,CAA7D;AACH,KAFC;AAGA,WAAOvH,KAAP;AACD,GAjiB+C;;;AAmiBhD;;;AAGAxF,iBAtiBgD,2BAsiBhCgN,OAtiBgC,EAsiBvB;AACvB,QAAM1O,QAAQ,IAAd;AACA,QAAMI,OAAO,KAAKzC,KAAL,CAAWyC,IAAxB;AACA,QAAMiC,UAAU,KAAKqB,OAArB;AACA,QAAMiL,kBAAkB,KAAKxH,eAA7B;AACA,QAAMrC,WAAW,KAAK7B,QAAtB;AACA,QAAM2L,mBAAmB,KAAKrG,gBAA9B;AACA,QAAMsG,UAAU,KAAKrG,OAArB;AACA,QAAM6C,WAAYjL,KAAKG,OAAN,GAAiBH,KAAKkL,eAAtB,GAAwC,CAAzD;AACA,QAAIpE,cAAJ;;AAEA,QAAI,KAAKtI,EAAL,CAAQC,KAAR,CAAcE,SAAlB,EAA6B;AAC3B,WAAKmI,KAAL,GAAa,KAAKuG,MAAL,CAAYrN,KAAKS,KAAjB,IAA0B,KAAK4M,MAAL,CAAYrN,KAAKS,KAAjB,CAA1B,GAAoD,KAAK0N,yBAAL,CAA+B,KAAK3N,SAApC,EAA+C,KAAK6M,MAApD,EAA4DrN,KAAKS,KAAjE,CAAjE;AACD;;AAED,QAAM+B,SAAS,KAAK0B,MAAL,CAAY1B,MAAZ,EAAf;;AAEA,QAAMkM,YAAY,KAAKjG,OAAL,CAAakG,KAAb,CAAmB,CAAnB,CAAlB;;AAEA,SAAKC,UAAL,GAAkB,KAAK9I,IAAL,CAAU+C,SAAV,CAAoB,aAApB,EACbC,IADa,CACR4F,SADQ,EACG;AAAA,aAAKjI,EAAE/B,QAAF,CAAL;AAAA,KADH,CAAlB;AAEA;AACA,SAAKkK,UAAL,CAAgBC,IAAhB,GAAuBC,MAAvB;;AAEA,QAAMC,YAAY,KAAKA,SAAvB;AACA,QAAMC,kBAAkB,KAAKA,eAA7B;;AAEA;AACA,SAAKJ,UAAL,GAAkB,KAAKA,UAAL,CAAgB7F,KAAhB,GAAwBC,MAAxB,CAA+B,GAA/B,EACfhD,IADe,CACV,OADU,EACD;AAAA,aAAK,gBAAgB,aAAhB,GAAgCS,EAAE/B,QAAF,CAArC;AAAA,KADC,EAEfsB,IAFe,CAEV,WAFU,EAEG,UAACS,CAAD,EAAIC,CAAJ;AAAA,aAAU,kBAAkBsI,kBAAkBpP,MAAMsE,MAAN,CAAauC,EAAE/B,QAAF,CAAb,CAApC,IAAiE,GAA3E;AAAA,KAFH,EAGfuK,KAHe,CAGT,KAAKL,UAHI,CAAlB;;AAKA,QAAMrI,qBAAqB,KAAKA,kBAAhC;;AAEA,SAAK2I,QAAL,GAAgB,KAAKN,UAAL,CAAgB/F,SAAhB,CAA0B,cAA1B,EAA0CC,IAA1C,CAA+C;AAAA,aAAKlJ,MAAMgM,QAAN,CAAeJ,GAAf,CAAmB,aAAK;AACxF,YAAM2D,IAAI,EAAV;AACJA,UAAEzK,QAAF,IAAc+B,EAAE/B,QAAF,CAAd;AACAyK,UAAEZ,eAAF,IAAqB9C,CAArB;AACA0D,UAAElN,OAAF,IAAawJ,CAAb;AACA,eAAO0D,CAAP;AACD,OANqE,CAAL;AAAA,KAA/C,EAMd;AAAA,aAAK1I,EAAE8H,eAAF,CAAL;AAAA,KANc,CAAhB;;AAQA,SAAKW,QAAL,CAAcL,IAAd,GAAqBC,MAArB;AACA,SAAKI,QAAL,GAAgB,KAAKA,QAAL,CAAcnG,KAAd,GAAsBC,MAAtB,CAA6B,GAA7B,EACbhD,IADa,CACR,OADQ,EACC,UAACS,CAAD,EAAIC,CAAJ;AAAA,aAAU,iBAAiB,cAAjB,IAAmC,CAACA,CAAD,IAAM,CAAC9G,MAAMyM,QAAb,GAAwB,OAAxB,GAAkC,MAArE,CAAV;AAAA,KADD,EAEb+C,IAFa,CAER,UAACC,OAAD,EAAa;AACjBA,cAAQrG,MAAR,CAAe,MAAf,EACGhD,IADH,CACQ,OADR,EACiB,UAACS,CAAD,EAAIC,CAAJ;AAAA,eAAU,kBAAkB,eAAlB,GAAoCA,CAApC,IAAyC9G,MAAM0P,WAAN,GAAoB,aAApB,GAAoC,EAA7E,CAAV;AAAA,OADjB,EAEGtJ,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,QAHR,EAGkB+I,SAHlB,EAIG/I,IAJH,CAIQ,MAJR,EAIgBO,mBAAmBgB,SAJnC,EAKGvB,IALH,CAKQ,OALR,EAKiBO,mBAAmBC,SALpC,EAMGR,IANH,CAMQ,GANR,EAMaO,mBAAmBU,KANhC,EAOGX,EAPH,CAOM,WAPN,EAOmB1G,MAAMuF,WAAN,CAAkBoK,SAPrC,EAQGjJ,EARH,CAQM,UARN,EAQkB1G,MAAMuF,WAAN,CAAkBqK,QARpC,EASGlJ,EATH,CASM,OATN,EASe1G,MAAMuF,WAAN,CAAkBsK,KATjC,EAUGC,KAVH,CAUS9P,MAAMuF,WAAN,CAAkBwK,GAV3B;AAWD,KAda,EAebV,KAfa,CAeP,KAAKC,QAfE,CAAhB;;AAiBA,QAAIZ,OAAJ,EAAa;AACX,WAAKY,QAAL,CAAclJ,IAAd,CAAmB,WAAnB,EAAgC,UAACS,CAAD,EAAIC,CAAJ;AAAA,eAAUA,IAAK,2BAA2B9G,MAAMgQ,aAAN,CAAoBC,WAA/C,GAA6D,KAAlE,GAA2E,EAArF;AAAA,OAAhC;AACD;;AAED,SAAKnB,SAAL,GAAiB,KAAKQ,QAAL,CAAcrG,SAAd,CAAwB,eAAxB,CAAjB;;AAEA,QAAIyF,OAAJ,EAAa,KAAKI,SAAL,CACV1I,IADU,CACL,MADK,EACGO,mBAAmBgB,SADtB;;AAGb,QAAI0D,QAAJ,EAAc;AACZ,UAAM6E,aAAaxP,GAAGwP,UAAH,GAChB7E,QADgB,CACPA,QADO,EAEhB8E,IAFgB,CAEXzP,GAAG0P,UAFQ,CAAnB;;AAIA,WAAKpB;AACH;AADF,OAEG5I,IAFH,CAEQ,WAFR,EAEqB,UAACS,CAAD,EAAIC,CAAJ;AAAA,eAAU,kBAAkBsI,kBAAkBpP,MAAMsE,MAAN,CAAauC,EAAE/B,QAAF,CAAb,CAApC,IAAiE,GAA3E;AAAA,OAFrB;AAGA,WAAKgK,SAAL,CACGoB,UADH,CACcA,UADd,EAEG9J,IAFH,CAEQ,OAFR,EAEiBO,mBAAmBC,SAFpC,EAGGR,IAHH,CAGQ,GAHR,EAGaO,mBAAmBU,KAHhC;AAID,KAZD,MAYO;AACL,WAAK2H,UAAL,CAAgBqB,SAAhB,GACGjK,IADH,CACQ,WADR,EACqB,UAACS,CAAD,EAAIC,CAAJ;AAAA,eAAU,kBAAkBsI,kBAAkBpP,MAAMsE,MAAN,CAAauC,EAAE/B,QAAF,CAAb,CAApC,IAAiE,GAA3E;AAAA,OADrB;AAEA,WAAKgK,SAAL,CAAeuB,SAAf,GACGjK,IADH,CACQ,OADR,EACiBO,mBAAmBC,SADpC,EAEGR,IAFH,CAEQ,GAFR,EAEaO,mBAAmBU,KAFhC;AAGD;;AAED,QAAIgE,QAAJ,EAAc;AACZ,WAAK9E,IAAL,CAAU2J,UAAV,GAAuB7E,QAAvB,CAAgCA,QAAhC,EAA0C8E,IAA1C,CAA+CzP,GAAG0P,UAAlD,EACG1J,EADH,CACM,KADN,EACa,KAAK4J,QAAL,CAAclQ,KAAKS,KAAnB,CADb;AAED,KAHD,MAGO;AACL,WAAK0F,IAAL,CAAU8J,SAAV,GAAsBxD,IAAtB,CAA2BzM,KAAKmQ,UAAL,CAAgBnQ,KAAKS,KAArB,CAA3B,EAAwDqP,UAAxD;AACD;AACF,GAtoB+C;AAwoBhDI,UAxoBgD,oBAwoBvCE,SAxoBuC,EAwoB5B;AAClB,QAAMC,gBAAgB,KAAK9S,KAAL,CAAWyC,IAAX,CAAgBmQ,UAAhB,CAA2BC,SAA3B,CAAtB;AACA,WAAO,YAAW;AAAE9P,SAAGsB,MAAH,CAAU,IAAV,EAAgB6K,IAAhB,CAAqB4D,aAArB;AAAsC,KAA1D;AACD,GA3oB+C;AA6oBhDjL,cA7oBgD,0BA6oBjC;AACb,QAAMxF,QAAQ,IAAd;AACA,WAAO;AACL2P,eADK,qBACK9I,CADL,EACQC,CADR,EACW;AACd,YAAI1H,MAAMsR,aAAN,EAAJ,EAA2B;AAC3B1Q,cAAMrC,KAAN,CAAYsD,MAAZ,CAAmB0P,eAAnB,CAAmC9J,CAAnC;AACA;AACD,OALI;AAML+I,cANK,oBAMI/I,CANJ,EAMOC,CANP,EAMU;AACb,YAAI1H,MAAMsR,aAAN,EAAJ,EAA2B;AAC3B1Q,cAAMrC,KAAN,CAAYsD,MAAZ,CAAmB2P,gBAAnB;AACD,OATI;AAULf,WAVK,iBAUChJ,CAVD,EAUIC,CAVJ,EAUO;AACV,YAAI1H,MAAMsR,aAAN,EAAJ,EAA2B;AAC3B1Q,cAAMrC,KAAN,CAAYsD,MAAZ,CAAmB4P,YAAnB,CAAgChK,CAAhC;AACD,OAbI;AAcLkJ,SAdK,eAcDlJ,CAdC,EAcE;AACLnG,WAAGoQ,KAAH,CAASC,eAAT;AACA/Q,cAAMrC,KAAN,CAAYsD,MAAZ,CAAmB4P,YAAnB,CAAgChK,CAAhC;AACD;AAjBI,KAAP;AAmBD,GAlqB+C;AAoqBhD3E,gBApqBgD,0BAoqBjC2E,CApqBiC,EAoqB9B;AAChB,QAAM7G,QAAQ,IAAd;;AAEAA,UAAMgR,eAAN,GAAyBhR,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBgQ,SAAnB,CAA6B5S,MAA7B,GAAsC,CAA/D;;AAEA2B,UAAM2B,iBAAN;;AAEA,QAAI,CAAC3B,MAAMgR,eAAX,EAA4B;AAC1B;AACAhR,YAAMmG,MAAN,CAAa8C,SAAb,CAAuB,cAAvB,EAAuCyD,OAAvC,CAA+C,aAA/C,EAA8D,KAA9D;AACD,KAHD,MAGO;AACL1M,YAAMkR,UAAN,CAAiBlR,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBgQ,SAAnB,CAA6B,CAA7B,CAAjB;AACD;AACF,GAjrB+C;AAmrBhDC,YAnrBgD,sBAmrBrCrK,CAnrBqC,EAmrBlC;AACZ,QAAI,CAAC,KAAK1F,KAAV,EAAiB;;AAEjB,QAAMnB,QAAQ,IAAd;AACA,QAAMmR,YAAYnR,MAAMpB,EAAN,CAASC,KAAT,CAAeE,SAAf,GAA2B2B,GAAG0Q,MAAH,CAAU,KAAV,CAA3B,GAA8CpR,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBI,MAAnB,CAA0BoK,gBAA1B,EAAhE;AACA,QAAMpJ,UAAUrC,MAAM0D,OAAtB;AACA,QAAMoB,WAAW9E,MAAMiD,QAAvB;AACA,QAAMgE,OAAO,KAAKA,IAAlB;;AAEA,QAAMkE,OAAOnL,MAAMgM,QAAN,CAAenK,OAAf,CAAuBgF,EAAExE,OAAF,CAAvB,CAAb;AACA,QAAMgP,QAAQrR,MAAMmG,MAAN,CAAanE,MAAb,CAAoB,eAApB,CAAd;AACA,QAAMsP,MAAMtR,MAAMkG,IAAN,CAAWlE,MAAX,CAAkB,iBAAiB6E,EAAE/B,QAAF,CAAnC,CAAZ;AACAuM,UAAMjL,IAAN,CAAW,WAAX,EAAwBkL,IAAIlL,IAAJ,CAAS,WAAT,CAAxB,EACGpE,MADH,CACU,eADV,EAEG6K,IAFH,CAEQ,oBAAY;AAChB,UAAIA,OAAO7M,MAAMmB,KAAN,CAAYoQ,WAAZ,CAAwB1K,EAAE/B,QAAF,CAAxB,CAAX;AACA+H,aAAO7M,MAAMyM,QAAN,GAAiBI,IAAjB,GAAwBA,OAAO,GAAP,GAAa7M,MAAMwR,UAAN,CAAiB3K,EAAE/B,QAAF,CAAjB,CAA5C;AACA,UAAMoC,QAAQlH,MAAMpB,EAAN,CAASC,KAAT,CAAeE,SAAf,GAA2BiB,MAAMkH,KAAN,CAAYL,EAAExE,OAAF,CAAZ,CAA3B,GAAqD,CAAnE;AACA,UAAMxB,QAAQb,MAAMoB,UAAN,CAAiBhC,MAAM4H,MAAN,CAAaH,CAAb,EAAgBI,IAAhB,CAAjB,IAA0CC,KAAxD;AACA,aAAO2F,OAAO,IAAP,GAAcsE,UAAUtQ,KAAV,CAArB;AACD,KARH,EASGuF,IATH,CASQ,GATR,EASa,CAAC+E,OAAO,CAAC,CAAR,GAAY,CAAb,KAAmBnL,MAAMgQ,aAAN,CAAoBC,WAApB,GAAkC,GAAlC,GAAwC,CAA3D,CATb,EAUGvD,OAVH,CAUW,eAVX,EAU4BvB,IAV5B;;AAYAkG,UAAM3E,OAAN,CAAc,aAAd,EAA6B,IAA7B;AACD,GA5sB+C;;;AA8sBhD;;;;;AAMA+E,8BAA4B;AAC1BC,YAAQ;AACNC,cAAQ,EAAEC,OAAO,EAAT,EAAaC,QAAQ,EAArB,EADF;AAENC,oBAAc;AAFR,KADkB;AAK1BC,WAAO;AACLJ,cAAQ,EAAEK,KAAK,GAAP,EAAYJ,OAAO,GAAnB,EAAwBzG,MAAM,GAA9B,EAAmC0G,QAAQ,EAA3C,EADH;AAELC,oBAAc;AAFT;AALmB,GAptBoB;;AA+tBhDG,YAAU;AACR,aAAS;AACPN,cAAQ;AACNK,aAAK,EADC;AAENJ,eAAO,EAFD;AAGNzG,cAAM,EAHA;AAIN0G,gBAAQ;AAJF,OADD;AAOPC,oBAAc,EAPP;AAQP7B,mBAAa,CARN;AASPiC,qBAAe;AATR,KADD;AAYR,cAAU;AACRP,cAAQ;AACNK,aAAK,EADC;AAENJ,eAAO,EAFD;AAGNzG,cAAM,EAHA;AAIN0G,gBAAQ;AAJF,OADA;AAORC,oBAAc,EAPN;AAQR7B,mBAAa,CARL;AASRiC,qBAAe;AATP,KAZF;AAuBR,aAAS;AACPP,cAAQ;AACNK,aAAK,GADC;AAENJ,eAAO,EAFD;AAGNzG,cAAM,EAHA;AAIN0G,gBAAQ;AAJF,OADD;AAOPC,oBAAc,EAPP;AAQP7B,mBAAa,CARN;AASPiC,qBAAe;AATR;AAvBD,GA/tBsC;;AAmwBhD/N,QAnwBgD,oBAmwBvC;;AAEP,QAAMnE,QAAQ,IAAd;;AAEA,SAAKgQ,aAAL,GAAqB,KAAKmC,gBAAL,CAAsB,KAAKF,QAA3B,EAAqC,KAAKR,0BAA1C,CAArB;;AAEA,QAAME,SAAS,KAAK3B,aAAL,CAAmB2B,MAAlC;AACA,QAAMG,eAAe,KAAK9B,aAAL,CAAmB8B,YAAxC;;AAEA;AACA,SAAKnH,MAAL,GAAeyH,SAAS,KAAK9M,OAAL,CAAayE,KAAb,CAAmB,QAAnB,CAAT,EAAuC,EAAvC,IAA6C4H,OAAOK,GAApD,GAA0DL,OAAOE,MAAlE,IAA6E,CAA3F;AACA,SAAK9K,KAAL,GAAcqL,SAAS,KAAK9M,OAAL,CAAayE,KAAb,CAAmB,OAAnB,CAAT,EAAsC,EAAtC,IAA4C4H,OAAOxG,IAAnD,GAA0DwG,OAAOC,KAAlE,IAA4E,CAAzF;;AAEA,QAAI,KAAKjH,MAAL,IAAe,CAAf,IAAoB,KAAK5D,KAAL,IAAc,CAAtC,EAAyC,OAAO3H,MAAMiT,IAAN,CAAW,+EAAX,CAAP;;AAEzC,SAAK5M,KAAL,CACGW,IADH,CACQ,WADR,EACqB,eAAeuL,OAAOxG,IAAtB,GAA6B,GAA7B,GAAmCwG,OAAOK,GAA1C,GAAgD,GADrE;;AAGA,SAAKhM,QAAL,CACGI,IADH,CACQ,OADR,EACiB,KAAKW,KADtB,EAEGX,IAFH,CAEQ,QAFR,EAEkB8H,KAAKF,GAAL,CAAS,CAAT,EAAY,KAAKrD,MAAjB,CAFlB;;AAIA,SAAK1E,UAAL,CACGG,IADH,CACQ,OADR,EACiB,KAAKW,KADtB,EAEGX,IAFH,CAEQ,QAFR,EAEkB8H,KAAKF,GAAL,CAAS,CAAT,EAAY,KAAKrD,MAAjB,CAFlB;;AAIA,QAAM/H,SAAS,KAAK0B,MAAL,CAAY1B,MAAZ,EAAf;AACA;AACA,QAAMuM,YAAY,KAAKA,SAAL,GAAiB,KAAKxR,KAAL,CAAWsD,MAAX,CAAkBqH,MAAlB,CAAyB8F,SAAzB,IAAsC,SAAtC,GAAkD,KAAKzD,MAAL,GAAc/H,OAAOvE,MAAvE,GAAgF,KAAKsM,MAAL,GAAcuD,KAAKoE,GAAL,CAAS1P,OAAO,CAAP,IAAYA,OAAO,CAAP,CAArB,CAAjI;AACA,SAAKwM,eAAL,GAAuB,KAAKzE,MAAL,GAAc,KAAKwE,SAA1C;;AAEA,QAAI,KAAKL,SAAT,EAAoB,KAAKA,SAAL,CAAe1I,IAAf,CAAoB,QAApB,EAA8B+I,SAA9B;;AAEpB,QAAI,KAAKG,QAAT,EAAmB,KAAKA,QAAL,CAChBlJ,IADgB,CACX,WADW,EACE,UAACS,CAAD,EAAIC,CAAJ;AAAA,aAAUA,IAAK,2BAA2B9G,MAAMgQ,aAAN,CAAoBC,WAA/C,GAA6D,KAAlE,GAA2E,EAArF;AAAA,KADF;;AAGnB;AACA,SAAK3L,MAAL,CAAYiO,KAAZ,CAAkB,CAAC,KAAK5H,MAAN,EAAc,CAAd,CAAlB;;AAEA,QAAM6H,WAAW,KAAK/F,QAAL,GAAiB,CAAC,KAAK1F,KAAL,GAAa,KAAKiJ,aAAL,CAAmBC,WAAjC,IAAgD,GAAjE,GAAwE,KAAKlJ,KAA9F;;AAEA,SAAK1C,MAAL,CAAYkO,KAAZ,CAAkB,CAAC,CAAD,EAAIC,QAAJ,CAAlB;;AAEA;AACA,SAAK9N,KAAL,CAAW+N,KAAX,CAAiB,KAAKnO,MAAtB,EACGoO,UADH,CACc,EADd,EAEGC,aAFH,CAEiB,CAAC,KAAK5L,KAFvB,EAGG6L,aAHH,CAGiB,CAHjB,EAIGC,WAJH,CAIe,CAJf,EAKGC,aALH,CAKiB,CAAC,KAAK/L,KALvB,EAK8B,CAL9B,EAMGgM,cANH,CAMkB;AACd3E,iBAAW,KAAKzQ,KAAL,CAAWsD,MAAX,CAAkBqH,MAAlB,CAAyB8F,SADtB;AAEd4E,kBAAYrB,MAFE;AAGdsB,0BAAoB;AAHN,KANlB;;AAYA,QAAM7B,SAAS,KAAKxS,EAAL,CAAQC,KAAR,CAAcE,SAAd,GAA0B2B,GAAG0Q,MAAH,CAAU,KAAV,CAA1B,GAA6C,KAAKzT,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyBoK,gBAAzB,EAA5D;;AAEA,SAAKjH,KAAL,CAAWiO,KAAX,CAAiB,KAAKpO,MAAtB,EACGmH,UADH,CACc4F,MADd,EAEGuB,aAFH,CAEiB,CAAC,KAAKhI,MAFvB,EAGGiI,aAHH,CAGiB,CAHjB,EAIGC,WAJH,CAIe,CAJf,EAKGC,aALH,CAKiB,CAAC,KAAKnI,MALvB,EAK+B,CAL/B,EAMGoI,cANH,CAMkB;AACd3E,iBAAW,KAAKzQ,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyB+M,SADtB;AAEd4E,kBAAYrB,MAFE;AAGdsB,0BAAoB;AAHN,KANlB;;AAYA,QAAMC,aAAa,KAAKzG,QAAL,GAAiB,CAAC,KAAK1F,KAAL,GAAa/G,MAAMgQ,aAAN,CAAoBC,WAAlC,IAAiD,GAAlE,GAAyE,CAA5F;;AAEA,SAAKtK,OAAL,CAAaS,IAAb,CAAkB,WAAlB,EAA+B,eAAe8M,UAAf,GAA4B,GAA5B,GAAkC,KAAKvI,MAAvC,GAAgD,GAA/E,EACG6E,IADH,CACQ,KAAKhL,KADb;;AAGA,SAAKkB,OAAL,CAAaU,IAAb,CAAkB,WAAlB,EAA+B,eAAe,CAAf,GAAmB,KAAlD,EACGoJ,IADH,CACQ,KAAK9K,KADb;AAEA;AACA,SAAKkB,WAAL,CAAiB8G,OAAjB,CAAyB,YAAzB,EAAuC,CAAC,KAAKD,QAA7C;AACA,QAAI,KAAKA,QAAT,EAAmB;AACjB,UAAI,KAAK9O,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyB+M,SAAzB,KAAuC,SAA3C,EAAsD;AACpD,aAAKzB,UAAL,CAAgB4F,KAAhB,CAAsB,CAAC,CAAC,KAAKxL,KAAL,GAAa,KAAKiJ,aAAL,CAAmBC,WAAjC,IAAgD,GAAjD,EAAsD,CAAtD,CAAtB;AACD,OAFD,MAEO;AACL,aAAKtD,UAAL,CAAgBwG,WAAhB,CAA4B,CAAC,CAAC,KAAKpM,KAAL,GAAa,KAAKiJ,aAAL,CAAmBC,WAAjC,IAAgD,GAAjD,EAAsD,CAAtD,CAA5B,EAAsFsC,KAAtF;AACD;;AAED,WAAK9N,SAAL,CAAegO,KAAf,CAAqB,KAAK9F,UAA1B,EACGnB,UADH,CACc4F,MADd,EAEGuB,aAFH,CAEiB,CAAC,KAAKhI,MAFvB,EAGGiI,aAHH,CAGiB,CAHjB,EAIGC,WAJH,CAIe,CAJf,EAKGC,aALH,CAKiB,CAAC,KAAKnI,MALvB,EAK+B,CAL/B,EAMGoI,cANH,CAMkB;AACd3E,mBAAW,KAAKzQ,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyB+M,SADtB;AAEd4E,oBAAYrB,MAFE;AAGdsB,4BAAoB;AAHN,OANlB;;AAYA,WAAKrN,WAAL,CAAiBQ,IAAjB,CAAsB,WAAtB,EAAmC,iBAAiB,KAAKuE,MAAtB,GAA+B,GAAlE,EACG6E,IADH,CACQ,KAAK/K,SADb;AAEA,UAAM2O,aAAa,KAAKzN,OAAL,CAAa3D,MAAb,CAAoB,YAApB,CAAnB;AACA,UAAI,CAACoR,WAAWC,KAAX,EAAL,EAAyB;AACvB,YAAMC,gBAAgBF,WAAWpI,IAAX,GAAkBX,OAAlB,GAA4BtD,KAAlD;AACAqM,mBAAWhN,IAAX,CAAgB,IAAhB,EAAsB,EAAE,KAAK4J,aAAL,CAAmBC,WAAnB,GAAiCqD,aAAnC,IAAoD,GAA1E;AACD;AACD,WAAK3N,OAAL,CAAa3D,MAAb,CAAoB,YAApB,EAAkC0K,OAAlC,CAA0C,YAA1C,EAAwD,IAAxD;;AAEA;AACA,UAAM6G,YAAY,KAAK3N,WAAL,CAAiBqD,SAAjB,CAA2B,OAA3B,EAAoCuK,KAApC,EAAlB;AACA9S,SAAGsB,MAAH,CAAUuR,UAAUA,UAAUlV,MAAV,GAAmB,CAA7B,CAAV,EAA2CqO,OAA3C,CAAmD,YAAnD,EAAiE,IAAjE;AACF;;AAEA,QAAMjD,QAAQ,KAAK9L,KAAL,CAAWuB,MAAX,CAAkBuK,KAAlB,EAAd;;AAEA,SAAKvD,IAAL,CAAUE,IAAV,CAAe,WAAf,EAA4B,eAAe8M,UAAf,GAA4B,KAAxD;AACA,SAAK/M,MAAL,CAAYC,IAAZ,CAAiB,WAAjB,EAA8B,eAAe8M,UAAf,GAA4B,KAA1D;;AAEA,SAAK7M,KAAL,CACGD,IADH,CACQ,GADR,EACauL,OAAOxG,IAAP,IAAe,KAAKsB,QAAL,GAAgByG,aAAa,KAAKlD,aAAL,CAAmBkC,aAAhD,GAAgE,CAA/E,CADb,EAEGnI,KAFH,CAES,aAFT,EAEwB,KAAK0C,QAAL,GAAgB,KAAhB,GAAwB,EAFhD,EAGGrG,IAHH,CAGQ,GAHR,EAGauL,OAAOK,GAAP,GAAa,GAH1B;AAIA,SAAK1L,UAAL,CACGF,IADH,CACQ,GADR,EACauL,OAAOxG,IAAP,GAAc+H,UAAd,GAA2B,KAAKlD,aAAL,CAAmBkC,aAD3D,EAEG9L,IAFH,CAEQ,GAFR,EAEauL,OAAOK,GAAP,GAAa,GAF1B;;AAIA,SAAKnM,QAAL,CACGkE,KADH,CACS,WADT,EACsB+H,eAAe,IADrC,EAEG1L,IAFH,CAEQ,WAFR,EAEqB,gBAAgBqD,QAAQ,KAAK1C,KAAb,GAAqB4K,OAAOxG,IAAP,GAAc,GAAnD,IAA0D,GAA1D,GAAiEwG,OAAOK,GAAP,GAAa,GAA9E,GAAqF,GAF1G;AAGA,SAAKnM,QAAL,CAAc7D,MAAd,CAAqB,MAArB,EAA6B6K,IAA7B,CAAkC,KAAKlP,KAAL,CAAWsD,MAAX,CAAkBI,MAAlB,CAAyBqB,eAAzB,GAA2ClF,IAA7E;;AAEA,QAAI,KAAKsI,OAAL,CAAa9D,MAAb,CAAoB,KAApB,EAA2BgJ,IAA3B,EAAJ,EAAuC;AACrC,UAAMyI,YAAY,KAAK5N,QAAL,CAAcmF,IAAd,GAAqBX,OAArB,EAAlB;AACA,UAAMqJ,IAAItU,MAAMuU,SAAN,CAAgB,KAAK9N,QAAL,CAAcmF,IAAd,EAAhB,CAAV;AACA,UAAM4I,aAAanK,QAASgK,UAAUhJ,CAAV,GAAciJ,EAAER,UAAhB,GAA6BpB,eAAe,GAArD,GAA6D2B,UAAUhJ,CAAV,GAAciJ,EAAER,UAAhB,GAA6BO,UAAU1M,KAAvC,GAA+C+K,eAAe,GAA9I;;AAEA,WAAKhM,OAAL,CAAa9D,MAAb,CAAoB,KAApB,EACGoE,IADH,CACQ,OADR,EACiB0L,eAAe,IADhC,EAEG1L,IAFH,CAEQ,QAFR,EAEkB0L,eAAe,IAFjC;AAGA,WAAKhM,OAAL,CAAaM,IAAb,CAAkB,WAAlB,EAA+B,eAC3BwN,UAD2B,GACd,GADc,IAE1BF,EAAEG,UAAF,GAAe/B,eAAe,GAFJ,IAEW,GAF1C;AAGD;;AAGD,SAAKvL,IAAL,CAAUH,IAAV,CAAe,GAAf,EAAoB,KAAKW,KAAL,GAAa4K,OAAOxG,IAAxC,EAA8C/E,IAA9C,CAAmD,GAAnD,EAAwDuL,OAAOK,GAAP,GAAa,GAArE;AAED,GAr5B+C;AAu5BhDrQ,mBAv5BgD,6BAu5B9B0J,QAv5B8B,EAu5BpB;AAC1B,QAAMrL,QAAQ,IAAd;AACA;;AAEA,QAAM8T,iBAAiB,GAAvB;AACA,QAAMC,qBAAqB,KAAKpW,KAAL,CAAWsD,MAAX,CAAkB+S,mBAA7C;AACA,QAAMC,iBAAiB,GAAvB;AACA,QAAMC,kBAAkB,KAAKvW,KAAL,CAAWsD,MAAX,CAAkBkT,cAA1C;AACA,QAAMC,qBAAqB,KAAKzW,KAAL,CAAWsD,MAAX,CAAkBoT,gBAA7C;;AAEA,SAAKvF;AACL;AADA,KAEG/E,KAFH,CAES,SAFT,EAEoB,aAAK;;AAErB,UAAI/J,MAAMgR,eAAV,EAA2B;AACzB;AACA,YAAIhR,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBqT,aAAnB,CAAiCzN,CAAjC,CAAJ,EAAyC,OAAOiN,cAAP;AAC1C;;AAED,UAAI9T,MAAM+B,YAAV,EAAwB;AACtB;AACA,eAAO/B,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsT,UAAnB,CAA8B1N,CAA9B,IAAmCoN,cAAnC,GAAoDG,kBAA3D;AACD;;AAED,UAAIpU,MAAMgR,eAAV,EAA2B,OAAO+C,kBAAP;;AAE3B,aAAOG,eAAP;AACD,KAjBH;;AAmBA,SAAKpF,SAAL,CAAe/E,KAAf,CAAqB,QAArB,EAA+B;AAAA,aAAK/J,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsT,UAAnB,CAA8B1N,CAA9B,IAAmC,MAAnC,GAA4C,IAAjD;AAAA,KAA/B;;AAEA,QAAM5E,yBAAyBjC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBoT,gBAAnB,GAAsC,IAArE;;AAEA;AACA,QAAIpS,0BAA0B,KAAKA,sBAAnC,EAA2D;AACzD,WAAK6M,SAAL,CAAe/E,KAAf,CAAqB,gBAArB,EAAuC;AAAA,eAAM,CAAC/J,MAAM+B,YAAP,IAAuB,CAACE,sBAAxB,IAAkDjC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBsT,UAAnB,CAA8B1N,CAA9B,CAAnD,GAC1C,SAD0C,GAC9B,MADyB;AAAA,OAAvC;AAED;;AAED,SAAK5E,sBAAL,GAA8BjC,MAAMrC,KAAN,CAAYsD,MAAZ,CAAmBoT,gBAAnB,GAAsC,IAApE;AACD;AA/7B+C,CAA/B,CAAnB;;kBAm8BepX,U;;;;;;AC/8Bf,yC;;;;;;ACAA,wmC","file":"barchart-ds.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f58c412da383836e7a47","import \"./styles.scss\";\nimport component from \"./component\";\n\nconst VERSION_INFO = { version: __VERSION, build: __BUILD };\n\n//BAR CHART TOOL\nconst BarChartDS = Vizabi.Tool.extend(\"BarChartDS\", {\n\n  /**\n   * Initializes the tool (Bar Chart Tool).\n   * Executed once before any template is rendered.\n   * @param {Object} placeholder Placeholder element for the tool\n   * @param {Object} external_model Model as given by the external page\n   */\n  init(placeholder, external_model) {\n\n    this.name = \"barchartds\";\n\n    //specifying components\n    this.components = [{\n      component,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.marker\", \"state.marker_order\", \"state.entities\", \"state.entities_side\", \"state.entities_allpossible\", \"state.entities_geodomain\", \"locale\", \"ui\"] //pass models to component\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.marker_tags\", \"state.time\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    //constructor is the same as any tool\n    this._super(placeholder, external_model);\n  },\n\n  validate(model) {\n    model = this.model || model;\n\n    this._super(model);\n\n    //validate on first model set only\n    if (!this.model) {\n      const entities = model.state.entities;\n      if (Object.keys(entities.show).length > 0) {\n        const show = {};\n        if (entities.show[entities.dim] && Object.keys(entities.show).length !== 1) {\n          show[entities.dim] = entities.show[entities.dim];\n        }\n        if (!entities.show[entities.dim] || !(Object.keys(entities.show).length == 1)) {\n          entities.show = show;\n        }\n      }\n\n      const entities_geodomain = model.state.entities_geodomain;\n      entities_geodomain.skipFilter = model.state.entities.dim === entities_geodomain.dim ||\n        model.state.entities_side.dim === entities_geodomain.dim;\n    }\n  },\n\n  default_model: {\n    state: {\n      marker_tags: {}\n    },\n    ui: {\n      chart: {\n        stacked: true,\n        inpercent: false,\n        flipSides: true\n      },\n      \"buttons\": [\"colors\", \"inpercent\", \"find\", \"side\", \"moreoptions\", \"fullscreen\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"find\", \"side\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"find\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"colors\", \"side\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    },\n    locale: { }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\nexport default BarChartDS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const {\n  utils,\n  Component,\n  helpers: {\n    \"d3.axisWithLabelPicker\": axisSmart\n  },\n  iconset: {\n    question: iconQuestion\n  },\n} = Vizabi;\n\n// BARCHARTDS  CHART COMPONENT\nconst BarChartDS = Component.extend(\"barchartds\", {\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init(config, context) {\n    this.name = \"barchartds\";\n    this.template = require(\"./template.html\");\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"marker_order\",\n      type: \"marker\"\n    }, {\n      name: \"entities\",\n      type: \"entities\"\n    }, {\n      name: \"entities_side\",\n      type: \"entities\"\n    }, {\n      name: \"entities_allpossible\",\n      type: \"entities\"\n    }, {\n      name: \"entities_geodomain\",\n      type: \"entities\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    const _this = this;\n    this.model_binds = {\n      \"change:time.value\": function(evt) {\n        if (!_this._readyOnce) return;\n        if (_this.model.time.step != 1 && !_this.snapped && !_this.model.time.playing && !_this.model.time.dragging) {\n          let next = d3.bisectLeft(_this.timeSteps, _this.model.time.value);\n          if (next != 0 && (_this.timeSteps[next] - _this.model.time.value)) {\n            _this.snapped = true;\n            const time = _this.model.time.value;\n            const prev = _this.timeSteps[next - 1];\n            next = _this.timeSteps[next];\n            const snapTime = (time - prev) < (next - time) ? prev : next;\n            _this.model.time.value = new Date(snapTime);\n          }\n        }\n        if (!_this.snapped) {\n//          if (_this.timeSteps.filter(t => (t - _this.model.time.value) == 0).length) {\n            _this.model.marker.getFrame(_this.model.time.value, frame => {\n              _this.frame = frame;\n              _this.frameAxisX = frame.axis_x;\n              _this.model.marker_order.getFrame(_this.model.time.value, frameOrder => {\n                _this.frameOrder = frameOrder.hook_order;\n\n                _this._reorderBars();\n                _this._updateEntities(true);\n                _this.updateBarsOpacity();\n              });\n            });\n        }\n        _this.snapped = false;\n      },\n      \"change:marker\": function(evt, path) {\n        if (!_this._readyOnce) return;\n        if (path.indexOf(\"scaleType\") > -1) {\n          _this.ready();\n          return;\n        }\n      },\n      \"change:marker.select\": function(evt) {\n        _this.someSelected = (_this.model.marker.select.length > 0);\n        _this.nonSelectedOpacityZero = false;\n        _this.updateBarsOpacity();\n      },\n      \"change:marker.highlight\": function(evt, path) {\n        if (!_this._readyOnce) return;\n        _this._highlightBars();\n      },\n      \"change:marker.opacitySelectDim\": function() {\n        _this.updateBarsOpacity();\n      },\n      \"change:marker.opacityRegular\": function() {\n        _this.updateBarsOpacity();\n      },\n      \"change:marker.color.palette\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this._updateEntities();\n      },\n      \"change:marker.color.scaleType\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this._updateEntities();\n      },\n      \"change:marker.color.which\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this.model.marker_order.hook_order.which = _this.model.marker.color.which;\n      },\n      \"change:marker.side.which\": function(evt) {\n        if (!_this._readyOnce) return;\n        let sideDim;\n        const show = {};\n        const entitiesSideProps = {}\n        if (_this.model.marker.side.use == \"constant\") {\n          sideDim = null;\n        } else {\n          const sideConcept = _this.model.marker.side.getConceptprops();\n          if (sideConcept.concept_type == \"entity_set\") {\n            sideDim = sideConcept.domain;\n          } else {\n            sideDim = _this.model.marker.side.which;\n          }\n        }\n//        const sideDim = _this.model.marker.side.use == \"constant\" ? null : _this.model.marker.side.which;\n        _this.model.marker.side.clearSideState();\n        const skipFilterSide = sideDim !== _this.geoDomainDimension;\n        if (!skipFilterSide) {\n          show[\"is--\" + _this.model.marker.side.which] = true;\n        }\n        _this.model.entities_side.skipFilter = skipFilterSide;\n        entitiesSideProps[\"show\"] = show;\n        entitiesSideProps[\"dim\"] = sideDim;\n        _this.model.entities_side.set(entitiesSideProps);\n        _this.model.entities_geodomain.skipFilter = (sideDim === _this.geoDomainDimension || _this.STACKDIM === _this.geoDomainDimension) &&\n          (Boolean(_this.model.entities.getFilteredEntities().length) || !_this.model.entities_side.skipFilter);\n\n      },\n      \"change:entities.show\": function(evt) {\n        if (!_this._readyOnce) return;\n        if (_this.model.entities.dim === _this.model.entities_side.dim\n          && !utils.isEmpty(_this.model.entities_side.show)) {\n          const showEntities = _this.model.entities_side.getFilteredEntities().filter(s => !_this.model.entities.isShown(s));\n          if (showEntities.length) {\n            _this.model.marker.side.clearSideState();\n            _this.model.entities_side.showEntity(showEntities);\n          }\n        }\n        _this.model.entities_geodomain.skipFilter = (_this.SIDEDIM === _this.geoDomainDimension || _this.STACKDIM === _this.geoDomainDimension) &&\n          (Boolean(_this.model.entities.getFilteredEntities().length) || !_this.model.entities_side.skipFilter);\n\n      },\n      \"change:entities_side.show\": function(evt) {\n        if (!_this._readyOnce) return;\n        let doReturn = false;\n        let _entitiesSameDimWithSide = null;\n        utils.forEach(_this.model.marker.side._space, h => {\n          if (h.dim === _this.model.entities_side.dim && h._name !== _this.model.entities_side._name && h._name !== _this.model.entities_geodomain._name) {\n            _entitiesSameDimWithSide = h;\n          }\n        });\n        if (_entitiesSameDimWithSide) {\n          _this.model.entities.getFilteredEntities();\n          const showEntities = _this.model.entities_side.getFilteredEntities().filter(s => !_entitiesSameDimWithSide.isShown(s));\n          if (showEntities.length) {\n            _entitiesSameDimWithSide.showEntity(showEntities);\n            doReturn = true;\n          }\n        }\n        if (_this.SIDEDIM !== _this.model.entities_side.dim) {\n          doReturn = true;\n        }\n        if (doReturn) return;\n\n        _this._updateIndicators();\n        if (!_this.model.ready || !_this.frame) return;\n        _this._updateLimits();\n        _this.resize();\n        _this._updateEntities(true);\n      },\n      \"change:ui.chart.inpercent\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this._updateLimits();\n        _this.resize();\n        _this._updateEntities();\n      },\n      \"change:ui.chart.flipSides\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this.model.marker.side.switchSideState();\n        _this._updateIndicators();\n        _this.resize();\n        _this._updateEntities(true);\n      }\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    this.xScale = null;\n    this.yScale = null;\n    this.cScale = null;\n\n    this.xAxis = axisSmart(\"bottom\");\n    this.xAxisLeft = axisSmart(\"bottom\");\n    this.yAxis = axisSmart(\"left\");\n    this.xScales = [];\n\n    this.totalFieldName = \"Total\";\n  },\n\n  checkDimensions() {\n    const stackDim = this.model.entities.dim;\n    const sideDim = this.model.entities_side.dim;\n\n    this.colorUseNotProperty = this.model.marker.color.use == \"constant\" || this.model.marker.color.which == this.TIME;\n    this.stackSkip = stackDim == sideDim;\n    this.geoLess = stackDim !== this.geoDomainDimension && sideDim !== this.geoDomainDimension;\n    this.sideSkip = this.model.marker.side.use == \"constant\";\n  },\n\n  /**\n   * DOM is ready\n   */\n  readyOnce() {\n    const _this = this;\n    this.el = (this.el) ? this.el : d3.select(this.element);\n    this.element = this.el;\n\n    this.interaction = this._interaction();\n\n    this.graph = this.element.select(\".vzb-bc-graph\");\n    this.yAxisEl = this.graph.select(\".vzb-bc-axis-y\");\n    this.xAxisEl = this.graph.select(\".vzb-bc-axis-x\");\n    this.xAxisLeftEl = this.graph.select(\".vzb-bc-axis-x-left\");\n    this.xTitleEl = this.element.select(\".vzb-bc-axis-x-title\");\n    this.xInfoEl = this.element.select(\".vzb-bc-axis-x-info\");\n    this.yTitleEl = this.graph.select(\".vzb-bc-axis-y-title\");\n    this.barsCrop = this.graph.select(\".vzb-bc-bars-crop\");\n    this.labelsCrop = this.graph.select(\".vzb-bc-labels-crop\");\n    this.bars = this.graph.select(\".vzb-bc-bars\");\n    this.labels = this.graph.select(\".vzb-bc-labels\");\n    this.labels.select(\".vzb-bc-stack\").attr(\"y\", -10);\n\n    this.title = this.element.select(\".vzb-bc-title\");\n    this.titleRight = this.element.select(\".vzb-bc-title-right\");\n    this.year = this.element.select(\".vzb-bc-year\");\n\n    this.geoDomainDimension = this.model.entities_geodomain.getDimension();\n    this.geoDomainDefaultValue = ((this.model.entities_geodomain.show[this.geoDomainDimension] || {})[\"$in\"] || {})[0];\n\n    _this.someSelected = (_this.model.marker.select.length > 0);\n    _this.nonSelectedOpacityZero = false;\n\n\n    this.on(\"resize\", () => {\n      _this._updateEntities();\n  });\n\n    this._attributeUpdaters = {\n      _newWidth(d, i) {\n        d[\"x_\"] = 0;\n        const width = _this.frameAxisX[utils.getKey(d, _this.KEYS)];\n        // let width;\n        // if (_this.geoLess && _this.stackSkip && _this.sideSkip) {\n        //   width = (_this.frameAxisX[d[_this.AGEDIM]] || {})[_this.geoDomainDefaultValue];\n        // } else if (_this.geoLess && _this.stackSkip) {\n        //   width = _this.colorUseNotProperty || d[_this.PREFIXEDSIDEDIM] == d[_this.PREFIXEDSTACKDIM] ? (_this.frameAxisX[d[_this.PREFIXEDSIDEDIM]][d[_this.AGEDIM]] || {})[_this.geoDomainDefaultValue] : 0;\n        // } else if (_this.geoLess && _this.sideSkip) {\n        //   width = (_this.frameAxisX[d[_this.PREFIXEDSTACKDIM]][d[_this.AGEDIM]] || {})[_this.geoDomainDefaultValue];\n        // } else if (_this.stackSkip) {\n        //   width = _this.colorUseNotProperty || d[_this.PREFIXEDSIDEDIM] == d[_this.PREFIXEDSTACKDIM] ? _this.frameAxisX[d[_this.PREFIXEDSIDEDIM]][d[_this.AGEDIM]] : 0;\n        // } else if (_this.sideSkip) {\n        //   width = _this.frameAxisX[d[_this.PREFIXEDSTACKDIM]][d[_this.AGEDIM]];\n        // } else {\n        //   width = _this.frameAxisX[d[_this.PREFIXEDSTACKDIM]][d[_this.PREFIXEDSIDEDIM]][d[_this.AGEDIM]];\n        // }\n        \n        d[\"width_\"] = width ? _this.xScale(width) : 0;\n        if (_this.ui.chart.inpercent) {\n          d[\"width_\"] /= _this.total[d[_this.PREFIXEDSIDEDIM]];\n        }\n        return d.width_;\n      },\n      _newX(d, i) {\n        const prevSbl = this.previousSibling;\n        if (prevSbl) {\n          const prevSblDatum = d3.select(prevSbl).datum();\n          d[\"x_\"] = prevSblDatum.x_ + prevSblDatum.width_;\n        } else {\n          d[\"x_\"] = 0;\n        }\n        return d.x_;\n      },\n      _newColor(d, i) {\n        return _this.cScale(!_this.colorUseNotProperty ? _this.frame.color[utils.getKey(d, _this.COLORKEYS)] : _this.frame.color[d[_this.STACKDIM]]);\n      }\n    };\n  },\n\n  /*\n   * Both model and DOM are ready\n   */\n  ready() {\n    //TODO: get component ready if some submodel doesn't ready ??????\n    if (!this.model.marker._ready) return;\n\n    const _this = this;\n\n    this.timeSteps = this.model.time.getAllSteps();\n\n    this.TIME = this.model.marker._getFirstDimension({ type: \"time\" });\n    this.KEYS = utils.unique(this.model.marker._getAllDimensions({ exceptType: \"time\" }));\n    this.side = this.model.marker.label_side.getEntity();\n    this.SIDEDIM = this.side.getDimension();\n    this.PREFIXEDSIDEDIM = \"side_\" + this.SIDEDIM;\n    this.stack = this.model.marker.axis_y.getEntity();\n    this.STACKDIM = this.stack.getDimension();\n    this.PREFIXEDSTACKDIM = \"stack_\" + this.STACKDIM;\n    this.TIMEDIM = this.model.time.getDimension();\n    this.COLORKEYS = [this.STACKDIM, this.PREFIXEDSIDEDIM];\n    this.checkDimensions();\n    this.updateUIStrings();\n    this._updateIndicators();\n\n    this.frame = null;\n    this.model.marker.getFrame(_this.model.time.value, frame => {\n      _this.frame = frame;\n      _this.frameAxisX = frame.axis_x;\n      _this.model.marker_order.getFrame(_this.model.time.value, frameOrder => {\n        _this.frameOrder = frameOrder.hook_order;\n        _this.items = _this.model.marker.getKeys();\n        _this._createLimits();\n        _this._updateLimits();\n  \n        _this._reorderBars();\n        _this.markers = this.model.marker.getKeys(_this.STACKDIM);\n\n        _this.resize();\n        _this._updateEntities(true);\n        _this.updateBarsOpacity();\n      });\n    });\n  },\n\n  updateUIStrings() {\n    const _this = this;\n    this.translator = this.model.locale.getTFunction();\n\n    const xTitle = this.xTitleEl.selectAll(\"text\").data([0]);\n    xTitle.enter().append(\"text\");\n    xTitle\n      .on(\"click\", () => {\n        _this.parent\n          .findChildByName(\"gapminder-treemenu\")\n          .markerID(\"axis_x\")\n          .alignX(_this.model.locale.isRTL() ? \"right\" : \"left\")\n          .alignY(\"top\")\n          .updateView()\n          .toggle();\n      });\n\n    const conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.xInfoEl, iconQuestion)\n      .select(\"svg\").attr(\"width\", \"0px\").attr(\"height\", \"0px\")\n      .style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.xInfoEl.on(\"click\", () => {\n      _this.parent.findChildByName(\"gapminder-datanotes\").pin();\n    });\n    this.xInfoEl.on(\"mouseover\", function() {\n      if (_this.model.time.dragging) return;\n      const rect = this.getBBox();\n      const coord = utils.makeAbsoluteContext(this, this.farthestViewportElement)(rect.x - 10, rect.y + rect.height + 10);\n      const toolRect = _this.root.element.getBoundingClientRect();\n      const chartRect = _this.element.node().getBoundingClientRect();\n      _this.parent.findChildByName(\"gapminder-datanotes\").setHook(\"axis_x\").show().setPos(coord.x + chartRect.left - toolRect.left, coord.y);\n    });\n    this.xInfoEl.on(\"mouseout\", () => {\n      if (_this.model.time.dragging) return;\n      _this.parent.findChildByName(\"gapminder-datanotes\").hide();\n    });\n\n    // var titleStringY = this.model.marker.axis_y.getConceptprops().name;\n\n    // var yTitle = this.yTitleEl.selectAll(\"text\").data([0]);\n    // yTitle.enter().append(\"text\");\n    // yTitle\n    //   .attr(\"y\", \"-6px\")\n    //   .attr(\"x\", \"-9px\")\n    //   .attr(\"dx\", \"-0.72em\")\n    //   .text(titleStringY);\n  },\n\n  /**\n   * Changes labels for indicators\n   */\n  _updateIndicators() {\n    const _this = this;\n    this.duration = this.model.time.delayAnimations;\n    this.yScale = this.model.marker.axis_y.getScale();\n    this.xScale = this.model.marker.axis_x.getScale();\n    this.yAxis.tickFormat(_this.model.marker.axis_y.getTickFormatter());\n    this.xAxis.tickFormat(_this.model.marker.axis_x.getTickFormatter());\n    this.xAxisLeft.tickFormat(_this.model.marker.axis_x.getTickFormatter());\n\n    const sideDim = this.SIDEDIM;\n    const stackDim = this.STACKDIM;\n\n    const stacks = this.model.marker.getKeys(stackDim);\n    let stackKeys = [];\n    stackKeys = stacks.map(m => m[stackDim]);\n    this.stackKeys = stackKeys;\n\n    const sideItems = this.model.marker.label_side.getItems();\n    //var sideKeys = Object.keys(sideItems);\n    let sideKeys = [];\n    if (!utils.isEmpty(sideItems)) {\n      const sideFiltered = !!this.model.marker.side.getEntity().show[sideDim];\n      const sides = this.model.marker.getKeys(sideDim)\n          .filter(f => !sideFiltered || this.model.marker.side.getEntity().isShown(f));\n      sideKeys = sides.map(m => m[sideDim]);\n\n      if (sideKeys.length > 2) sideKeys.length = 2;\n      if (sideKeys.length > 1) {\n        const sortFunc = this.ui.chart.flipSides ? d3.ascending : d3.descending;\n        sideKeys.sort(sortFunc);\n      }\n    }\n    if (!sideKeys.length) sideKeys.push(\"undefined\");\n    this.sideKeys = sideKeys;\n\n    this.twoSided = this.sideKeys.length > 1;\n    this.titleRight.classed(\"vzb-hidden\", !this.twoSided);\n    if (this.twoSided) {\n      this.xScaleLeft = this.xScale.copy();\n      this.title.text(sideItems[this.sideKeys[1]]);\n      this.titleRight.text(sideItems[this.sideKeys[0]]);\n    } else {\n      const title = this.sideKeys.length && sideItems[this.sideKeys[0]] ? sideItems[this.sideKeys[0]] : \"\";\n      this.title.text(title);\n    }\n\n    this.cScale = this.model.marker.color.getScale();\n  },\n\n  _reorderBars() {\n    const _this = this;\n    const domain = this.yScale.domain();\n    const sideKeys = this.sideKeys;\n    domain.sort((a, b) => { \n      const result = d3.ascending(_this.frameOrder[a] || 0, _this.frameOrder[b] || 0);\n      return result !== 0 ? result : d3.ascending((_this.frameAxisX[a] || {})[sideKeys[0]] || 0, (_this.frameAxisX[b] || {})[sideKeys[0]] || 0);\n    });\n    this.yScale.domain(domain);\n  },\n\n  _createLimits() {\n    const _this = this;\n    const axisX = this.model.marker.axis_x;\n\n    //const sideKeysNF = Object.keys(this.model.marker.side.getItems());\n    const sideKeysNF = Object.keys(this.model.marker.side.getNestedItems([this.SIDEDIM]));\n    if (!sideKeysNF.length) sideKeysNF.push(\"undefined\");\n\n    const keys = this.sideSkip ? [] : [this.SIDEDIM];\n    const limits = axisX.getLimitsByDimensions(keys.concat([this.STACKDIM, this.TIMEDIM]));\n    const timeKeys = axisX.getUnique();\n    const totals = {};\n    const inpercentMaxLimits = {};\n    const maxLimits = {};\n    let key;\n    sideKeysNF.forEach(s => {\n      maxLimits[s] = [];\n      inpercentMaxLimits[s] = [];\n    });\n\n    if (_this.sideSkip) {\n      utils.forEach(timeKeys, time => {\n        totals[time] = {};\n        let stackSum = 0;\n        const sideMaxLimits = [];\n        utils.forEach(_this.stackKeys, stack => {\n          if (limits[stack] && limits[stack][time]) {\n            const val = limits[stack][time].max;\n            stackSum += val;\n            sideMaxLimits.push(val);\n          }\n        });\n        totals[time][sideKeysNF[0]] = stackSum;\n        const maxSideLimit = Math.max(...sideMaxLimits);\n        inpercentMaxLimits[sideKeysNF[0]].push(maxSideLimit / stackSum);\n        maxLimits[sideKeysNF[0]].push(maxSideLimit);\n      });\n    } else {  \n      utils.forEach(timeKeys, time => {\n        totals[time] = {};\n        utils.forEach(sideKeysNF, side => {\n          let stackSum = 0;\n          const sideMaxLimits = [];\n          utils.forEach(_this.stackKeys, stack => {\n            key = side + \",\" + stack;\n            if (limits[key] && limits[key][time]) {\n              const val = limits[key][time].max;\n              stackSum += val;\n              sideMaxLimits.push(val);\n            }\n          });\n          totals[time][side] = stackSum;\n          const maxSideLimit = Math.max(...sideMaxLimits);\n          inpercentMaxLimits[side].push(maxSideLimit / stackSum);\n          maxLimits[side].push(maxSideLimit);\n        });\n      });\n    }\n\n    this.maxLimits = {};\n    this.inpercentMaxLimits = {};\n    sideKeysNF.forEach(s => {\n      _this.maxLimits[s] = Math.max(...maxLimits[s]);\n      _this.inpercentMaxLimits[s] = Math.max(...inpercentMaxLimits[s]);\n    });\n    this.totals = totals;\n  },\n\n  _updateLimits() {\n    const _this = this;\n    const axisX = this.model.marker.axis_x;\n    const zero = axisX.scaleType == \"log\" ? 0.01 : 0;\n    let domain;\n    if (this.ui.chart.inpercent) {\n      domain = [zero * 0.01, Math.max(...this.sideKeys.map(s => _this.inpercentMaxLimits[s]))];\n    } else {\n      domain = (axisX.domainMin != null && axisX.domainMax != null) ? [+axisX.domainMin, +axisX.domainMax] : [zero, Math.max(...this.sideKeys.map(s => _this.maxLimits[s]))];\n    }\n    this.xScale.domain(domain);\n    if (this.xScaleLeft) this.xScaleLeft.domain(this.xScale.domain());\n  },\n\n\n  _interpolateBetweenTotals(timeSteps, totals, time) {\n    const nextStep = d3.bisectLeft(timeSteps, time);\n    const fraction = (time - timeSteps[nextStep - 1]) / (timeSteps[nextStep] - timeSteps[nextStep - 1]);\n    const total = {};\n    utils.forEach(this.sideKeys, side => {\n      total[side] = totals[timeSteps[nextStep]][side] * fraction + totals[timeSteps[nextStep - 1]][side] * (1 - fraction);\n  });\n    return total;\n  },\n\n  /**\n   * Updates entities\n   */\n  _updateEntities(reorder) {\n    const _this = this;\n    const time = this.model.time;\n    const sideDim = this.SIDEDIM;\n    const prefixedSideDim = this.PREFIXEDSIDEDIM;\n    const stackDim = this.STACKDIM;\n    const prefixedStackDim = this.PREFIXEDSTACKDIM;\n    const timeDim = this.TIMEDIM;\n    const duration = (time.playing) ? time.delayAnimations : 0;\n    let total;\n\n    if (this.ui.chart.inpercent) {\n      this.total = this.totals[time.value] ? this.totals[time.value] : this._interpolateBetweenTotals(this.timeSteps, this.totals, time.value);\n    }\n\n    const domain = this.yScale.domain();\n\n    const stackBars = this.markers.slice(0);\n\n    this.entityBars = this.bars.selectAll(\".vzb-bc-bar\")\n        .data(stackBars, d => d[stackDim]);\n    //exit selection\n    this.entityBars.exit().remove();\n\n    const barHeight = this.barHeight;\n    const firstBarOffsetY = this.firstBarOffsetY;\n\n    //enter selection -- init bars\n    this.entityBars = this.entityBars.enter().append(\"g\")\n      .attr(\"class\", d => \"vzb-bc-bar \" + \"vzb-bc-bar-\" + d[stackDim])\n      .attr(\"transform\", (d, i) => \"translate(0,\" + (firstBarOffsetY - _this.yScale(d[stackDim])) + \")\")\n      .merge(this.entityBars);\n\n    const _attributeUpdaters = this._attributeUpdaters;\n        \n    this.sideBars = this.entityBars.selectAll(\".vzb-bc-side\").data(d => _this.sideKeys.map(m => {\n        const r = {};\n    r[stackDim] = d[stackDim];\n    r[prefixedSideDim] = m;\n    r[sideDim] = m;\n    return r;\n  }), d => d[prefixedSideDim]);\n\n    this.sideBars.exit().remove();\n    this.sideBars = this.sideBars.enter().append(\"g\")\n      .attr(\"class\", (d, i) => \"vzb-bc-side \" + \"vzb-bc-side-\" + (!i != !_this.twoSided ? \"right\" : \"left\"))\n      .call((sideSel) => {\n        sideSel.append(\"rect\")\n          .attr(\"class\", (d, i) => \"vzb-bc-stack \" + \"vzb-bc-stack-\" + i + (_this.highlighted ? \" vzb-dimmed\" : \"\"))\n          .attr(\"y\", 0)\n          .attr(\"height\", barHeight)\n          .attr(\"fill\", _attributeUpdaters._newColor)\n          .attr(\"width\", _attributeUpdaters._newWidth)\n          .attr(\"x\", _attributeUpdaters._newX)\n          .on(\"mouseover\", _this.interaction.mouseover)\n          .on(\"mouseout\", _this.interaction.mouseout)\n          .on(\"click\", _this.interaction.click)\n          .onTap(_this.interaction.tap);\n      })\n      .merge(this.sideBars);\n\n    if (reorder) {\n      this.sideBars.attr(\"transform\", (d, i) => i ? (\"scale(-1,1) translate(\" + _this.activeProfile.centerWidth + \",0)\") : \"\");\n    }\n\n    this.stackBars = this.sideBars.selectAll(\".vzb-bc-stack\");\n\n    if (reorder) this.stackBars\n      .attr(\"fill\", _attributeUpdaters._newColor);\n\n    if (duration) {\n      const transition = d3.transition()\n        .duration(duration)\n        .ease(d3.easeLinear);\n\n      this.entityBars\n        //.transition(transition)\n        .attr(\"transform\", (d, i) => \"translate(0,\" + (firstBarOffsetY - _this.yScale(d[stackDim])) + \")\");\n      this.stackBars\n        .transition(transition)\n        .attr(\"width\", _attributeUpdaters._newWidth)\n        .attr(\"x\", _attributeUpdaters._newX);\n    } else {\n      this.entityBars.interrupt()\n        .attr(\"transform\", (d, i) => \"translate(0,\" + (firstBarOffsetY - _this.yScale(d[stackDim])) + \")\");\n      this.stackBars.interrupt()\n        .attr(\"width\", _attributeUpdaters._newWidth)\n        .attr(\"x\", _attributeUpdaters._newX);\n    }\n\n    if (duration) {\n      this.year.transition().duration(duration).ease(d3.easeLinear)\n        .on(\"end\", this._setYear(time.value));\n    } else {\n      this.year.interrupt().text(time.formatDate(time.value)).transition();\n    }\n  },\n\n  _setYear(timeValue) {\n    const formattedTime = this.model.time.formatDate(timeValue);\n    return function() { d3.select(this).text(formattedTime); };\n  },\n\n  _interaction() {\n    const _this = this;\n    return {\n      mouseover(d, i) {\n        if (utils.isTouchDevice()) return;\n        _this.model.marker.highlightMarker(d);\n        //_this._showLabel(d);\n      },\n      mouseout(d, i) {\n        if (utils.isTouchDevice()) return;\n        _this.model.marker.clearHighlighted();\n      },\n      click(d, i) {\n        if (utils.isTouchDevice()) return;\n        _this.model.marker.selectMarker(d);\n      },\n      tap(d) {\n        d3.event.stopPropagation();\n        _this.model.marker.selectMarker(d);\n      }\n    };\n  },\n\n  _highlightBars(d) {\n    const _this = this;\n\n    _this.someHighlighted = (_this.model.marker.highlight.length > 0);\n\n    _this.updateBarsOpacity();\n\n    if (!_this.someHighlighted) {\n      //hide labels\n      _this.labels.selectAll(\".vzb-hovered\").classed(\"vzb-hovered\", false);\n    } else {\n      _this._showLabel(_this.model.marker.highlight[0]);\n    }\n  },\n\n  _showLabel(d) {\n    if (!this.frame) return;\n    \n    const _this = this;\n    const formatter = _this.ui.chart.inpercent ? d3.format(\".2%\") : _this.model.marker.axis_x.getTickFormatter();\n    const sideDim = _this.SIDEDIM;\n    const stackDim = _this.STACKDIM;\n    const KEYS = this.KEYS;\n\n    const left = _this.sideKeys.indexOf(d[sideDim]);\n    const label = _this.labels.select(\".vzb-bc-label\");\n    const bar = _this.bars.select(\".vzb-bc-bar-\" + d[stackDim]);\n    label.attr(\"transform\", bar.attr(\"transform\"))\n      .select(\".vzb-bc-stack\")\n      .text(textData => {\n        let text = _this.frame.label_stack[d[stackDim]];\n        text = _this.twoSided ? text : text + \" \" + _this.stackItems[d[stackDim]];\n        const total = _this.ui.chart.inpercent ? _this.total[d[sideDim]] : 1;\n        const value = _this.frameAxisX[utils.getKey(d, KEYS)] / total;\n        return text + \": \" + formatter(value);\n      })\n      .attr(\"x\", (left ? -1 : 1) * (_this.activeProfile.centerWidth * 0.5 + 7))\n      .classed(\"vzb-text-left\", left);\n\n    label.classed(\"vzb-hovered\", true);\n  },\n\n  /**\n   * Executes everytime the container or vizabi is resized\n   * Ideally,it contains only operations related to size\n   */\n\n\n  presentationProfileChanges: {\n    medium: {\n      margin: { right: 80, bottom: 80 },\n      infoElHeight: 32\n    },\n    large: {\n      margin: { top: 100, right: 100, left: 100, bottom: 80 },\n      infoElHeight: 32\n    }\n  },\n\n  profiles: {\n    \"small\": {\n      margin: {\n        top: 70,\n        right: 20,\n        left: 40,\n        bottom: 40\n      },\n      infoElHeight: 16,\n      centerWidth: 2,\n      titlesSpacing: 5\n    },\n    \"medium\": {\n      margin: {\n        top: 80,\n        right: 60,\n        left: 60,\n        bottom: 40\n      },\n      infoElHeight: 20,\n      centerWidth: 2,\n      titlesSpacing: 10\n    },\n    \"large\": {\n      margin: {\n        top: 100,\n        right: 60,\n        left: 60,\n        bottom: 40\n      },\n      infoElHeight: 22,\n      centerWidth: 2,\n      titlesSpacing: 20\n    }\n  },\n\n  resize() {\n\n    const _this = this;\n\n    this.activeProfile = this.getActiveProfile(this.profiles, this.presentationProfileChanges);\n\n    const margin = this.activeProfile.margin;\n    const infoElHeight = this.activeProfile.infoElHeight;\n\n    //stage\n    this.height = (parseInt(this.element.style(\"height\"), 10) - margin.top - margin.bottom) || 0;\n    this.width = (parseInt(this.element.style(\"width\"), 10) - margin.left - margin.right) || 0;\n\n    if (this.height <= 0 || this.width <= 0) return utils.warn(\"BarchartDS resize() abort: vizabi container is too little or has display:none\");\n\n    this.graph\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    this.barsCrop\n      .attr(\"width\", this.width)\n      .attr(\"height\", Math.max(0, this.height));\n\n    this.labelsCrop\n      .attr(\"width\", this.width)\n      .attr(\"height\", Math.max(0, this.height));\n\n    const domain = this.yScale.domain();\n    // height per bar is total domain height divided by the number of possible markers in the domain\n    const barHeight = this.barHeight = this.model.marker.axis_y.scaleType == \"ordinal\" ? this.height / domain.length : this.height / Math.abs(domain[1] - domain[0]);\n    this.firstBarOffsetY = this.height - this.barHeight;\n\n    if (this.stackBars) this.stackBars.attr(\"height\", barHeight);\n\n    if (this.sideBars) this.sideBars\n      .attr(\"transform\", (d, i) => i ? (\"scale(-1,1) translate(\" + _this.activeProfile.centerWidth + \",0)\") : \"\");\n\n    //update scales to the new range\n    this.yScale.range([this.height, 0]);\n\n    const maxRange = this.twoSided ? ((this.width - this.activeProfile.centerWidth) * 0.5) : this.width;\n\n    this.xScale.range([0, maxRange]);\n\n    //apply scales to axes and redraw\n    this.yAxis.scale(this.yScale)\n      .tickValues([])\n      .tickSizeInner(-this.width)\n      .tickSizeOuter(0)\n      .tickPadding(6)\n      .tickSizeMinor(-this.width, 0)\n      .labelerOptions({\n        scaleType: this.model.marker.axis_y.scaleType,\n        toolMargin: margin,\n        limitMaxTickNumber: 1\n      });\n\n    const format = this.ui.chart.inpercent ? d3.format(\".1%\") : this.model.marker.axis_x.getTickFormatter();\n\n    this.xAxis.scale(this.xScale)\n      .tickFormat(format)\n      .tickSizeInner(-this.height)\n      .tickSizeOuter(0)\n      .tickPadding(6)\n      .tickSizeMinor(-this.height, 0)\n      .labelerOptions({\n        scaleType: this.model.marker.axis_x.scaleType,\n        toolMargin: margin,\n        limitMaxTickNumber: 6\n      });\n\n    const translateX = this.twoSided ? ((this.width + _this.activeProfile.centerWidth) * 0.5) : 0;\n\n    this.xAxisEl.attr(\"transform\", \"translate(\" + translateX + \",\" + this.height + \")\")\n      .call(this.xAxis);\n\n    this.yAxisEl.attr(\"transform\", \"translate(\" + 0 + \",0)\")\n      .call(this.yAxis);\n    //this.xAxisEl.call(this.xAxis);\n    this.xAxisLeftEl.classed(\"vzb-hidden\", !this.twoSided);\n    if (this.twoSided) {\n      if (this.model.marker.axis_x.scaleType !== \"ordinal\") {\n        this.xScaleLeft.range([(this.width - this.activeProfile.centerWidth) * 0.5, 0]);\n      } else {\n        this.xScaleLeft.rangePoints([(this.width - this.activeProfile.centerWidth) * 0.5, 0]).range();\n      }\n\n      this.xAxisLeft.scale(this.xScaleLeft)\n        .tickFormat(format)\n        .tickSizeInner(-this.height)\n        .tickSizeOuter(0)\n        .tickPadding(6)\n        .tickSizeMinor(-this.height, 0)\n        .labelerOptions({\n          scaleType: this.model.marker.axis_x.scaleType,\n          toolMargin: margin,\n          limitMaxTickNumber: 6\n        });\n\n      this.xAxisLeftEl.attr(\"transform\", \"translate(0,\" + this.height + \")\")\n        .call(this.xAxisLeft);\n      const zeroTickEl = this.xAxisEl.select(\".tick text\");\n      if (!zeroTickEl.empty()) {\n        const zeroTickWidth = zeroTickEl.node().getBBox().width;\n        zeroTickEl.attr(\"dx\", -(this.activeProfile.centerWidth + zeroTickWidth) * 0.5);\n      }\n      this.xAxisEl.select(\".tick line\").classed(\"vzb-hidden\", true);\n   \n      //hide left axis zero tick\n      const tickNodes = this.xAxisLeftEl.selectAll(\".tick\").nodes();\n      d3.select(tickNodes[tickNodes.length - 1]).classed(\"vzb-hidden\", true);\n   }\n\n    const isRTL = this.model.locale.isRTL();\n\n    this.bars.attr(\"transform\", \"translate(\" + translateX + \",0)\");\n    this.labels.attr(\"transform\", \"translate(\" + translateX + \",0)\");\n\n    this.title\n      .attr(\"x\", margin.left + (this.twoSided ? translateX - this.activeProfile.titlesSpacing : 0))\n      .style(\"text-anchor\", this.twoSided ? \"end\" : \"\")\n      .attr(\"y\", margin.top * 0.7);\n    this.titleRight\n      .attr(\"x\", margin.left + translateX + this.activeProfile.titlesSpacing)\n      .attr(\"y\", margin.top * 0.7);\n\n    this.xTitleEl\n      .style(\"font-size\", infoElHeight + \"px\")\n      .attr(\"transform\", \"translate(\" + (isRTL ? this.width : margin.left * 0.4) + \",\" + (margin.top * 0.4) + \")\");\n    this.xTitleEl.select(\"text\").text(this.model.marker.axis_x.getConceptprops().name);\n\n    if (this.xInfoEl.select(\"svg\").node()) {\n      const titleBBox = this.xTitleEl.node().getBBox();\n      const t = utils.transform(this.xTitleEl.node());\n      const hTranslate = isRTL ? (titleBBox.x + t.translateX - infoElHeight * 1.4) : (titleBBox.x + t.translateX + titleBBox.width + infoElHeight * 0.4);\n\n      this.xInfoEl.select(\"svg\")\n        .attr(\"width\", infoElHeight + \"px\")\n        .attr(\"height\", infoElHeight + \"px\");\n      this.xInfoEl.attr(\"transform\", \"translate(\"\n        + hTranslate + \",\"\n        + (t.translateY - infoElHeight * 0.8) + \")\");\n    }\n\n\n    this.year.attr(\"x\", this.width + margin.left).attr(\"y\", margin.top * 0.4);\n\n  },\n\n  updateBarsOpacity(duration) {\n    const _this = this;\n    //if(!duration)duration = 0;\n\n    const OPACITY_HIGHLT = 1.0;\n    const OPACITY_HIGHLT_DIM = this.model.marker.opacityHighlightDim;\n    const OPACITY_SELECT = 1.0;\n    const OPACITY_REGULAR = this.model.marker.opacityRegular;\n    const OPACITY_SELECT_DIM = this.model.marker.opacitySelectDim;\n\n    this.stackBars\n    //.transition().duration(duration)\n      .style(\"opacity\", d => {\n\n        if (_this.someHighlighted) {\n          //highlight or non-highlight\n          if (_this.model.marker.isHighlighted(d)) return OPACITY_HIGHLT;\n        }\n\n        if (_this.someSelected) {\n          //selected or non-selected\n          return _this.model.marker.isSelected(d) ? OPACITY_SELECT : OPACITY_SELECT_DIM;\n        }\n\n        if (_this.someHighlighted) return OPACITY_HIGHLT_DIM;\n\n        return OPACITY_REGULAR;\n      });\n\n    this.stackBars.style(\"stroke\", d => _this.model.marker.isSelected(d) ? \"#333\" : null);\n\n    const nonSelectedOpacityZero = _this.model.marker.opacitySelectDim < 0.01;\n\n    // when pointer events need update...\n    if (nonSelectedOpacityZero != this.nonSelectedOpacityZero) {\n      this.stackBars.style(\"pointer-events\", d => (!_this.someSelected || !nonSelectedOpacityZero || _this.model.marker.isSelected(d)) ?\n        \"visible\" : \"none\");\n    }\n\n    this.nonSelectedOpacityZero = _this.model.marker.opacitySelectDim < 0.01;\n  }\n\n});\n\nexport default BarChartDS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/component.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles.scss\n// module id = 2\n// module chunks = 0 1","module.exports = \"<!-- BarChartDS Component -->\\n<svg class=\\\"vzb-barchartds\\\">\\n    <g class=\\\"vzb-bc-header\\\">\\n        <g class=\\\"vzb-bc-axis-x-title\\\"></g>\\n        <g class=\\\"vzb-bc-axis-x-info vzb-noexport\\\"></g>\\n        <text class=\\\"vzb-bc-title\\\"></text>\\n        <text class=\\\"vzb-bc-title vzb-bc-title-right\\\"></text>\\n        <text class=\\\"vzb-bc-year\\\"></text>\\n    </g>\\n    <g class=\\\"vzb-bc-graph\\\">\\n\\n        <g class=\\\"vzb-bc-axis-y-title\\\"></g>\\n\\n        <g class=\\\"vzb-bc-axis-y\\\"></g>\\n\\n        <svg class=\\\"vzb-bc-bars-crop\\\">\\n            <g class=\\\"vzb-bc-bars\\\"></g>\\n        </svg>\\n\\n        <g class=\\\"vzb-bc-axis-x\\\"></g>\\n        <g class=\\\"vzb-bc-axis-x vzb-bc-axis-x-left\\\"></g>\\n\\n        <svg class=\\\"vzb-bc-labels-crop\\\">\\n            <g class=\\\"vzb-bc-labels\\\">\\n                <g class=\\\"vzb-bc-label\\\"><text class=\\\"vzb-bc-stack\\\"></text></g>\\n            </g>\\n        </svg>\\n\\n        <g class=\\\"vzb-bc-axis-labels\\\">\\n            <!-- <text class=\\\"vzb-x_label\\\">Lifespan</text>\\n                  <text class=\\\"vzb-y_label\\\">Lifespan</text> -->\\n        </g>\\n    </g>\\n</svg>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/template.html\n// module id = 3\n// module chunks = 0 1"],"sourceRoot":""}